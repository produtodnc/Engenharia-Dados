[0m15:28:25.992913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b45a9e9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b43fa6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b43fa62c0>]}


============================== 15:28:25.995502 | 5b01f444-d8e3-4496-85dd-e8e16e921fd3 ==============================
[0m15:28:25.995502 [info ] [MainThread]: Running with dbt=1.7.14
[0m15:28:25.996156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:28:25.996768 [info ] [MainThread]: dbt version: 1.7.14
[0m15:28:25.997271 [info ] [MainThread]: python version: 3.10.12
[0m15:28:25.997765 [info ] [MainThread]: python path: /home/lkeiti/Documents/dnc-data-engineer/.env/bin/python3
[0m15:28:25.998334 [info ] [MainThread]: os info: Linux-6.5.0-28-generic-x86_64-with-glibc2.35
[0m15:28:26.549752 [info ] [MainThread]: Using profiles dir at /home/lkeiti/.dbt
[0m15:28:26.550505 [info ] [MainThread]: Using profiles.yml file at /home/lkeiti/.dbt/profiles.yml
[0m15:28:26.551058 [info ] [MainThread]: Using dbt_project.yml file at /home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/dbt_project.yml
[0m15:28:26.551702 [info ] [MainThread]: adapter type: snowflake
[0m15:28:26.552200 [info ] [MainThread]: adapter version: 1.7.1
[0m15:28:26.628552 [info ] [MainThread]: Configuration:
[0m15:28:26.629158 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:28:26.629660 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:28:26.630169 [info ] [MainThread]: Required dependencies:
[0m15:28:26.630951 [debug] [MainThread]: Executing "git --help"
[0m15:28:26.633012 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:28:26.633576 [debug] [MainThread]: STDERR: "b''"
[0m15:28:26.634053 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:28:26.634720 [info ] [MainThread]: Connection:
[0m15:28:26.635335 [info ] [MainThread]:   account: kxjeitm-yy20508
[0m15:28:26.635906 [info ] [MainThread]:   user: dbt
[0m15:28:26.636435 [info ] [MainThread]:   database: AIRBNB
[0m15:28:26.636957 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m15:28:26.637512 [info ] [MainThread]:   role: transform
[0m15:28:26.638090 [info ] [MainThread]:   schema: dev
[0m15:28:26.638615 [info ] [MainThread]:   authenticator: None
[0m15:28:26.639336 [info ] [MainThread]:   private_key_path: None
[0m15:28:26.640144 [info ] [MainThread]:   token: None
[0m15:28:26.640872 [info ] [MainThread]:   oauth_client_id: None
[0m15:28:26.641750 [info ] [MainThread]:   query_tag: None
[0m15:28:26.642628 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:28:26.643500 [info ] [MainThread]:   host: None
[0m15:28:26.644328 [info ] [MainThread]:   port: None
[0m15:28:26.645260 [info ] [MainThread]:   proxy_host: None
[0m15:28:26.646186 [info ] [MainThread]:   proxy_port: None
[0m15:28:26.647178 [info ] [MainThread]:   protocol: None
[0m15:28:26.648179 [info ] [MainThread]:   connect_retries: 1
[0m15:28:26.648979 [info ] [MainThread]:   connect_timeout: None
[0m15:28:26.649938 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:28:26.650936 [info ] [MainThread]:   retry_all: False
[0m15:28:26.651706 [info ] [MainThread]:   insecure_mode: False
[0m15:28:26.652654 [info ] [MainThread]:   reuse_connections: None
[0m15:28:26.653556 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:28:26.654578 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:28:26.656017 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:28:26.656994 [debug] [MainThread]: On debug: select 1 as id
[0m15:28:26.658071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:27.717655 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:28:27.722862 [debug] [MainThread]: On debug: Close
[0m15:28:27.842101 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:28:27.844600 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:28:27.848741 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.8967267, "process_user_time": 3.084865, "process_kernel_time": 0.775212, "process_mem_max_rss": "188588", "process_in_blocks": "3440", "process_out_blocks": "1096"}
[0m15:28:27.852682 [debug] [MainThread]: Command `dbt debug` succeeded at 15:28:27.851206 after 1.90 seconds
[0m15:28:27.855072 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:28:27.858073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b45a9e9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b43f5cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b43fa6260>]}
[0m15:28:27.860649 [debug] [MainThread]: Flushing usage events
[0m15:33:01.637386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31dccb29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31dafda3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31dafda380>]}


============================== 15:33:01.639938 | f6df5fdf-8d19-45f3-a979-c88ca2c59e65 ==============================
[0m15:33:01.639938 [info ] [MainThread]: Running with dbt=1.7.14
[0m15:33:01.640681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:33:02.286459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6df5fdf-8d19-45f3-a979-c88ca2c59e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31dafda4d0>]}
[0m15:33:02.348064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6df5fdf-8d19-45f3-a979-c88ca2c59e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31afb98a90>]}
[0m15:33:02.348892 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:33:02.355801 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m15:33:02.383184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m15:33:02.383935 [debug] [MainThread]: Partial parsing: added file: dbtdnc://models/src/src_reviews.sql
[0m15:33:02.384515 [debug] [MainThread]: Partial parsing: added file: dbtdnc://models/src/src_listings.sql
[0m15:33:02.385040 [debug] [MainThread]: Partial parsing: added file: dbtdnc://models/src/src_hosts.sql
[0m15:33:02.562673 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtdnc.src_reviews' (models/src/src_reviews.sql) depends on a source named 'airbnb.reviews' which was not found
[0m15:33:02.563900 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.97045934, "process_user_time": 3.094849, "process_kernel_time": 0.803547, "process_mem_max_rss": "187868", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m15:33:02.564608 [debug] [MainThread]: Command `dbt run` failed at 15:33:02.564417 after 0.97 seconds
[0m15:33:02.565146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31dccb29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31af8bfb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31afb9a710>]}
[0m15:33:02.565703 [debug] [MainThread]: Flushing usage events
[0m15:56:06.523298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6ce6a69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6cc9b2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6cc9b23b0>]}


============================== 15:56:06.525833 | 73f29383-9e9c-4d1b-888f-93f47c43c2a0 ==============================
[0m15:56:06.525833 [info ] [MainThread]: Running with dbt=1.7.14
[0m15:56:06.526556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:56:07.143132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73f29383-9e9c-4d1b-888f-93f47c43c2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6cc9b2500>]}
[0m15:56:07.200435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73f29383-9e9c-4d1b-888f-93f47c43c2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6a5835ff0>]}
[0m15:56:07.201282 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:56:07.208034 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m15:56:07.236812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:56:07.237393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:56:07.242678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73f29383-9e9c-4d1b-888f-93f47c43c2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6a54a40d0>]}
[0m15:56:07.251382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73f29383-9e9c-4d1b-888f-93f47c43c2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6a5474ee0>]}
[0m15:56:07.252042 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:56:07.252638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73f29383-9e9c-4d1b-888f-93f47c43c2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6a5475bd0>]}
[0m15:56:07.254233 [info ] [MainThread]: 
[0m15:56:07.255153 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:56:07.256590 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m15:56:07.270415 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m15:56:07.271071 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m15:56:07.271850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:07.968050 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:56:07.974792 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m15:56:08.084891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_dev)
[0m15:56:08.088702 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m15:56:08.111824 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_dev"
[0m15:56:08.113485 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */
create schema if not exists AIRBNB.dev
[0m15:56:08.114851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:08.607261 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:56:08.611797 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m15:56:08.721325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_dev, now list_AIRBNB_dev)
[0m15:56:08.754388 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m15:56:08.755792 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m15:56:08.756982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:09.305539 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:56:09.312236 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m15:56:09.419278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73f29383-9e9c-4d1b-888f-93f47c43c2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6a5474f10>]}
[0m15:56:09.423322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:56:09.425993 [info ] [MainThread]: 
[0m15:56:09.437496 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m15:56:09.440491 [info ] [Thread-1 (]: 1 of 3 START sql view model dev.src_hosts ...................................... [RUN]
[0m15:56:09.444483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.src_hosts)
[0m15:56:09.447469 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m15:56:09.470383 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m15:56:09.472364 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 15:56:09.449311 => 15:56:09.471639
[0m15:56:09.473465 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_hosts
[0m15:56:09.505024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_hosts"
[0m15:56:09.506672 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_hosts"
[0m15:56:09.507269 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m15:56:09.507806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:10.084602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:56:10.136570 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (execute): 15:56:09.474067 => 15:56:10.136173
[0m15:56:10.137418 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: Close
[0m15:56:10.248153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f29383-9e9c-4d1b-888f-93f47c43c2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6a4a303a0>]}
[0m15:56:10.252863 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.80s]
[0m15:56:10.256937 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m15:56:10.259876 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m15:56:10.263200 [info ] [Thread-1 (]: 2 of 3 START sql view model dev.src_listings ................................... [RUN]
[0m15:56:10.267176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m15:56:10.269973 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m15:56:10.276682 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m15:56:10.279120 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 15:56:10.271636 => 15:56:10.278507
[0m15:56:10.281082 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_listings
[0m15:56:10.288276 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_listings"
[0m15:56:10.290333 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_listings"
[0m15:56:10.291109 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m15:56:10.292062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:10.834758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:56:10.848875 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (execute): 15:56:10.282339 => 15:56:10.847588
[0m15:56:10.851695 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: Close
[0m15:56:10.957910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f29383-9e9c-4d1b-888f-93f47c43c2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6a4a302b0>]}
[0m15:56:10.961294 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.69s]
[0m15:56:10.964793 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m15:56:10.967512 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m15:56:10.971073 [info ] [Thread-1 (]: 3 of 3 START sql view model dev.src_reviews .................................... [RUN]
[0m15:56:10.975536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m15:56:10.978236 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m15:56:10.988144 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m15:56:10.991894 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 15:56:10.980318 => 15:56:10.990388
[0m15:56:10.994570 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_reviews
[0m15:56:11.005066 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_reviews"
[0m15:56:11.007456 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_reviews"
[0m15:56:11.009330 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m15:56:11.011028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:11.575878 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:56:11.582187 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (execute): 15:56:10.995993 => 15:56:11.581598
[0m15:56:11.583462 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: Close
[0m15:56:11.679937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f29383-9e9c-4d1b-888f-93f47c43c2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6a417e770>]}
[0m15:56:11.683575 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.71s]
[0m15:56:11.687591 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m15:56:11.695948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:11.698646 [debug] [MainThread]: Connection 'model.dbtdnc.src_reviews' was properly closed.
[0m15:56:11.701575 [info ] [MainThread]: 
[0m15:56:11.704174 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m15:56:11.710665 [debug] [MainThread]: Command end result
[0m15:56:11.728457 [info ] [MainThread]: 
[0m15:56:11.729657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:56:11.730679 [info ] [MainThread]: 
[0m15:56:11.731489 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:56:11.733199 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.250601, "process_user_time": 3.817584, "process_kernel_time": 0.771511, "process_mem_max_rss": "196132", "process_in_blocks": "64", "process_out_blocks": "1784"}
[0m15:56:11.734680 [debug] [MainThread]: Command `dbt run` succeeded at 15:56:11.734298 after 5.25 seconds
[0m15:56:11.735605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6ce6a69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6cc9b1c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e6a417ca60>]}
[0m15:56:11.736347 [debug] [MainThread]: Flushing usage events
[0m16:08:37.892006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766715d7e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7667142863e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766714286380>]}


============================== 16:08:37.894748 | 8894d62d-a966-4b40-8659-2866fc2d9eae ==============================
[0m16:08:37.894748 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:08:37.895464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:08:38.549076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8894d62d-a966-4b40-8659-2866fc2d9eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7667142864d0>]}
[0m16:08:38.609016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8894d62d-a966-4b40-8659-2866fc2d9eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7666ece00730>]}
[0m16:08:38.610007 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:08:38.616739 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:08:38.647113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:38.647727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:38.648614 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtdnc.dim
[0m16:08:38.654071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8894d62d-a966-4b40-8659-2866fc2d9eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7666ecb7c550>]}
[0m16:08:38.663537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8894d62d-a966-4b40-8659-2866fc2d9eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7666ecb49660>]}
[0m16:08:38.664226 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:08:38.664777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8894d62d-a966-4b40-8659-2866fc2d9eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7666ecb4a4a0>]}
[0m16:08:38.666659 [info ] [MainThread]: 
[0m16:08:38.667533 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:08:38.669013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:08:38.684282 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:08:38.685117 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:08:38.685824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:39.380928 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:08:39.388488 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:08:39.481800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:08:39.515364 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:08:39.516992 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:08:39.518458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:39.913084 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m16:08:39.919862 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:08:40.026186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8894d62d-a966-4b40-8659-2866fc2d9eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7666ecbaeb60>]}
[0m16:08:40.030607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:08:40.033210 [info ] [MainThread]: 
[0m16:08:40.041929 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:08:40.045330 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m16:08:40.049419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.dim_hosts_cleansed)
[0m16:08:40.052444 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:08:40.081714 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:08:40.083919 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:08:40.054757 => 16:08:40.083080
[0m16:08:40.085107 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:08:40.118039 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:08:40.119238 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:08:40.119912 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    WITH src_hosts AS (
    SELECT *
    FROM { { ref('src_hosts') } }
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
  );
[0m16:08:40.120515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:40.750305 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b459bc-0000-432c-0000-000052fd227d
[0m16:08:40.753674 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 11 unexpected '{'.
syntax error line 6 at position 17 unexpected ''src_hosts''.
syntax error line 6 at position 30 unexpected '}'.
[0m16:08:40.758851 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:08:40.085645 => 16:08:40.756967
[0m16:08:40.761904 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:08:40.864387 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models/src/dim/dim_hosts_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 11 unexpected '{'.
  syntax error line 6 at position 17 unexpected ''src_hosts''.
  syntax error line 6 at position 30 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/src/dim/dim_hosts_cleansed.sql
[0m16:08:40.865278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8894d62d-a966-4b40-8659-2866fc2d9eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7666eca9f1f0>]}
[0m16:08:40.866371 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model dev.dim_hosts_cleansed .................... [[31mERROR[0m in 0.82s]
[0m16:08:40.867496 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:08:40.868387 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:08:40.869840 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m16:08:40.870996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:08:40.871857 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:08:40.876157 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:08:40.877240 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:08:40.872350 => 16:08:40.876868
[0m16:08:40.877992 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:08:40.882668 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:08:40.884061 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:08:40.884822 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    WITH src_listings AS (
    SELECT *
    FROM { { ref('src_listings') } }
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
  );
[0m16:08:40.885557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:41.291767 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b459bc-0000-432c-0000-000052fd2281
[0m16:08:41.294964 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 11 unexpected '{'.
syntax error line 6 at position 17 unexpected ''src_listings''.
syntax error line 6 at position 33 unexpected '}'.
[0m16:08:41.298916 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:08:40.878464 => 16:08:41.297337
[0m16:08:41.301611 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:08:41.411526 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models/src/dim/dim_listings_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 11 unexpected '{'.
  syntax error line 6 at position 17 unexpected ''src_listings''.
  syntax error line 6 at position 33 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/src/dim/dim_listings_cleansed.sql
[0m16:08:41.414549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8894d62d-a966-4b40-8659-2866fc2d9eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7666ec1a6b90>]}
[0m16:08:41.417824 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model dev.dim_listings_cleansed ................. [[31mERROR[0m in 0.54s]
[0m16:08:41.422075 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:08:41.425862 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:08:41.429574 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m16:08:41.432643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.src_hosts)
[0m16:08:41.434660 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:08:41.441048 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:08:41.443718 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:08:41.435541 => 16:08:41.442737
[0m16:08:41.445234 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_hosts
[0m16:08:41.453168 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_hosts"
[0m16:08:41.454882 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_hosts"
[0m16:08:41.455636 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m16:08:41.456322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:41.994567 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:08:42.047065 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (execute): 16:08:41.446176 => 16:08:42.046689
[0m16:08:42.047819 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: Close
[0m16:08:42.140266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8894d62d-a966-4b40-8659-2866fc2d9eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7666ecaac130>]}
[0m16:08:42.141310 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.71s]
[0m16:08:42.142265 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:08:42.143087 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:08:42.144118 [info ] [Thread-1 (]: 4 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m16:08:42.145346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:08:42.146014 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:08:42.148399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:08:42.149329 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:08:42.146427 => 16:08:42.148995
[0m16:08:42.149909 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_listings
[0m16:08:42.154693 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_listings"
[0m16:08:42.155975 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_listings"
[0m16:08:42.156625 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m16:08:42.157225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:42.729430 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:08:42.746118 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (execute): 16:08:42.150327 => 16:08:42.744737
[0m16:08:42.748841 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: Close
[0m16:08:42.833615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8894d62d-a966-4b40-8659-2866fc2d9eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7666e66449d0>]}
[0m16:08:42.834617 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.69s]
[0m16:08:42.835566 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:08:42.836305 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:08:42.837290 [info ] [Thread-1 (]: 5 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m16:08:42.838420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:08:42.839226 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:08:42.842145 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:08:42.843165 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:08:42.839671 => 16:08:42.842808
[0m16:08:42.843859 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_reviews
[0m16:08:42.848495 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_reviews"
[0m16:08:42.849832 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_reviews"
[0m16:08:42.850685 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m16:08:42.851770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:43.441260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:08:43.445803 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (execute): 16:08:42.844297 => 16:08:43.445521
[0m16:08:43.446433 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: Close
[0m16:08:43.533346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8894d62d-a966-4b40-8659-2866fc2d9eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7666e6647550>]}
[0m16:08:43.535252 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.69s]
[0m16:08:43.537183 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:08:43.540950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:43.542144 [debug] [MainThread]: Connection 'model.dbtdnc.src_reviews' was properly closed.
[0m16:08:43.543206 [info ] [MainThread]: 
[0m16:08:43.544258 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m16:08:43.546887 [debug] [MainThread]: Command end result
[0m16:08:43.563574 [info ] [MainThread]: 
[0m16:08:43.564241 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:08:43.564786 [info ] [MainThread]: 
[0m16:08:43.565384 [error] [MainThread]:   Database Error in model dim_hosts_cleansed (models/src/dim/dim_hosts_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 11 unexpected '{'.
  syntax error line 6 at position 17 unexpected ''src_hosts''.
  syntax error line 6 at position 30 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/src/dim/dim_hosts_cleansed.sql
[0m16:08:43.566168 [info ] [MainThread]: 
[0m16:08:43.567082 [error] [MainThread]:   Database Error in model dim_listings_cleansed (models/src/dim/dim_listings_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 11 unexpected '{'.
  syntax error line 6 at position 17 unexpected ''src_listings''.
  syntax error line 6 at position 33 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/src/dim/dim_listings_cleansed.sql
[0m16:08:43.567884 [info ] [MainThread]: 
[0m16:08:43.568531 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m16:08:43.569768 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.7225842, "process_user_time": 3.964483, "process_kernel_time": 0.836946, "process_mem_max_rss": "196936", "process_in_blocks": "600", "process_out_blocks": "1856", "command_success": false}
[0m16:08:43.571024 [debug] [MainThread]: Command `dbt run` failed at 16:08:43.570730 after 5.72 seconds
[0m16:08:43.571926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766715d7e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7666ecaac220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7666ecaac0a0>]}
[0m16:08:43.572999 [debug] [MainThread]: Flushing usage events
[0m16:10:54.248823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e161da29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1602aa3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1602aa380>]}


============================== 16:10:54.251313 | 72ecc4e6-9256-443f-a558-35a17be52fb9 ==============================
[0m16:10:54.251313 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:10:54.251997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:10:54.910041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72ecc4e6-9256-443f-a558-35a17be52fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1602aa4d0>]}
[0m16:10:54.968184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72ecc4e6-9256-443f-a558-35a17be52fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e138ec0a90>]}
[0m16:10:54.969018 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:10:54.976852 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:10:55.004414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:55.005206 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:55.011510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72ecc4e6-9256-443f-a558-35a17be52fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e138b3c550>]}
[0m16:10:55.019538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72ecc4e6-9256-443f-a558-35a17be52fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e138b09600>]}
[0m16:10:55.020159 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:10:55.020726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72ecc4e6-9256-443f-a558-35a17be52fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e138b0a560>]}
[0m16:10:55.022996 [info ] [MainThread]: 
[0m16:10:55.024019 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:10:55.025730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:10:55.041052 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:10:55.041748 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:10:55.042290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:55.737857 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:10:55.745690 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:10:55.846092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:10:55.879726 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:10:55.881063 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:10:55.882188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:56.490895 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:10:56.497888 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:10:56.601423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72ecc4e6-9256-443f-a558-35a17be52fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e138b6eaa0>]}
[0m16:10:56.605996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:56.610413 [info ] [MainThread]: 
[0m16:10:56.618669 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:10:56.621634 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m16:10:56.625398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.dim_hosts_cleansed)
[0m16:10:56.628050 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:10:56.651237 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:10:56.652817 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:10:56.630055 => 16:10:56.652275
[0m16:10:56.653818 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:10:56.686389 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:10:56.687484 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:10:56.688279 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    WITH src_hosts AS (
    SELECT *
    FROM { { ref('src_hosts') } }
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
  );
[0m16:10:56.688877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:57.045399 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b459be-0000-432c-0000-000052fd2295
[0m16:10:57.048205 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 11 unexpected '{'.
syntax error line 6 at position 17 unexpected ''src_hosts''.
syntax error line 6 at position 30 unexpected '}'.
[0m16:10:57.051656 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:10:56.654651 => 16:10:57.050380
[0m16:10:57.054485 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:10:57.159172 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models/src/dim/dim_hosts_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 11 unexpected '{'.
  syntax error line 6 at position 17 unexpected ''src_hosts''.
  syntax error line 6 at position 30 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/src/dim/dim_hosts_cleansed.sql
[0m16:10:57.162450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ecc4e6-9256-443f-a558-35a17be52fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e138a5f1f0>]}
[0m16:10:57.165735 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model dev.dim_hosts_cleansed .................... [[31mERROR[0m in 0.54s]
[0m16:10:57.169434 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:10:57.172422 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:10:57.179161 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m16:10:57.183294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:10:57.186007 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:10:57.192544 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:10:57.194328 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:10:57.187278 => 16:10:57.193718
[0m16:10:57.195584 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:10:57.204962 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:10:57.206964 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:10:57.208064 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    WITH src_listings AS (
    SELECT *
    FROM { { ref('src_listings') } }
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
  );
[0m16:10:57.208843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:57.590855 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b459be-0000-432c-0000-000052fd2299
[0m16:10:57.594059 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 11 unexpected '{'.
syntax error line 6 at position 17 unexpected ''src_listings''.
syntax error line 6 at position 33 unexpected '}'.
[0m16:10:57.597800 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:10:57.196314 => 16:10:57.596508
[0m16:10:57.600708 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:10:57.699011 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models/src/dim/dim_listings_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 11 unexpected '{'.
  syntax error line 6 at position 17 unexpected ''src_listings''.
  syntax error line 6 at position 33 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/src/dim/dim_listings_cleansed.sql
[0m16:10:57.702675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ecc4e6-9256-443f-a558-35a17be52fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e132719870>]}
[0m16:10:57.707328 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model dev.dim_listings_cleansed ................. [[31mERROR[0m in 0.52s]
[0m16:10:57.711191 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:10:57.714445 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:10:57.718006 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m16:10:57.720974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.src_hosts)
[0m16:10:57.722795 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:10:57.728317 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:10:57.730425 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:10:57.723964 => 16:10:57.729845
[0m16:10:57.731493 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_hosts
[0m16:10:57.737921 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_hosts"
[0m16:10:57.739506 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_hosts"
[0m16:10:57.740318 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m16:10:57.741094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:58.471489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:58.502154 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (execute): 16:10:57.732170 => 16:10:58.501869
[0m16:10:58.502868 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: Close
[0m16:10:58.605463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ecc4e6-9256-443f-a558-35a17be52fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e132719870>]}
[0m16:10:58.609660 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.88s]
[0m16:10:58.614098 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:10:58.618762 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:10:58.623404 [info ] [Thread-1 (]: 4 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m16:10:58.627515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:10:58.629284 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:10:58.634416 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:10:58.636497 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:10:58.630347 => 16:10:58.635532
[0m16:10:58.638137 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_listings
[0m16:10:58.647052 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_listings"
[0m16:10:58.648624 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_listings"
[0m16:10:58.649379 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m16:10:58.650050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:59.271346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:59.287027 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (execute): 16:10:58.639216 => 16:10:59.285714
[0m16:10:59.289704 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: Close
[0m16:10:59.378118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ecc4e6-9256-443f-a558-35a17be52fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e132725e40>]}
[0m16:10:59.380165 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.75s]
[0m16:10:59.381731 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:10:59.382926 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:10:59.384204 [info ] [Thread-1 (]: 5 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m16:10:59.386239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:10:59.387481 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:10:59.391671 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:10:59.392957 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:10:59.388219 => 16:10:59.392536
[0m16:10:59.393877 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_reviews
[0m16:10:59.398931 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_reviews"
[0m16:10:59.400650 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_reviews"
[0m16:10:59.401312 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m16:10:59.401909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:59.986402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:00.002224 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (execute): 16:10:59.394393 => 16:11:00.000968
[0m16:11:00.005213 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: Close
[0m16:11:00.100564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ecc4e6-9256-443f-a558-35a17be52fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e132718d30>]}
[0m16:11:00.104378 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.71s]
[0m16:11:00.108186 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:11:00.116111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:00.118601 [debug] [MainThread]: Connection 'model.dbtdnc.src_reviews' was properly closed.
[0m16:11:00.119986 [info ] [MainThread]: 
[0m16:11:00.121648 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m16:11:00.124668 [debug] [MainThread]: Command end result
[0m16:11:00.138823 [info ] [MainThread]: 
[0m16:11:00.139669 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:11:00.140466 [info ] [MainThread]: 
[0m16:11:00.141321 [error] [MainThread]:   Database Error in model dim_hosts_cleansed (models/src/dim/dim_hosts_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 11 unexpected '{'.
  syntax error line 6 at position 17 unexpected ''src_hosts''.
  syntax error line 6 at position 30 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/src/dim/dim_hosts_cleansed.sql
[0m16:11:00.142488 [info ] [MainThread]: 
[0m16:11:00.143529 [error] [MainThread]:   Database Error in model dim_listings_cleansed (models/src/dim/dim_listings_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 11 unexpected '{'.
  syntax error line 6 at position 17 unexpected ''src_listings''.
  syntax error line 6 at position 33 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/src/dim/dim_listings_cleansed.sql
[0m16:11:00.144467 [info ] [MainThread]: 
[0m16:11:00.145409 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m16:11:00.146623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.9393473, "process_user_time": 4.035079, "process_kernel_time": 0.687282, "process_mem_max_rss": "197012", "process_out_blocks": "1856", "command_success": false, "process_in_blocks": "0"}
[0m16:11:00.147483 [debug] [MainThread]: Command `dbt run` failed at 16:11:00.147268 after 5.94 seconds
[0m16:11:00.148266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e161da29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e138e4cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e132651030>]}
[0m16:11:00.148882 [debug] [MainThread]: Flushing usage events
[0m16:11:13.504681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7eb83ba9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7eb66c63e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7eb66c6380>]}


============================== 16:11:13.507381 | 13a32a83-5a0d-453c-a489-66df6eef44c7 ==============================
[0m16:11:13.507381 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:11:13.508092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:11:14.169713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13a32a83-5a0d-453c-a489-66df6eef44c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7eb66c64d0>]}
[0m16:11:14.228293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13a32a83-5a0d-453c-a489-66df6eef44c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7e8b4cc730>]}
[0m16:11:14.229129 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:11:14.236429 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:11:14.268673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:14.269303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:14.274890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13a32a83-5a0d-453c-a489-66df6eef44c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7e8b1c0550>]}
[0m16:11:14.282978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13a32a83-5a0d-453c-a489-66df6eef44c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7e8b18d660>]}
[0m16:11:14.283646 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:11:14.284273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13a32a83-5a0d-453c-a489-66df6eef44c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7e8b18e4a0>]}
[0m16:11:14.286190 [info ] [MainThread]: 
[0m16:11:14.287254 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:14.288718 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:11:14.302334 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:11:14.302964 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:11:14.303456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:14.943770 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:11:14.950161 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:11:15.057917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:11:15.094946 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:11:15.096053 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:11:15.096991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:15.726009 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:11:15.733228 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:11:15.842376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13a32a83-5a0d-453c-a489-66df6eef44c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7e8aff2b60>]}
[0m16:11:15.846203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:15.848574 [info ] [MainThread]: 
[0m16:11:15.856987 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:11:15.860076 [info ] [Thread-1 (]: 1 of 5 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m16:11:15.864315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.dim_hosts_cleansed)
[0m16:11:15.866974 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:11:15.894092 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:11:15.896244 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:11:15.868929 => 16:11:15.895448
[0m16:11:15.897855 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:11:15.938468 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:11:15.939607 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:11:15.940165 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.dev.dim_hosts_cleansed
         as
        (WITH src_hosts AS (
    SELECT *
    FROM { { ref('src_hosts') } }
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
        );
[0m16:11:15.940709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:16.293089 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b459bf-0000-4325-0000-000052fd3239
[0m16:11:16.294709 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 11 unexpected '{'.
syntax error line 5 at position 17 unexpected ''src_hosts''.
syntax error line 5 at position 30 unexpected '}'.
[0m16:11:16.296693 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:11:15.898918 => 16:11:16.295957
[0m16:11:16.298415 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:11:16.391277 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 11 unexpected '{'.
  syntax error line 5 at position 17 unexpected ''src_hosts''.
  syntax error line 5 at position 30 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/dim/dim_hosts_cleansed.sql
[0m16:11:16.394577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a32a83-5a0d-453c-a489-66df6eef44c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7e8b0e31f0>]}
[0m16:11:16.398193 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model dev.dim_hosts_cleansed ................... [[31mERROR[0m in 0.53s]
[0m16:11:16.401907 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:11:16.404917 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:11:16.409726 [info ] [Thread-1 (]: 2 of 5 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m16:11:16.412550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:11:16.414029 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:11:16.422565 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:11:16.424039 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:11:16.414975 => 16:11:16.423534
[0m16:11:16.425015 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:11:16.431436 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:11:16.433069 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:11:16.433808 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (WITH src_listings AS (
    SELECT *
    FROM { { ref('src_listings') } }
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
        );
[0m16:11:16.434548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:16.777250 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b459bf-0000-4325-0000-000052fd323d
[0m16:11:16.780581 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 11 unexpected '{'.
syntax error line 5 at position 17 unexpected ''src_listings''.
syntax error line 5 at position 33 unexpected '}'.
[0m16:11:16.784645 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:11:16.425809 => 16:11:16.783145
[0m16:11:16.789308 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:11:16.895852 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 11 unexpected '{'.
  syntax error line 5 at position 17 unexpected ''src_listings''.
  syntax error line 5 at position 33 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/dim/dim_listings_cleansed.sql
[0m16:11:16.898965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a32a83-5a0d-453c-a489-66df6eef44c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7e8b0be7a0>]}
[0m16:11:16.903469 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model dev.dim_listings_cleansed ................ [[31mERROR[0m in 0.49s]
[0m16:11:16.908525 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:11:16.911331 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:11:16.914438 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m16:11:16.917115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.src_hosts)
[0m16:11:16.919084 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:11:16.924343 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:11:16.926432 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:11:16.920331 => 16:11:16.925404
[0m16:11:16.928476 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_hosts
[0m16:11:16.956644 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_hosts"
[0m16:11:16.958333 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_hosts"
[0m16:11:16.959068 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m16:11:16.959619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:17.470250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:17.522059 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (execute): 16:11:16.929221 => 16:11:17.521684
[0m16:11:17.522926 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: Close
[0m16:11:17.619833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a32a83-5a0d-453c-a489-66df6eef44c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7e88d472e0>]}
[0m16:11:17.623930 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.70s]
[0m16:11:17.627690 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:11:17.630482 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:11:17.633751 [info ] [Thread-1 (]: 4 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m16:11:17.638817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:11:17.641237 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:11:17.646995 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:11:17.648848 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:11:17.642507 => 16:11:17.648157
[0m16:11:17.650243 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_listings
[0m16:11:17.659746 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_listings"
[0m16:11:17.661433 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_listings"
[0m16:11:17.662432 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m16:11:17.663259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:18.206661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:18.214937 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (execute): 16:11:17.651088 => 16:11:18.214223
[0m16:11:18.216369 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: Close
[0m16:11:18.313283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a32a83-5a0d-453c-a489-66df6eef44c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7e88d47e20>]}
[0m16:11:18.316720 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.68s]
[0m16:11:18.320255 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:11:18.323392 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:11:18.327040 [info ] [Thread-1 (]: 5 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m16:11:18.330759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:11:18.333550 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:11:18.341713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:11:18.343673 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:11:18.335753 => 16:11:18.342977
[0m16:11:18.345149 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_reviews
[0m16:11:18.353278 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_reviews"
[0m16:11:18.355318 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_reviews"
[0m16:11:18.356403 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m16:11:18.357447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:18.917508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:18.923708 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (execute): 16:11:18.346101 => 16:11:18.923161
[0m16:11:18.924804 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: Close
[0m16:11:19.013935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a32a83-5a0d-453c-a489-66df6eef44c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7e88d44cd0>]}
[0m16:11:19.017276 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:11:19.021715 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:11:19.028484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:19.030121 [debug] [MainThread]: Connection 'model.dbtdnc.src_reviews' was properly closed.
[0m16:11:19.031813 [info ] [MainThread]: 
[0m16:11:19.033410 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m16:11:19.036913 [debug] [MainThread]: Command end result
[0m16:11:19.052913 [info ] [MainThread]: 
[0m16:11:19.053732 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:11:19.054442 [info ] [MainThread]: 
[0m16:11:19.055109 [error] [MainThread]:   Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 11 unexpected '{'.
  syntax error line 5 at position 17 unexpected ''src_hosts''.
  syntax error line 5 at position 30 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/dim/dim_hosts_cleansed.sql
[0m16:11:19.055749 [info ] [MainThread]: 
[0m16:11:19.056365 [error] [MainThread]:   Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 11 unexpected '{'.
  syntax error line 5 at position 17 unexpected ''src_listings''.
  syntax error line 5 at position 33 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/dim/dim_listings_cleansed.sql
[0m16:11:19.056998 [info ] [MainThread]: 
[0m16:11:19.057678 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m16:11:19.058879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.596152, "process_user_time": 4.003304, "process_kernel_time": 0.853557, "process_mem_max_rss": "196896", "process_out_blocks": "1848", "command_success": false, "process_in_blocks": "0"}
[0m16:11:19.059728 [debug] [MainThread]: Command `dbt run` failed at 16:11:19.059506 after 5.60 seconds
[0m16:11:19.060349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7eb83ba9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7e8affffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7eb66c6440>]}
[0m16:11:19.060962 [debug] [MainThread]: Flushing usage events
[0m16:13:39.686109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b470c77ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b470ac86470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b470ac86410>]}


============================== 16:13:39.688921 | 09a679c0-5535-4eea-8c77-3a00cacf6368 ==============================
[0m16:13:39.688921 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:13:39.689734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:13:40.341472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09a679c0-5535-4eea-8c77-3a00cacf6368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b470ac86560>]}
[0m16:13:40.406974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09a679c0-5535-4eea-8c77-3a00cacf6368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46df7a3070>]}
[0m16:13:40.407861 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:13:40.415008 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:13:40.448926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:40.449597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:40.456818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09a679c0-5535-4eea-8c77-3a00cacf6368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46df4945e0>]}
[0m16:13:40.469289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09a679c0-5535-4eea-8c77-3a00cacf6368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46df4616f0>]}
[0m16:13:40.470042 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:13:40.470656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09a679c0-5535-4eea-8c77-3a00cacf6368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46df462530>]}
[0m16:13:40.472399 [info ] [MainThread]: 
[0m16:13:40.473289 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:13:40.474729 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:13:40.488840 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:13:40.489575 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:13:40.490329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:41.207588 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:13:41.214065 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:13:41.326196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:13:41.360113 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:13:41.361465 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:13:41.362676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:41.778080 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m16:13:41.785225 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:13:41.889618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09a679c0-5535-4eea-8c77-3a00cacf6368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46df461ab0>]}
[0m16:13:41.891920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:13:41.893300 [info ] [MainThread]: 
[0m16:13:41.897044 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:13:41.898657 [info ] [Thread-1 (]: 1 of 5 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m16:13:41.901192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.dim_hosts_cleansed)
[0m16:13:41.902815 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:13:41.917456 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:13:41.919136 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:13:41.903848 => 16:13:41.918528
[0m16:13:41.920179 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:13:41.969452 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:13:41.971294 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:13:41.972043 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.dev.dim_hosts_cleansed
         as
        (WITH src_hosts AS (
    SELECT *
    FROM { { ref('src_hosts') } }
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
        );
[0m16:13:41.972789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:42.492048 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b459c1-0000-4325-0000-000052fd3269
[0m16:13:42.495015 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 11 unexpected '{'.
syntax error line 5 at position 17 unexpected ''src_hosts''.
syntax error line 5 at position 30 unexpected '}'.
[0m16:13:42.498560 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:13:41.920831 => 16:13:42.497238
[0m16:13:42.501322 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:13:42.596816 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 11 unexpected '{'.
  syntax error line 5 at position 17 unexpected ''src_hosts''.
  syntax error line 5 at position 30 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/dim/dim_hosts_cleansed.sql
[0m16:13:42.600068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09a679c0-5535-4eea-8c77-3a00cacf6368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46df3b17e0>]}
[0m16:13:42.603665 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model dev.dim_hosts_cleansed ................... [[31mERROR[0m in 0.70s]
[0m16:13:42.607665 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:13:42.610833 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:13:42.615279 [info ] [Thread-1 (]: 2 of 5 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m16:13:42.618294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:13:42.620178 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:13:42.627339 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:13:42.628986 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:13:42.621098 => 16:13:42.628407
[0m16:13:42.630237 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:13:42.637737 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:13:42.639512 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:13:42.640445 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (WITH src_listings AS (
    SELECT *
    FROM { { ref('src_listings') } }
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
        );
[0m16:13:42.641157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:42.983067 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b459c1-0000-432c-0000-000052fd22d1
[0m16:13:42.985965 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 11 unexpected '{'.
syntax error line 5 at position 17 unexpected ''src_listings''.
syntax error line 5 at position 33 unexpected '}'.
[0m16:13:42.989835 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:13:42.631264 => 16:13:42.988446
[0m16:13:42.992566 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:13:43.091994 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 11 unexpected '{'.
  syntax error line 5 at position 17 unexpected ''src_listings''.
  syntax error line 5 at position 33 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/dim/dim_listings_cleansed.sql
[0m16:13:43.095107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09a679c0-5535-4eea-8c77-3a00cacf6368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46dea23c10>]}
[0m16:13:43.098387 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model dev.dim_listings_cleansed ................ [[31mERROR[0m in 0.48s]
[0m16:13:43.103149 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:13:43.106813 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:13:43.110168 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m16:13:43.113181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.src_hosts)
[0m16:13:43.114967 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:13:43.120546 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:13:43.122662 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:13:43.115866 => 16:13:43.121989
[0m16:13:43.123839 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_hosts
[0m16:13:43.161654 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_hosts"
[0m16:13:43.163461 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_hosts"
[0m16:13:43.164582 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m16:13:43.165525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:43.732594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:13:43.781100 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (execute): 16:13:43.124573 => 16:13:43.780362
[0m16:13:43.782419 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: Close
[0m16:13:43.878730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09a679c0-5535-4eea-8c77-3a00cacf6368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46dd00e050>]}
[0m16:13:43.881563 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.77s]
[0m16:13:43.883800 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:13:43.886244 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:13:43.889214 [info ] [Thread-1 (]: 4 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m16:13:43.891992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:13:43.893555 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:13:43.898678 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:13:43.901471 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:13:43.894641 => 16:13:43.900293
[0m16:13:43.903529 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_listings
[0m16:13:43.919894 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_listings"
[0m16:13:43.924142 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_listings"
[0m16:13:43.926179 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m16:13:43.927766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:44.489936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:13:44.494326 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (execute): 16:13:43.905208 => 16:13:44.493971
[0m16:13:44.495074 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: Close
[0m16:13:44.593468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09a679c0-5535-4eea-8c77-3a00cacf6368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46dd00d690>]}
[0m16:13:44.596996 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.70s]
[0m16:13:44.601694 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:13:44.605651 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:13:44.609095 [info ] [Thread-1 (]: 5 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m16:13:44.613182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:13:44.615592 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:13:44.623783 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:13:44.626391 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:13:44.617771 => 16:13:44.625268
[0m16:13:44.628650 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_reviews
[0m16:13:44.640888 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_reviews"
[0m16:13:44.645201 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_reviews"
[0m16:13:44.646663 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m16:13:44.649106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:45.182420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:13:45.198921 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (execute): 16:13:44.629586 => 16:13:45.197526
[0m16:13:45.201895 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: Close
[0m16:13:45.301657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09a679c0-5535-4eea-8c77-3a00cacf6368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46dd00c190>]}
[0m16:13:45.303406 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.69s]
[0m16:13:45.304464 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:13:45.306545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:45.307286 [debug] [MainThread]: Connection 'model.dbtdnc.src_reviews' was properly closed.
[0m16:13:45.307866 [info ] [MainThread]: 
[0m16:13:45.308485 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m16:13:45.311721 [debug] [MainThread]: Command end result
[0m16:13:45.332259 [info ] [MainThread]: 
[0m16:13:45.334370 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:13:45.336252 [info ] [MainThread]: 
[0m16:13:45.338544 [error] [MainThread]:   Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 11 unexpected '{'.
  syntax error line 5 at position 17 unexpected ''src_hosts''.
  syntax error line 5 at position 30 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/dim/dim_hosts_cleansed.sql
[0m16:13:45.341766 [info ] [MainThread]: 
[0m16:13:45.344189 [error] [MainThread]:   Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 11 unexpected '{'.
  syntax error line 5 at position 17 unexpected ''src_listings''.
  syntax error line 5 at position 33 unexpected '}'.
  compiled Code at target/run/dbtdnc/models/dim/dim_listings_cleansed.sql
[0m16:13:45.346161 [info ] [MainThread]: 
[0m16:13:45.347397 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m16:13:45.349736 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.705737, "process_user_time": 4.148999, "process_kernel_time": 0.81228, "process_mem_max_rss": "196800", "process_in_blocks": "8", "process_out_blocks": "1856", "command_success": false}
[0m16:13:45.353223 [debug] [MainThread]: Command `dbt run` failed at 16:13:45.352101 after 5.71 seconds
[0m16:13:45.356370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b470c77ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46df4cbe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b470ac863b0>]}
[0m16:13:45.359198 [debug] [MainThread]: Flushing usage events
[0m16:15:41.362964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70394ef72140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70394d2ca4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70394d2ca440>]}


============================== 16:15:41.365431 | 6765d8b9-1426-44f6-aa76-ff13258c16fe ==============================
[0m16:15:41.365431 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:15:41.366081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:15:41.995945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6765d8b9-1426-44f6-aa76-ff13258c16fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70394d2ca590>]}
[0m16:15:42.055379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6765d8b9-1426-44f6-aa76-ff13258c16fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703921e8b0a0>]}
[0m16:15:42.056298 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:15:42.063311 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:15:42.091328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:42.092123 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:42.097555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6765d8b9-1426-44f6-aa76-ff13258c16fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703921b8fe20>]}
[0m16:15:42.106735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6765d8b9-1426-44f6-aa76-ff13258c16fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703921d51d50>]}
[0m16:15:42.107401 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:15:42.107950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6765d8b9-1426-44f6-aa76-ff13258c16fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703921d52620>]}
[0m16:15:42.109756 [info ] [MainThread]: 
[0m16:15:42.110716 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:15:42.112101 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:15:42.127188 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:15:42.127789 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:15:42.128285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:42.835690 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:15:42.842512 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:15:42.950075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:15:42.959557 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:15:42.960157 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:15:42.960659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:43.345313 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m16:15:43.352736 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:15:43.466448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6765d8b9-1426-44f6-aa76-ff13258c16fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70394d2ca3e0>]}
[0m16:15:43.470625 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:15:43.473125 [info ] [MainThread]: 
[0m16:15:43.481532 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:15:43.485182 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m16:15:43.489383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.src_hosts)
[0m16:15:43.492642 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:15:43.515919 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:15:43.517595 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:15:43.494643 => 16:15:43.517029
[0m16:15:43.518721 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_hosts
[0m16:15:43.551380 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_hosts"
[0m16:15:43.553131 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_hosts"
[0m16:15:43.554054 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m16:15:43.554936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:44.254424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:15:44.305115 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (execute): 16:15:43.519357 => 16:15:44.304761
[0m16:15:44.305843 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: Close
[0m16:15:44.396488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6765d8b9-1426-44f6-aa76-ff13258c16fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703921d52710>]}
[0m16:15:44.397660 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.91s]
[0m16:15:44.398884 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:15:44.399788 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:15:44.400883 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m16:15:44.402258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:15:44.403261 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:15:44.406531 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:15:44.407797 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:15:44.403852 => 16:15:44.407370
[0m16:15:44.408638 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_listings
[0m16:15:44.414753 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_listings"
[0m16:15:44.416354 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_listings"
[0m16:15:44.417233 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m16:15:44.418085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:44.961842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:15:44.977310 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (execute): 16:15:44.409157 => 16:15:44.976071
[0m16:15:44.979902 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: Close
[0m16:15:45.075977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6765d8b9-1426-44f6-aa76-ff13258c16fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703921c33d30>]}
[0m16:15:45.080461 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.67s]
[0m16:15:45.084406 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:15:45.088139 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:15:45.092804 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m16:15:45.097986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:15:45.100374 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:15:45.107314 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:15:45.109523 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:15:45.101658 => 16:15:45.108778
[0m16:15:45.110844 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_reviews
[0m16:15:45.118152 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_reviews"
[0m16:15:45.121070 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_reviews"
[0m16:15:45.122559 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m16:15:45.123652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:45.643724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:15:45.660665 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (execute): 16:15:45.111585 => 16:15:45.659349
[0m16:15:45.663329 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: Close
[0m16:15:45.757044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6765d8b9-1426-44f6-aa76-ff13258c16fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703921c33f10>]}
[0m16:15:45.761570 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.66s]
[0m16:15:45.766087 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:15:45.768104 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:15:45.769876 [info ] [Thread-1 (]: 4 of 5 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m16:15:45.772419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_reviews, now model.dbtdnc.dim_hosts_cleansed)
[0m16:15:45.773775 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:15:45.779825 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:15:45.781131 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:15:45.774520 => 16:15:45.780660
[0m16:15:45.782062 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:15:45.811626 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:15:45.812784 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:15:45.813354 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.dev.dim_hosts_cleansed
         as
        (WITH src_hosts AS (
    SELECT *
    FROM AIRBNB.dev.src_hosts
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
        );
[0m16:15:45.813934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:47.478920 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:15:47.492745 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:15:45.782729 => 16:15:47.491507
[0m16:15:47.495413 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:15:47.600831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6765d8b9-1426-44f6-aa76-ff13258c16fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70392121f9a0>]}
[0m16:15:47.605806 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.83s]
[0m16:15:47.610049 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:15:47.613447 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:15:47.617415 [info ] [Thread-1 (]: 5 of 5 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m16:15:47.621300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:15:47.623673 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:15:47.632371 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:15:47.634542 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:15:47.624673 => 16:15:47.633846
[0m16:15:47.635821 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:15:47.643916 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:15:47.647154 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:15:47.648318 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (WITH src_listings AS (
    SELECT *
    FROM AIRBNB.dev.src_listings
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
        );
[0m16:15:47.649410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:48.942030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:15:48.956978 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:15:47.636901 => 16:15:48.955689
[0m16:15:48.959610 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:15:49.049761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6765d8b9-1426-44f6-aa76-ff13258c16fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70392121fb20>]}
[0m16:15:49.053678 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.43s]
[0m16:15:49.060074 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:15:49.068607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:49.070690 [debug] [MainThread]: Connection 'model.dbtdnc.dim_listings_cleansed' was properly closed.
[0m16:15:49.072400 [info ] [MainThread]: 
[0m16:15:49.073845 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 6.96 seconds (6.96s).
[0m16:15:49.077315 [debug] [MainThread]: Command end result
[0m16:15:49.094961 [info ] [MainThread]: 
[0m16:15:49.095958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:49.097081 [info ] [MainThread]: 
[0m16:15:49.098166 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:15:49.099788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.7786603, "process_user_time": 3.927094, "process_kernel_time": 0.818263, "process_mem_max_rss": "195840", "process_out_blocks": "1856", "process_in_blocks": "0"}
[0m16:15:49.101741 [debug] [MainThread]: Command `dbt run` succeeded at 16:15:49.101123 after 7.78 seconds
[0m16:15:49.103496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70394ef72140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7039211e6260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7039211e6ef0>]}
[0m16:15:49.104863 [debug] [MainThread]: Flushing usage events
[0m16:20:10.862014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c497ba9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c47ac6440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c47ac63e0>]}


============================== 16:20:10.864538 | d77f2604-da3a-411b-bbdd-1085a9f326b0 ==============================
[0m16:20:10.864538 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:20:10.865308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:20:11.569382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd77f2604-da3a-411b-bbdd-1085a9f326b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c47ac6530>]}
[0m16:20:11.645431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd77f2604-da3a-411b-bbdd-1085a9f326b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c47ac5c90>]}
[0m16:20:11.646617 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:20:11.660993 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:20:11.711600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:11.712634 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:11.721563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd77f2604-da3a-411b-bbdd-1085a9f326b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c205c0bb0>]}
[0m16:20:11.735521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd77f2604-da3a-411b-bbdd-1085a9f326b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c20592200>]}
[0m16:20:11.736562 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:20:11.737147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd77f2604-da3a-411b-bbdd-1085a9f326b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c20592b60>]}
[0m16:20:11.739706 [info ] [MainThread]: 
[0m16:20:11.741011 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:20:11.742667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:20:11.759520 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:20:11.760162 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:20:11.760671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:12.538909 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:20:12.541983 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:20:12.640530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:20:12.654178 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:20:12.655701 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:20:12.656618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:13.093387 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:20:13.101241 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:20:13.211298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd77f2604-da3a-411b-bbdd-1085a9f326b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c203f92d0>]}
[0m16:20:13.212472 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:13.213327 [info ] [MainThread]: 
[0m16:20:13.216331 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:20:13.217220 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.src_hosts ...................................... [RUN]
[0m16:20:13.218248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.src_hosts)
[0m16:20:13.219258 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:20:13.231523 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:20:13.232885 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:20:13.219919 => 16:20:13.232423
[0m16:20:13.234407 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_hosts
[0m16:20:13.291354 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_hosts"
[0m16:20:13.292708 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_hosts"
[0m16:20:13.293329 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m16:20:13.293888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:14.059196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:20:14.111711 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (execute): 16:20:13.235731 => 16:20:14.111395
[0m16:20:14.112444 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: Close
[0m16:20:14.208584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd77f2604-da3a-411b-bbdd-1085a9f326b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c2046bdc0>]}
[0m16:20:14.212292 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.99s]
[0m16:20:14.215942 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:20:14.218967 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:20:14.224856 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m16:20:14.228906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:20:14.230704 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:20:14.235716 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:20:14.238085 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:20:14.231591 => 16:20:14.237273
[0m16:20:14.240380 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_listings
[0m16:20:14.248201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_listings"
[0m16:20:14.250934 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_listings"
[0m16:20:14.252250 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m16:20:14.253444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:14.778244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:20:14.796305 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (execute): 16:20:14.241391 => 16:20:14.795027
[0m16:20:14.798661 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: Close
[0m16:20:14.884633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd77f2604-da3a-411b-bbdd-1085a9f326b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c202f0610>]}
[0m16:20:14.885917 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.66s]
[0m16:20:14.887353 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:20:14.888522 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:20:14.890509 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.src_reviews .................................... [RUN]
[0m16:20:14.892322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:20:14.893417 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:20:14.897545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:20:14.899554 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:20:14.894101 => 16:20:14.898812
[0m16:20:14.900625 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_reviews
[0m16:20:14.907616 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_reviews"
[0m16:20:14.909238 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_reviews"
[0m16:20:14.910092 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m16:20:14.910971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:15.440177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:20:15.445202 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (execute): 16:20:14.901368 => 16:20:15.444802
[0m16:20:15.446324 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: Close
[0m16:20:15.539640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd77f2604-da3a-411b-bbdd-1085a9f326b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c2032ebc0>]}
[0m16:20:15.543368 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.65s]
[0m16:20:15.547359 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:20:15.552106 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:20:15.558470 [info ] [Thread-1 (]: 4 of 6 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m16:20:15.562993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_reviews, now model.dbtdnc.dim_hosts_cleansed)
[0m16:20:15.564721 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:20:15.573145 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:20:15.575002 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:20:15.565605 => 16:20:15.574473
[0m16:20:15.575919 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:20:15.605663 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:20:15.607062 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:20:15.607744 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.dev.dim_hosts_cleansed
         as
        (WITH src_hosts AS (
    SELECT *
    FROM AIRBNB.dev.src_hosts
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
        );
[0m16:20:15.608294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:16.860451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:20:16.878210 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:20:15.576499 => 16:20:16.876971
[0m16:20:16.880370 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:20:16.975616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd77f2604-da3a-411b-bbdd-1085a9f326b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c205e2350>]}
[0m16:20:16.976645 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.41s]
[0m16:20:16.977442 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:20:16.978074 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:20:16.979014 [info ] [Thread-1 (]: 5 of 6 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m16:20:16.979976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:20:16.980646 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:20:16.985342 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:20:16.986600 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:20:16.981028 => 16:20:16.986199
[0m16:20:16.987455 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:20:16.995165 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:20:16.996679 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:20:16.997329 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (WITH src_listings AS (
    SELECT *
    FROM AIRBNB.dev.src_listings
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
        );
[0m16:20:16.997919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:18.292146 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:20:18.298504 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:20:16.988084 => 16:20:18.298045
[0m16:20:18.299504 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:20:18.401553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd77f2604-da3a-411b-bbdd-1085a9f326b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c202f05e0>]}
[0m16:20:18.405822 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.42s]
[0m16:20:18.410432 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:20:18.413578 [debug] [Thread-1 (]: Began running node model.dbtdnc.fct_reviews
[0m16:20:18.417680 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m16:20:18.424515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.fct_reviews)
[0m16:20:18.428752 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.fct_reviews
[0m16:20:18.478726 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.fct_reviews"
[0m16:20:18.485316 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (compile): 16:20:18.431674 => 16:20:18.482872
[0m16:20:18.489931 [debug] [Thread-1 (]: Began executing node model.dbtdnc.fct_reviews
[0m16:20:18.589524 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.fct_reviews"
[0m16:20:18.592799 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:20:18.594554 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
create or replace transient table AIRBNB.dev.fct_reviews
         as
        (
with src_reviews as (select * from AIRBNB.dev.src_reviews)
select *
from src_reviews
where
    review_text is not null
    
        );
[0m16:20:18.595379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:23.198027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m16:20:23.224586 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:20:23.234518 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:20:23.235723 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m16:20:23.298250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:20:23.301457 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (execute): 16:20:18.492541 => 16:20:23.301152
[0m16:20:23.302199 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: Close
[0m16:20:23.398370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd77f2604-da3a-411b-bbdd-1085a9f326b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c204dd990>]}
[0m16:20:23.402021 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 1[0m in 4.98s]
[0m16:20:23.406488 [debug] [Thread-1 (]: Finished running node model.dbtdnc.fct_reviews
[0m16:20:23.415907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:23.419804 [debug] [MainThread]: Connection 'model.dbtdnc.fct_reviews' was properly closed.
[0m16:20:23.424265 [info ] [MainThread]: 
[0m16:20:23.428922 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 11.68 seconds (11.68s).
[0m16:20:23.438246 [debug] [MainThread]: Command end result
[0m16:20:23.463133 [info ] [MainThread]: 
[0m16:20:23.464367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:23.465069 [info ] [MainThread]: 
[0m16:20:23.465704 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:20:23.466859 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.651914, "process_user_time": 4.50133, "process_kernel_time": 0.846981, "process_mem_max_rss": "196088", "process_out_blocks": "1880", "process_in_blocks": "0"}
[0m16:20:23.467694 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:23.467480 after 12.65 seconds
[0m16:20:23.468330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c497ba9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c20267eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c203fa860>]}
[0m16:20:23.468933 [debug] [MainThread]: Flushing usage events
[0m16:23:27.036682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707118fb29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7071172be440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7071172be3e0>]}


============================== 16:23:27.039166 | 21254ba8-4aeb-48a1-b30f-a3c44be9d66c ==============================
[0m16:23:27.039166 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:23:27.040019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:23:27.758946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21254ba8-4aeb-48a1-b30f-a3c44be9d66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7071172be530>]}
[0m16:23:27.832963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21254ba8-4aeb-48a1-b30f-a3c44be9d66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7071172bdc90>]}
[0m16:23:27.834465 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:23:27.842635 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:23:27.873226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:27.873792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:27.879440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21254ba8-4aeb-48a1-b30f-a3c44be9d66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070ebd64bb0>]}
[0m16:23:27.888540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21254ba8-4aeb-48a1-b30f-a3c44be9d66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070ebd36200>]}
[0m16:23:27.889172 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:23:27.889711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21254ba8-4aeb-48a1-b30f-a3c44be9d66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070ebd36b60>]}
[0m16:23:27.891434 [info ] [MainThread]: 
[0m16:23:27.892264 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:23:27.893662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:23:27.908273 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:23:27.908914 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:23:27.909441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:28.620445 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:23:28.629729 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:23:28.747586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:23:28.781134 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:23:28.783013 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:23:28.784401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:23:29.379902 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m16:23:29.382903 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:23:29.494972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21254ba8-4aeb-48a1-b30f-a3c44be9d66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7071172be380>]}
[0m16:23:29.499805 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:23:29.502490 [info ] [MainThread]: 
[0m16:23:29.510673 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:23:29.513586 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.src_hosts ...................................... [RUN]
[0m16:23:29.517707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.src_hosts)
[0m16:23:29.519690 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:23:29.535765 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:23:29.537624 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:23:29.520901 => 16:23:29.536901
[0m16:23:29.538754 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_hosts
[0m16:23:29.569945 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_hosts"
[0m16:23:29.571081 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_hosts"
[0m16:23:29.571705 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m16:23:29.572292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:30.160472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:23:30.215507 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (execute): 16:23:29.539289 => 16:23:30.215108
[0m16:23:30.216575 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: Close
[0m16:23:30.312561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21254ba8-4aeb-48a1-b30f-a3c44be9d66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070ebc13dc0>]}
[0m16:23:30.316226 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.80s]
[0m16:23:30.320192 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:23:30.323225 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:23:30.326323 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m16:23:30.330868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:23:30.333598 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:23:30.341275 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:23:30.343418 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:23:30.335345 => 16:23:30.342717
[0m16:23:30.345568 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_listings
[0m16:23:30.356487 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_listings"
[0m16:23:30.358734 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_listings"
[0m16:23:30.360176 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m16:23:30.361550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:30.892697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:23:30.908720 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (execute): 16:23:30.347228 => 16:23:30.907498
[0m16:23:30.911258 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: Close
[0m16:23:31.007098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21254ba8-4aeb-48a1-b30f-a3c44be9d66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070eb2908e0>]}
[0m16:23:31.010460 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.68s]
[0m16:23:31.014198 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:23:31.016335 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:23:31.018777 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.src_reviews .................................... [RUN]
[0m16:23:31.020787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:23:31.022130 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:23:31.026892 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:23:31.028583 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:23:31.022999 => 16:23:31.027957
[0m16:23:31.030612 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_reviews
[0m16:23:31.037481 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_reviews"
[0m16:23:31.038890 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_reviews"
[0m16:23:31.039664 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m16:23:31.040788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:31.581345 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:23:31.585616 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (execute): 16:23:31.031613 => 16:23:31.585318
[0m16:23:31.586388 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: Close
[0m16:23:31.678113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21254ba8-4aeb-48a1-b30f-a3c44be9d66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070eb2d6bc0>]}
[0m16:23:31.679638 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.66s]
[0m16:23:31.681318 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:23:31.682584 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:23:31.684181 [info ] [Thread-1 (]: 4 of 6 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m16:23:31.685848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_reviews, now model.dbtdnc.dim_hosts_cleansed)
[0m16:23:31.687070 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:23:31.692570 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:23:31.694092 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:23:31.687776 => 16:23:31.693535
[0m16:23:31.695245 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:23:31.727145 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:23:31.728414 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:23:31.729385 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.dev.dim_hosts_cleansed
         as
        (WITH src_hosts AS (
    SELECT *
    FROM AIRBNB.dev.src_hosts
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
        );
[0m16:23:31.730154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:33.022762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:23:33.027557 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:23:31.695948 => 16:23:33.027175
[0m16:23:33.028364 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:23:33.139706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21254ba8-4aeb-48a1-b30f-a3c44be9d66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070eb22dd20>]}
[0m16:23:33.143134 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.45s]
[0m16:23:33.146856 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:23:33.149601 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:23:33.153561 [info ] [Thread-1 (]: 5 of 6 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m16:23:33.157615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:23:33.160124 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:23:33.168637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:23:33.170620 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:23:33.161574 => 16:23:33.170010
[0m16:23:33.171751 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:23:33.177719 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:23:33.179789 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:23:33.180742 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (WITH src_listings AS (
    SELECT *
    FROM AIRBNB.dev.src_listings
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
        );
[0m16:23:33.181578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:34.556368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:23:34.570800 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:23:33.172463 => 16:23:34.569519
[0m16:23:34.573417 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:23:34.686993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21254ba8-4aeb-48a1-b30f-a3c44be9d66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070eb290be0>]}
[0m16:23:34.690387 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.53s]
[0m16:23:34.694120 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:23:34.697017 [debug] [Thread-1 (]: Began running node model.dbtdnc.fct_reviews
[0m16:23:34.701210 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m16:23:34.706756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.fct_reviews)
[0m16:23:34.709530 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.fct_reviews
[0m16:23:34.729382 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.fct_reviews"
[0m16:23:34.730787 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (compile): 16:23:34.710986 => 16:23:34.730327
[0m16:23:34.731717 [debug] [Thread-1 (]: Began executing node model.dbtdnc.fct_reviews
[0m16:23:34.767995 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:23:34.768695 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    
with src_reviews as (select * from AIRBNB.dev.src_reviews)
select *
from src_reviews
where
    review_text is not null
    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m16:23:34.769262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:35.340548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:23:35.372208 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:23:35.373649 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:23:35.475852 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:23:35.493060 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:23:35.495723 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m16:23:35.617495 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:23:35.651549 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:23:35.652418 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:23:35.744694 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:23:35.762153 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:23:35.765436 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m16:23:35.856100 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:23:35.865681 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:23:35.880616 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.fct_reviews"
[0m16:23:35.881815 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:23:35.882499 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m16:23:36.033908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:23:36.039956 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:23:36.045956 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m16:23:36.609024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:23:36.612206 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:23:36.615571 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
COMMIT
[0m16:23:37.021237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:23:37.053741 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:23:37.063131 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:23:37.064212 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m16:23:37.194991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:23:37.208798 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (execute): 16:23:34.732225 => 16:23:37.207533
[0m16:23:37.211556 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: Close
[0m16:23:37.316740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21254ba8-4aeb-48a1-b30f-a3c44be9d66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070eb18fca0>]}
[0m16:23:37.320845 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 1[0m in 2.61s]
[0m16:23:37.325031 [debug] [Thread-1 (]: Finished running node model.dbtdnc.fct_reviews
[0m16:23:37.333321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:37.337301 [debug] [MainThread]: Connection 'model.dbtdnc.fct_reviews' was properly closed.
[0m16:23:37.340924 [info ] [MainThread]: 
[0m16:23:37.343736 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 9.45 seconds (9.45s).
[0m16:23:37.350161 [debug] [MainThread]: Command end result
[0m16:23:37.369455 [info ] [MainThread]: 
[0m16:23:37.370672 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:23:37.371810 [info ] [MainThread]: 
[0m16:23:37.372940 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:23:37.374597 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.380356, "process_user_time": 4.618656, "process_kernel_time": 0.789037, "process_mem_max_rss": "196476", "process_out_blocks": "1896", "process_in_blocks": "0"}
[0m16:23:37.375865 [debug] [MainThread]: Command `dbt run` succeeded at 16:23:37.375560 after 10.38 seconds
[0m16:23:37.377032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707118fb29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070ebc67af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070eb26ad40>]}
[0m16:23:37.377998 [debug] [MainThread]: Flushing usage events
[0m16:24:10.276345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723eef67a140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723eed9b64a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723eed9b6440>]}


============================== 16:24:10.279177 | 5db95364-4962-4a11-ab28-eba3f007ee6f ==============================
[0m16:24:10.279177 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:24:10.279874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'fail_fast': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:24:10.923485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5db95364-4962-4a11-ab28-eba3f007ee6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723eed9b6590>]}
[0m16:24:10.982537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5db95364-4962-4a11-ab28-eba3f007ee6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ec27d70a0>]}
[0m16:24:10.983403 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:24:10.990448 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:24:11.023292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:11.023892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:11.030966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5db95364-4962-4a11-ab28-eba3f007ee6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ec2450c10>]}
[0m16:24:11.039682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5db95364-4962-4a11-ab28-eba3f007ee6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ec2422230>]}
[0m16:24:11.040356 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:24:11.041065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5db95364-4962-4a11-ab28-eba3f007ee6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ec2422b00>]}
[0m16:24:11.043175 [info ] [MainThread]: 
[0m16:24:11.044159 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:24:11.045692 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:24:11.060342 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:24:11.061205 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:24:11.061726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:11.704782 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:24:11.712896 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:24:11.833251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:24:11.841283 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:24:11.841851 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:24:11.842479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:12.425145 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m16:24:12.434407 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:24:12.528205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5db95364-4962-4a11-ab28-eba3f007ee6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ec2287130>]}
[0m16:24:12.529569 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:12.530357 [info ] [MainThread]: 
[0m16:24:12.533108 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:24:12.534002 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.src_hosts ...................................... [RUN]
[0m16:24:12.535323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.src_hosts)
[0m16:24:12.536176 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:24:12.546966 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:24:12.548175 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:24:12.536677 => 16:24:12.547768
[0m16:24:12.548956 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_hosts
[0m16:24:12.585214 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_hosts"
[0m16:24:12.586341 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_hosts"
[0m16:24:12.586893 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m16:24:12.587426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:13.097014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:24:13.120152 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (execute): 16:24:12.549498 => 16:24:13.119865
[0m16:24:13.120801 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: Close
[0m16:24:13.219373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db95364-4962-4a11-ab28-eba3f007ee6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ec22fbe20>]}
[0m16:24:13.220163 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.68s]
[0m16:24:13.221147 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:24:13.221812 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:24:13.222471 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m16:24:13.223445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:24:13.224174 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:24:13.228460 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:24:13.230053 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:24:13.224709 => 16:24:13.229488
[0m16:24:13.230807 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_listings
[0m16:24:13.235913 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_listings"
[0m16:24:13.237172 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_listings"
[0m16:24:13.237837 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m16:24:13.238488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:13.818428 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:24:13.833703 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (execute): 16:24:13.231212 => 16:24:13.832581
[0m16:24:13.835020 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: Close
[0m16:24:13.934107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db95364-4962-4a11-ab28-eba3f007ee6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ec2374b50>]}
[0m16:24:13.937624 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.71s]
[0m16:24:13.941217 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:24:13.946019 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:24:13.950585 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.src_reviews .................................... [RUN]
[0m16:24:13.953492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:24:13.955110 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:24:13.961115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:24:13.963020 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:24:13.955967 => 16:24:13.962389
[0m16:24:13.964191 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_reviews
[0m16:24:13.970387 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_reviews"
[0m16:24:13.971917 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_reviews"
[0m16:24:13.973078 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m16:24:13.973962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:14.497801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:24:14.513813 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (execute): 16:24:13.964847 => 16:24:14.511718
[0m16:24:14.518321 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: Close
[0m16:24:14.625700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db95364-4962-4a11-ab28-eba3f007ee6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ec2374520>]}
[0m16:24:14.629151 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.67s]
[0m16:24:14.633058 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:24:14.636181 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:24:14.639822 [info ] [Thread-1 (]: 4 of 6 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m16:24:14.643876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_reviews, now model.dbtdnc.dim_hosts_cleansed)
[0m16:24:14.647178 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:24:14.662370 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:24:14.666444 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:24:14.649072 => 16:24:14.665441
[0m16:24:14.668359 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:24:14.705707 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:24:14.706897 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:24:14.707507 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.dev.dim_hosts_cleansed
         as
        (WITH src_hosts AS (
    SELECT *
    FROM AIRBNB.dev.src_hosts
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
        );
[0m16:24:14.708141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:16.023940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:24:16.039854 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:24:14.669273 => 16:24:16.038594
[0m16:24:16.041934 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:24:16.163105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db95364-4962-4a11-ab28-eba3f007ee6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ec0114f70>]}
[0m16:24:16.169388 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.52s]
[0m16:24:16.173527 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:24:16.177068 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:24:16.181712 [info ] [Thread-1 (]: 5 of 6 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m16:24:16.184843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:24:16.186482 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:24:16.194797 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:24:16.197598 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:24:16.187383 => 16:24:16.196458
[0m16:24:16.199000 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:24:16.206452 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:24:16.209910 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:24:16.211047 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (WITH src_listings AS (
    SELECT *
    FROM AIRBNB.dev.src_listings
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
        );
[0m16:24:16.212359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:17.492105 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:24:17.507794 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:24:16.199762 => 16:24:17.506219
[0m16:24:17.511175 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:24:17.609234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db95364-4962-4a11-ab28-eba3f007ee6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ec2374520>]}
[0m16:24:17.612982 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.42s]
[0m16:24:17.616977 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:24:17.619832 [debug] [Thread-1 (]: Began running node model.dbtdnc.fct_reviews
[0m16:24:17.623280 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m16:24:17.628109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.fct_reviews)
[0m16:24:17.630037 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.fct_reviews
[0m16:24:17.649691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.fct_reviews"
[0m16:24:17.651076 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (compile): 16:24:17.631294 => 16:24:17.650622
[0m16:24:17.651878 [debug] [Thread-1 (]: Began executing node model.dbtdnc.fct_reviews
[0m16:24:17.689257 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.fct_reviews"
[0m16:24:17.690514 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:24:17.691796 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
create or replace transient table AIRBNB.dev.fct_reviews
         as
        (
with src_reviews as (select * from AIRBNB.dev.src_reviews)
select *
from src_reviews
where
    review_text is not null
    
        );
[0m16:24:17.692591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:21.526779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m16:24:21.559030 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:24:21.570371 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:24:21.571407 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m16:24:21.639155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:24:21.654245 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (execute): 16:24:17.652335 => 16:24:21.653005
[0m16:24:21.657667 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: Close
[0m16:24:21.752672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db95364-4962-4a11-ab28-eba3f007ee6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ec236e4a0>]}
[0m16:24:21.756695 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 1[0m in 4.13s]
[0m16:24:21.761231 [debug] [Thread-1 (]: Finished running node model.dbtdnc.fct_reviews
[0m16:24:21.768482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:21.770945 [debug] [MainThread]: Connection 'model.dbtdnc.fct_reviews' was properly closed.
[0m16:24:21.773994 [info ] [MainThread]: 
[0m16:24:21.776651 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 10.73 seconds (10.73s).
[0m16:24:21.783897 [debug] [MainThread]: Command end result
[0m16:24:21.805689 [info ] [MainThread]: 
[0m16:24:21.806650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:21.807478 [info ] [MainThread]: 
[0m16:24:21.808316 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:24:21.809869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.576003, "process_user_time": 4.346932, "process_kernel_time": 0.785638, "process_mem_max_rss": "196120", "process_out_blocks": "1888", "process_in_blocks": "0"}
[0m16:24:21.811028 [debug] [MainThread]: Command `dbt run` succeeded at 16:24:21.810779 after 11.58 seconds
[0m16:24:21.811822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723eef67a140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ec27d70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ec01468f0>]}
[0m16:24:21.812730 [debug] [MainThread]: Flushing usage events
[0m16:26:37.346505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b57d7e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b56286380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b56286320>]}


============================== 16:26:37.349110 | 97f9860a-765d-4988-99e5-fc3bc36bb6ff ==============================
[0m16:26:37.349110 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:26:37.350106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:26:38.189980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97f9860a-765d-4988-99e5-fc3bc36bb6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b56286470>]}
[0m16:26:38.260931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97f9860a-765d-4988-99e5-fc3bc36bb6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b56285c90>]}
[0m16:26:38.262231 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:26:38.270364 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:26:38.307145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:38.307709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:38.315522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97f9860a-765d-4988-99e5-fc3bc36bb6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b2ab85030>]}
[0m16:26:38.326463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97f9860a-765d-4988-99e5-fc3bc36bb6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b2ab52230>]}
[0m16:26:38.327172 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:26:38.327727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97f9860a-765d-4988-99e5-fc3bc36bb6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b2ab52f20>]}
[0m16:26:38.330342 [info ] [MainThread]: 
[0m16:26:38.331379 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:26:38.333018 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:26:38.351032 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:26:38.351817 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:26:38.352586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:39.031028 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:26:39.034240 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:26:39.147266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:26:39.180981 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:26:39.182189 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:26:39.183225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:39.571708 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:26:39.573750 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:26:39.681508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97f9860a-765d-4988-99e5-fc3bc36bb6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b562862c0>]}
[0m16:26:39.684540 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:26:39.685842 [info ] [MainThread]: 
[0m16:26:39.690857 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:26:39.692136 [info ] [Thread-1 (]: 1 of 7 START sql view model dev.src_hosts ...................................... [RUN]
[0m16:26:39.693396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.src_hosts)
[0m16:26:39.694108 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:26:39.710611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:26:39.713063 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:26:39.694593 => 16:26:39.712138
[0m16:26:39.715149 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_hosts
[0m16:26:39.767314 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_hosts"
[0m16:26:39.769562 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_hosts"
[0m16:26:39.770869 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m16:26:39.771964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:40.471971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:26:40.514375 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (execute): 16:26:39.716597 => 16:26:40.514020
[0m16:26:40.515098 [debug] [Thread-1 (]: On model.dbtdnc.src_hosts: Close
[0m16:26:40.618952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97f9860a-765d-4988-99e5-fc3bc36bb6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b56286590>]}
[0m16:26:40.623556 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.92s]
[0m16:26:40.627547 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:26:40.631433 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:26:40.636076 [info ] [Thread-1 (]: 2 of 7 START sql view model dev.src_listings ................................... [RUN]
[0m16:26:40.642322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:26:40.645480 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:26:40.660242 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:26:40.664063 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:26:40.648427 => 16:26:40.662642
[0m16:26:40.667337 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_listings
[0m16:26:40.677048 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_listings"
[0m16:26:40.680450 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_listings"
[0m16:26:40.682968 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m16:26:40.684920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:41.269337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:26:41.273496 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (execute): 16:26:40.668751 => 16:26:41.273203
[0m16:26:41.274379 [debug] [Thread-1 (]: On model.dbtdnc.src_listings: Close
[0m16:26:41.368908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97f9860a-765d-4988-99e5-fc3bc36bb6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b2aaa8070>]}
[0m16:26:41.369950 [info ] [Thread-1 (]: 2 of 7 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.73s]
[0m16:26:41.371407 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:26:41.372393 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:26:41.373418 [info ] [Thread-1 (]: 3 of 7 START sql view model dev.src_reviews .................................... [RUN]
[0m16:26:41.375019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:26:41.376134 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:26:41.381922 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:26:41.384042 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:26:41.376665 => 16:26:41.383312
[0m16:26:41.384968 [debug] [Thread-1 (]: Began executing node model.dbtdnc.src_reviews
[0m16:26:41.392597 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.src_reviews"
[0m16:26:41.394851 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.src_reviews"
[0m16:26:41.396808 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m16:26:41.398084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:41.978100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:26:41.995157 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (execute): 16:26:41.385986 => 16:26:41.993855
[0m16:26:41.997775 [debug] [Thread-1 (]: On model.dbtdnc.src_reviews: Close
[0m16:26:42.091869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97f9860a-765d-4988-99e5-fc3bc36bb6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b2aaa81c0>]}
[0m16:26:42.095751 [info ] [Thread-1 (]: 3 of 7 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:26:42.099709 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:26:42.102576 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:26:42.105803 [info ] [Thread-1 (]: 4 of 7 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m16:26:42.111805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_reviews, now model.dbtdnc.dim_hosts_cleansed)
[0m16:26:42.114729 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:26:42.123568 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:26:42.125889 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:26:42.116346 => 16:26:42.125248
[0m16:26:42.126983 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:26:42.169599 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:26:42.171727 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:26:42.173094 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.dev.dim_hosts_cleansed
         as
        (WITH src_hosts AS (
    SELECT *
    FROM AIRBNB.dev.src_hosts
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
        );
[0m16:26:42.174386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:43.571394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:26:43.584077 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:26:42.127578 => 16:26:43.582681
[0m16:26:43.586629 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:26:43.692274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97f9860a-765d-4988-99e5-fc3bc36bb6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b2884cb20>]}
[0m16:26:43.694457 [info ] [Thread-1 (]: 4 of 7 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.58s]
[0m16:26:43.695865 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:26:43.696892 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:26:43.697786 [info ] [Thread-1 (]: 5 of 7 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m16:26:43.698891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:26:43.699708 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:26:43.706586 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:26:43.708580 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:26:43.700168 => 16:26:43.707871
[0m16:26:43.710943 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:26:43.722702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:26:43.725745 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:26:43.728337 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (WITH src_listings AS (
    SELECT *
    FROM AIRBNB.dev.src_listings
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
        );
[0m16:26:43.730147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:44.960919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:26:44.966689 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:26:43.712307 => 16:26:44.966256
[0m16:26:44.967516 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:26:45.053607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97f9860a-765d-4988-99e5-fc3bc36bb6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b2abbb550>]}
[0m16:26:45.054515 [info ] [Thread-1 (]: 5 of 7 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.36s]
[0m16:26:45.055363 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:26:45.056023 [debug] [Thread-1 (]: Began running node model.dbtdnc.fct_reviews
[0m16:26:45.057026 [info ] [Thread-1 (]: 6 of 7 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m16:26:45.057920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.fct_reviews)
[0m16:26:45.058818 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.fct_reviews
[0m16:26:45.074485 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.fct_reviews"
[0m16:26:45.076316 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (compile): 16:26:45.059441 => 16:26:45.075460
[0m16:26:45.077884 [debug] [Thread-1 (]: Began executing node model.dbtdnc.fct_reviews
[0m16:26:45.124868 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:26:45.126536 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    
with src_reviews as (select * from AIRBNB.dev.src_reviews)
select *
from src_reviews
where
    review_text is not null
    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m16:26:45.127485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:45.760996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:26:45.793697 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:26:45.794888 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:26:45.885891 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:26:45.890223 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:26:45.890998 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m16:26:45.993029 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:26:46.034762 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:26:46.035676 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:26:46.130504 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:26:46.149890 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:26:46.151967 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m16:26:46.236740 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:26:46.269382 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:26:46.290857 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.fct_reviews"
[0m16:26:46.292253 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:26:46.292986 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m16:26:46.431094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:26:46.431734 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:26:46.432306 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m16:26:46.719380 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m16:26:46.721030 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:26:46.722578 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
COMMIT
[0m16:26:46.885169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:26:46.901284 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:26:46.911410 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:26:46.912082 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m16:26:47.043739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:26:47.051464 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (execute): 16:26:45.078808 => 16:26:47.050894
[0m16:26:47.053059 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: Close
[0m16:26:47.160510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97f9860a-765d-4988-99e5-fc3bc36bb6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b2a101a20>]}
[0m16:26:47.164789 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.10s]
[0m16:26:47.168652 [debug] [Thread-1 (]: Finished running node model.dbtdnc.fct_reviews
[0m16:26:47.171390 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_w_hosts
[0m16:26:47.175047 [info ] [Thread-1 (]: 7 of 7 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m16:26:47.179491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.fct_reviews, now model.dbtdnc.dim_listings_w_hosts)
[0m16:26:47.182053 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_w_hosts
[0m16:26:47.191505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_w_hosts"
[0m16:26:47.193954 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (compile): 16:26:47.183866 => 16:26:47.193158
[0m16:26:47.194998 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_w_hosts
[0m16:26:47.200997 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_w_hosts"
[0m16:26:47.203472 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_w_hosts"
[0m16:26:47.204297 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    l as (select * from AIRBNB.dev.dim_listings_cleansed),
    h as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
        );
[0m16:26:47.204985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:48.686504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:26:48.690920 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (execute): 16:26:47.195693 => 16:26:48.690460
[0m16:26:48.691998 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: Close
[0m16:26:48.787166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97f9860a-765d-4988-99e5-fc3bc36bb6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b287e2410>]}
[0m16:26:48.788195 [info ] [Thread-1 (]: 7 of 7 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.61s]
[0m16:26:48.789158 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_w_hosts
[0m16:26:48.792301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:48.793285 [debug] [MainThread]: Connection 'model.dbtdnc.dim_listings_w_hosts' was properly closed.
[0m16:26:48.794449 [info ] [MainThread]: 
[0m16:26:48.795829 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 10.46 seconds (10.46s).
[0m16:26:48.800506 [debug] [MainThread]: Command end result
[0m16:26:48.817269 [info ] [MainThread]: 
[0m16:26:48.818536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:26:48.820049 [info ] [MainThread]: 
[0m16:26:48.821692 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:26:48.824056 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.525138, "process_user_time": 4.913712, "process_kernel_time": 0.772655, "process_mem_max_rss": "196856", "process_out_blocks": "1944", "process_in_blocks": "0"}
[0m16:26:48.825627 [debug] [MainThread]: Command `dbt run` succeeded at 16:26:48.825395 after 11.53 seconds
[0m16:26:48.826337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b57d7e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b56285c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b2ab52e60>]}
[0m16:26:48.827022 [debug] [MainThread]: Flushing usage events
[0m16:28:21.754419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c91c57ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c91aa86470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c91aa86410>]}


============================== 16:28:21.757369 | c9255682-0d1e-46bf-95c4-da862babf3db ==============================
[0m16:28:21.757369 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:28:21.758070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'version_check': 'True', 'profiles_dir': '/home/lkeiti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:28:22.481678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9255682-0d1e-46bf-95c4-da862babf3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c91aa86560>]}
[0m16:28:22.543679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9255682-0d1e-46bf-95c4-da862babf3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c8ef61e7a0>]}
[0m16:28:22.544660 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:28:22.551952 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:28:22.591595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:28:22.592641 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:28:22.602129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9255682-0d1e-46bf-95c4-da862babf3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c8ef325120>]}
[0m16:28:22.612554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9255682-0d1e-46bf-95c4-da862babf3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c8ef2f2320>]}
[0m16:28:22.613228 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:28:22.614228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9255682-0d1e-46bf-95c4-da862babf3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c8ef2f3010>]}
[0m16:28:22.617379 [info ] [MainThread]: 
[0m16:28:22.618693 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:28:22.620947 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:28:22.640498 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:28:22.641622 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:28:22.642158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:24.152500 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m16:28:24.159609 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:28:24.265312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:28:24.292238 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:28:24.293310 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:28:24.294161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:24.866152 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:28:24.869979 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:28:24.967715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9255682-0d1e-46bf-95c4-da862babf3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c8ef35b400>]}
[0m16:28:24.969098 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:28:24.969788 [info ] [MainThread]: 
[0m16:28:24.972681 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:28:24.973740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.src_hosts)
[0m16:28:24.974372 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:28:24.981755 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:28:24.982725 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:28:24.974755 => 16:28:24.982394
[0m16:28:24.983842 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:28:24.984474 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:28:24.985581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:28:24.986211 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:28:24.988570 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:28:24.989849 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:28:24.986598 => 16:28:24.989387
[0m16:28:24.991020 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:28:24.991637 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:28:24.992749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:28:24.993619 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:28:24.997705 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:28:24.999090 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:28:24.994209 => 16:28:24.998622
[0m16:28:25.000692 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:28:25.002022 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:28:25.004357 [info ] [Thread-1 (]: 1 of 4 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m16:28:25.007098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_reviews, now model.dbtdnc.dim_hosts_cleansed)
[0m16:28:25.009030 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:28:25.018806 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:28:25.020335 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:28:25.010026 => 16:28:25.019905
[0m16:28:25.020949 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:28:25.070777 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:28:25.073671 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:28:25.074981 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.dev.dim_hosts_cleansed
         as
        (WITH  __dbt__cte__src_hosts as (
with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts AS (
    SELECT *
    FROM __dbt__cte__src_hosts
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
        );
[0m16:28:25.076185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:26.355032 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:28:26.397660 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:28:25.021359 => 16:28:26.397309
[0m16:28:26.398464 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:28:26.501533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9255682-0d1e-46bf-95c4-da862babf3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c8efb9f8e0>]}
[0m16:28:26.505577 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.49s]
[0m16:28:26.510093 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:28:26.514178 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:28:26.519265 [info ] [Thread-1 (]: 2 of 4 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m16:28:26.524572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:28:26.527578 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:28:26.546172 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:28:26.548008 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:28:26.529076 => 16:28:26.547400
[0m16:28:26.549116 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:28:26.553885 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:28:26.555656 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:28:26.556353 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
), src_listings AS (
    SELECT *
    FROM __dbt__cte__src_listings
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
        );
[0m16:28:26.556976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:27.845156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:28:27.861978 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:28:26.549741 => 16:28:27.861011
[0m16:28:27.863945 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:28:27.940438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9255682-0d1e-46bf-95c4-da862babf3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c8ef2506a0>]}
[0m16:28:27.941395 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.42s]
[0m16:28:27.942160 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:28:27.942807 [debug] [Thread-1 (]: Began running node model.dbtdnc.fct_reviews
[0m16:28:27.943408 [info ] [Thread-1 (]: 3 of 4 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m16:28:27.944441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.fct_reviews)
[0m16:28:27.945133 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.fct_reviews
[0m16:28:27.959197 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.fct_reviews"
[0m16:28:27.960328 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (compile): 16:28:27.945498 => 16:28:27.959891
[0m16:28:27.961197 [debug] [Thread-1 (]: Began executing node model.dbtdnc.fct_reviews
[0m16:28:28.005359 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:28:28.006479 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    
with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null
    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m16:28:28.007072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:28.547131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:28:28.556714 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:28:28.557513 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:28:28.671624 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:28:28.681784 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:28:28.683170 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m16:28:28.767168 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:28:28.807447 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:28:28.808398 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:28:28.921204 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:28:28.932808 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:28:28.933856 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m16:28:29.007241 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:28:29.042851 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:28:29.065774 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.fct_reviews"
[0m16:28:29.066832 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:28:29.067410 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m16:28:29.201190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:28:29.204858 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:28:29.208761 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m16:28:29.440614 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m16:28:29.441761 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:28:29.442843 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
COMMIT
[0m16:28:29.616294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:28:29.641786 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:28:29.652497 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:28:29.653416 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m16:28:29.785472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:28:29.802048 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (execute): 16:28:27.961592 => 16:28:29.800076
[0m16:28:29.805351 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: Close
[0m16:28:29.896337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9255682-0d1e-46bf-95c4-da862babf3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c8ef249000>]}
[0m16:28:29.897812 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.95s]
[0m16:28:29.899292 [debug] [Thread-1 (]: Finished running node model.dbtdnc.fct_reviews
[0m16:28:29.900340 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_w_hosts
[0m16:28:29.901564 [info ] [Thread-1 (]: 4 of 4 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m16:28:29.903117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.fct_reviews, now model.dbtdnc.dim_listings_w_hosts)
[0m16:28:29.904104 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_w_hosts
[0m16:28:29.913242 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_w_hosts"
[0m16:28:29.914750 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (compile): 16:28:29.905123 => 16:28:29.914229
[0m16:28:29.915584 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_w_hosts
[0m16:28:29.922796 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_w_hosts"
[0m16:28:29.924434 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_w_hosts"
[0m16:28:29.925154 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    l as (select * from AIRBNB.dev.dim_listings_cleansed),
    h as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
        );
[0m16:28:29.925813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:31.475837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:28:31.491329 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (execute): 16:28:29.916104 => 16:28:31.490068
[0m16:28:31.494676 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: Close
[0m16:28:31.585655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9255682-0d1e-46bf-95c4-da862babf3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c8ee951270>]}
[0m16:28:31.588702 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.68s]
[0m16:28:31.591558 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_w_hosts
[0m16:28:31.597982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:31.599924 [debug] [MainThread]: Connection 'model.dbtdnc.dim_listings_w_hosts' was properly closed.
[0m16:28:31.601743 [info ] [MainThread]: 
[0m16:28:31.603637 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 8.98 seconds (8.98s).
[0m16:28:31.609224 [debug] [MainThread]: Command end result
[0m16:28:31.626608 [info ] [MainThread]: 
[0m16:28:31.627559 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:31.628651 [info ] [MainThread]: 
[0m16:28:31.630301 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:28:31.631733 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.9219475, "process_user_time": 4.448351, "process_kernel_time": 0.736102, "process_mem_max_rss": "196796", "process_out_blocks": "1904", "process_in_blocks": "0"}
[0m16:28:31.632935 [debug] [MainThread]: Command `dbt run` succeeded at 16:28:31.632676 after 9.92 seconds
[0m16:28:31.633708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c91c57ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c8ef5a2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c8ecff3190>]}
[0m16:28:31.634711 [debug] [MainThread]: Flushing usage events
[0m16:30:08.347611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f12dd72140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f12c0ca4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f12c0ca470>]}


============================== 16:30:08.352293 | 38190e47-c708-43fd-ac1c-5351f9d2bfd3 ==============================
[0m16:30:08.352293 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:30:08.353074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:30:09.114188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38190e47-c708-43fd-ac1c-5351f9d2bfd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f12c0ca5c0>]}
[0m16:30:09.220883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38190e47-c708-43fd-ac1c-5351f9d2bfd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f104c95c00>]}
[0m16:30:09.222549 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:30:09.233991 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:30:09.277361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:30:09.277986 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:30:09.286905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38190e47-c708-43fd-ac1c-5351f9d2bfd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f104999180>]}
[0m16:30:09.303372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38190e47-c708-43fd-ac1c-5351f9d2bfd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f104b62380>]}
[0m16:30:09.304062 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:30:09.304620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38190e47-c708-43fd-ac1c-5351f9d2bfd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f104b63070>]}
[0m16:30:09.308010 [info ] [MainThread]: 
[0m16:30:09.309921 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:30:09.312736 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:30:09.336148 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:30:09.336881 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:30:09.337415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:10.071045 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:30:10.078132 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:30:10.174796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:30:10.201853 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:30:10.203067 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:30:10.204504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:10.586404 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:30:10.593500 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:30:10.697528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38190e47-c708-43fd-ac1c-5351f9d2bfd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1049cb760>]}
[0m16:30:10.698781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:30:10.699498 [info ] [MainThread]: 
[0m16:30:10.701954 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:30:10.702885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.src_hosts)
[0m16:30:10.703470 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:30:10.716995 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:30:10.719461 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:30:10.703847 => 16:30:10.718834
[0m16:30:10.721280 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:30:10.722782 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:30:10.726208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:30:10.727809 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:30:10.732206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:30:10.735091 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:30:10.728320 => 16:30:10.734220
[0m16:30:10.737696 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:30:10.739713 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:30:10.743996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:30:10.745506 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:30:10.748520 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:30:10.750672 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:30:10.746352 => 16:30:10.750007
[0m16:30:10.752636 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:30:10.753672 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:30:10.754812 [info ] [Thread-1 (]: 1 of 4 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m16:30:10.756955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_reviews, now model.dbtdnc.dim_hosts_cleansed)
[0m16:30:10.758517 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:30:10.771917 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:30:10.774292 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:30:10.759628 => 16:30:10.773152
[0m16:30:10.776095 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:30:10.849338 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:30:10.851028 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:30:10.851754 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.dev.dim_hosts_cleansed
         as
        (WITH  __dbt__cte__src_hosts as (
with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts AS (
    SELECT *
    FROM __dbt__cte__src_hosts
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
        );
[0m16:30:10.852360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:12.083468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:30:12.129595 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:30:10.777081 => 16:30:12.129030
[0m16:30:12.130679 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:30:12.213814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38190e47-c708-43fd-ac1c-5351f9d2bfd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1040bc970>]}
[0m16:30:12.215577 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.46s]
[0m16:30:12.217076 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:30:12.218366 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:30:12.219522 [info ] [Thread-1 (]: 2 of 4 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m16:30:12.220611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:30:12.221316 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:30:12.233156 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:30:12.235719 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:30:12.222098 => 16:30:12.234744
[0m16:30:12.236897 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:30:12.244582 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:30:12.247740 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:30:12.249522 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
), src_listings AS (
    SELECT *
    FROM __dbt__cte__src_listings
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
        );
[0m16:30:12.250789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:13.550506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:30:13.568537 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:30:12.237635 => 16:30:13.567570
[0m16:30:13.570461 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:30:13.652568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38190e47-c708-43fd-ac1c-5351f9d2bfd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f104119f30>]}
[0m16:30:13.653547 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.43s]
[0m16:30:13.654934 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:30:13.656053 [debug] [Thread-1 (]: Began running node model.dbtdnc.fct_reviews
[0m16:30:13.656862 [info ] [Thread-1 (]: 3 of 4 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m16:30:13.657858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.fct_reviews)
[0m16:30:13.658528 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.fct_reviews
[0m16:30:13.673800 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.fct_reviews"
[0m16:30:13.676334 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (compile): 16:30:13.659022 => 16:30:13.675495
[0m16:30:13.677585 [debug] [Thread-1 (]: Began executing node model.dbtdnc.fct_reviews
[0m16:30:13.724756 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:30:13.725603 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    
with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null
    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m16:30:13.726230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:14.444156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:30:14.480590 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:30:14.482425 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:30:14.613279 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:30:14.623813 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:30:14.624818 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m16:30:14.692072 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:30:14.736845 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:30:14.737733 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:30:14.826846 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:30:14.846711 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:30:14.848678 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m16:30:14.912305 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:30:14.927003 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:30:14.957446 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.fct_reviews"
[0m16:30:14.958785 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:30:14.959617 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m16:30:15.083518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:30:15.088182 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:30:15.092798 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m16:30:15.364347 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m16:30:15.365687 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:30:15.366992 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
COMMIT
[0m16:30:15.515594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:30:15.527674 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:30:15.535449 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:30:15.536411 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m16:30:15.674386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:30:15.686205 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (execute): 16:30:13.678263 => 16:30:15.685120
[0m16:30:15.688910 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: Close
[0m16:30:15.783899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38190e47-c708-43fd-ac1c-5351f9d2bfd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f0fffbaa70>]}
[0m16:30:15.784951 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.13s]
[0m16:30:15.786099 [debug] [Thread-1 (]: Finished running node model.dbtdnc.fct_reviews
[0m16:30:15.786853 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_w_hosts
[0m16:30:15.787688 [info ] [Thread-1 (]: 4 of 4 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m16:30:15.788647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.fct_reviews, now model.dbtdnc.dim_listings_w_hosts)
[0m16:30:15.789323 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_w_hosts
[0m16:30:15.793487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_w_hosts"
[0m16:30:15.794860 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (compile): 16:30:15.789702 => 16:30:15.794358
[0m16:30:15.795815 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_w_hosts
[0m16:30:15.801875 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_w_hosts"
[0m16:30:15.803399 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_w_hosts"
[0m16:30:15.804140 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    l as (select * from AIRBNB.dev.dim_listings_cleansed),
    h as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
        );
[0m16:30:15.804890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:17.341391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:30:17.354106 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (execute): 16:30:15.796429 => 16:30:17.353284
[0m16:30:17.356005 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: Close
[0m16:30:17.471558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38190e47-c708-43fd-ac1c-5351f9d2bfd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f0fffc8820>]}
[0m16:30:17.475455 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.68s]
[0m16:30:17.481273 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_w_hosts
[0m16:30:17.487232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:17.488986 [debug] [MainThread]: Connection 'model.dbtdnc.dim_listings_w_hosts' was properly closed.
[0m16:30:17.490651 [info ] [MainThread]: 
[0m16:30:17.492434 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 8.18 seconds (8.18s).
[0m16:30:17.498654 [debug] [MainThread]: Command end result
[0m16:30:17.525329 [info ] [MainThread]: 
[0m16:30:17.526527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:17.527374 [info ] [MainThread]: 
[0m16:30:17.528425 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:30:17.530205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.226468, "process_user_time": 4.666203, "process_kernel_time": 0.772337, "process_mem_max_rss": "196680", "process_in_blocks": "8", "process_out_blocks": "1896"}
[0m16:30:17.532116 [debug] [MainThread]: Command `dbt run` succeeded at 16:30:17.531553 after 9.23 seconds
[0m16:30:17.533302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f12dd72140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f104119f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f104b62380>]}
[0m16:30:17.534410 [debug] [MainThread]: Flushing usage events
[0m16:32:32.686751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b731a29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b714ca3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b714ca380>]}


============================== 16:32:32.690733 | d9941a08-697e-449b-83ef-590d960f1644 ==============================
[0m16:32:32.690733 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:32:32.691917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:32:33.472271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9941a08-697e-449b-83ef-590d960f1644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b714ca4d0>]}
[0m16:32:33.536983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9941a08-697e-449b-83ef-590d960f1644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b460d4e20>]}
[0m16:32:33.537929 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:32:33.545425 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:32:33.579556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:33.580129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:33.586942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9941a08-697e-449b-83ef-590d960f1644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b45d99090>]}
[0m16:32:33.595983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9941a08-697e-449b-83ef-590d960f1644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b45f62350>]}
[0m16:32:33.596676 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:32:33.597203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9941a08-697e-449b-83ef-590d960f1644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b45f63040>]}
[0m16:32:33.599281 [info ] [MainThread]: 
[0m16:32:33.600733 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:32:33.603510 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:32:33.622109 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:32:33.622922 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:32:33.623523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:34.429878 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:32:34.431880 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:32:34.542025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:32:34.575670 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:32:34.576934 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:32:34.577944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:34.969987 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:32:34.976971 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:32:35.091575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9941a08-697e-449b-83ef-590d960f1644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b45dcf340>]}
[0m16:32:35.095830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:35.098449 [info ] [MainThread]: 
[0m16:32:35.108082 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:32:35.111631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.src_hosts)
[0m16:32:35.113491 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:32:35.127724 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:32:35.128900 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:32:35.115271 => 16:32:35.128497
[0m16:32:35.130341 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:32:35.131221 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:32:35.132923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:32:35.134381 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:32:35.137282 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:32:35.138450 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:32:35.134973 => 16:32:35.138019
[0m16:32:35.139639 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:32:35.140352 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:32:35.142009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:32:35.142942 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:32:35.145630 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:32:35.146579 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:32:35.143361 => 16:32:35.146245
[0m16:32:35.147700 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:32:35.148464 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:32:35.149891 [info ] [Thread-1 (]: 1 of 4 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m16:32:35.151825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_reviews, now model.dbtdnc.dim_hosts_cleansed)
[0m16:32:35.152849 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:32:35.160640 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:32:35.162032 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:32:35.153340 => 16:32:35.161553
[0m16:32:35.162969 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:32:35.191391 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type table
[0m16:32:35.197813 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED"
[0m16:32:35.204364 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:32:35.205069 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m16:32:35.205748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:35.586122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:32:35.625463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:32:35.627754 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:32:35.628701 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    

WITH  __dbt__cte__src_hosts as (
with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts AS (
    SELECT *
    FROM __dbt__cte__src_hosts
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
  );
[0m16:32:35.913524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:32:35.969430 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:32:35.163569 => 16:32:35.968886
[0m16:32:35.970911 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:32:36.061351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9941a08-697e-449b-83ef-590d960f1644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b454bcc40>]}
[0m16:32:36.062490 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.91s]
[0m16:32:36.063309 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:32:36.063922 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:32:36.064539 [info ] [Thread-1 (]: 2 of 4 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m16:32:36.066007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:32:36.066873 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:32:36.076571 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:32:36.077712 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:32:36.067331 => 16:32:36.077272
[0m16:32:36.078663 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:32:36.085420 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type table
[0m16:32:36.093970 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED"
[0m16:32:36.095698 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:32:36.096302 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m16:32:36.096853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:36.486021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:32:36.495935 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:32:36.502965 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:32:36.505893 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
), src_listings AS (
    SELECT *
    FROM __dbt__cte__src_listings
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
  );
[0m16:32:36.850668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:32:36.867271 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:32:36.079263 => 16:32:36.865283
[0m16:32:36.871361 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:32:36.946848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9941a08-697e-449b-83ef-590d960f1644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b45445660>]}
[0m16:32:36.947702 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.88s]
[0m16:32:36.948588 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:32:36.949212 [debug] [Thread-1 (]: Began running node model.dbtdnc.fct_reviews
[0m16:32:36.950015 [info ] [Thread-1 (]: 3 of 4 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m16:32:36.951385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.fct_reviews)
[0m16:32:36.952093 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.fct_reviews
[0m16:32:36.961796 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.fct_reviews"
[0m16:32:36.962836 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (compile): 16:32:36.952456 => 16:32:36.962517
[0m16:32:36.963444 [debug] [Thread-1 (]: Began executing node model.dbtdnc.fct_reviews
[0m16:32:36.997427 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:32:36.998365 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    
with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null
    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m16:32:36.999259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:37.523011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:32:37.537275 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:32:37.538974 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:32:37.625151 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:32:37.643218 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:32:37.645900 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m16:32:37.715053 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:32:37.763979 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:32:37.764752 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:32:37.854693 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:32:37.873225 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:32:37.876237 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m16:32:37.952243 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:32:37.985186 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:32:38.008015 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.fct_reviews"
[0m16:32:38.009170 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:32:38.009723 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m16:32:38.144666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:32:38.147544 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:32:38.149951 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m16:32:38.359761 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m16:32:38.361542 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:32:38.363129 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
COMMIT
[0m16:32:38.507640 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:32:38.527862 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:32:38.535709 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:32:38.537507 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m16:32:38.668532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:32:38.682493 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (execute): 16:32:36.963815 => 16:32:38.680902
[0m16:32:38.685230 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: Close
[0m16:32:38.783616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9941a08-697e-449b-83ef-590d960f1644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b454b1840>]}
[0m16:32:38.787557 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.83s]
[0m16:32:38.791646 [debug] [Thread-1 (]: Finished running node model.dbtdnc.fct_reviews
[0m16:32:38.794605 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_w_hosts
[0m16:32:38.798092 [info ] [Thread-1 (]: 4 of 4 START sql view model dev.dim_listings_w_hosts ........................... [RUN]
[0m16:32:38.802208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.fct_reviews, now model.dbtdnc.dim_listings_w_hosts)
[0m16:32:38.805482 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_w_hosts
[0m16:32:38.816148 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_w_hosts"
[0m16:32:38.818846 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (compile): 16:32:38.807134 => 16:32:38.817761
[0m16:32:38.820665 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_w_hosts
[0m16:32:38.827291 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" because it is of type table
[0m16:32:38.831778 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS"
[0m16:32:38.835890 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_w_hosts"
[0m16:32:38.837138 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_w_hosts"} */
drop table if exists "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" cascade
[0m16:32:38.838331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:39.406519 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:32:39.409938 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_w_hosts"
[0m16:32:39.412006 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_w_hosts"
[0m16:32:39.413019 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_w_hosts"} */
create or replace   view AIRBNB.dev.dim_listings_w_hosts
  
   as (
    

with
    l as (select * from AIRBNB.dev.dim_listings_cleansed),
    h as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
  );
[0m16:32:39.817883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:32:39.825238 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (execute): 16:32:38.821806 => 16:32:39.824821
[0m16:32:39.826365 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: Close
[0m16:32:39.913214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9941a08-697e-449b-83ef-590d960f1644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b442fc160>]}
[0m16:32:39.914766 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dev.dim_listings_w_hosts ...................... [[32mSUCCESS 1[0m in 1.11s]
[0m16:32:39.915981 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_w_hosts
[0m16:32:39.917916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:39.918526 [debug] [MainThread]: Connection 'model.dbtdnc.dim_listings_w_hosts' was properly closed.
[0m16:32:39.919187 [info ] [MainThread]: 
[0m16:32:39.919770 [info ] [MainThread]: Finished running 3 view models, 1 incremental model in 0 hours 0 minutes and 6.32 seconds (6.32s).
[0m16:32:39.921065 [debug] [MainThread]: Command end result
[0m16:32:39.936879 [info ] [MainThread]: 
[0m16:32:39.938187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:39.939351 [info ] [MainThread]: 
[0m16:32:39.940501 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:32:39.942927 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3089495, "process_user_time": 4.55841, "process_kernel_time": 0.86542, "process_mem_max_rss": "197324", "process_out_blocks": "1896", "process_in_blocks": "0"}
[0m16:32:39.944101 [debug] [MainThread]: Command `dbt run` succeeded at 16:32:39.943851 after 7.31 seconds
[0m16:32:39.944726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b731a29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b45457e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769b4629ae00>]}
[0m16:32:39.945500 [debug] [MainThread]: Flushing usage events
[0m16:33:41.019981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b945b29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b928be410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b928be3b0>]}


============================== 16:33:41.022926 | ff71e36c-2c67-4fb1-99f9-5e08f48e914b ==============================
[0m16:33:41.022926 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:33:41.023667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:33:41.802687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff71e36c-2c67-4fb1-99f9-5e08f48e914b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b928be500>]}
[0m16:33:41.876087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff71e36c-2c67-4fb1-99f9-5e08f48e914b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b676cf430>]}
[0m16:33:41.877768 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:33:41.887977 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:33:41.922780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:41.923357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:41.931205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff71e36c-2c67-4fb1-99f9-5e08f48e914b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b673d50c0>]}
[0m16:33:41.940763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff71e36c-2c67-4fb1-99f9-5e08f48e914b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b673a22c0>]}
[0m16:33:41.941513 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:33:41.942073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff71e36c-2c67-4fb1-99f9-5e08f48e914b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b673a2fb0>]}
[0m16:33:41.945659 [info ] [MainThread]: 
[0m16:33:41.947593 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:33:41.949231 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:33:41.967392 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:33:41.968079 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:33:41.968996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:42.617188 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:33:42.626307 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:33:42.718820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:33:42.736616 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:33:42.737705 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:33:42.738365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:43.116367 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:33:43.120490 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:33:43.203168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff71e36c-2c67-4fb1-99f9-5e08f48e914b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b6720ba60>]}
[0m16:33:43.204108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:33:43.204696 [info ] [MainThread]: 
[0m16:33:43.206671 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:33:43.207585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.src_hosts)
[0m16:33:43.208132 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:33:43.220626 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:33:43.221588 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:33:43.208486 => 16:33:43.221261
[0m16:33:43.222731 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:33:43.223472 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:33:43.224512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:33:43.225181 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:33:43.228885 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:33:43.231127 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:33:43.225567 => 16:33:43.230383
[0m16:33:43.233499 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:33:43.234189 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:33:43.235326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:33:43.235906 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:33:43.238401 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:33:43.239324 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:33:43.236347 => 16:33:43.238950
[0m16:33:43.240315 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:33:43.240904 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:33:43.241546 [info ] [Thread-1 (]: 1 of 4 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m16:33:43.242522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_reviews, now model.dbtdnc.dim_hosts_cleansed)
[0m16:33:43.243487 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:33:43.254518 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:33:43.255594 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:33:43.244398 => 16:33:43.255157
[0m16:33:43.256388 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:33:43.298899 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:33:43.300729 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:33:43.301401 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    

WITH  __dbt__cte__src_hosts as (
with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts AS (
    SELECT *
    FROM __dbt__cte__src_hosts
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
  );
[0m16:33:43.301972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:44.004877 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:33:44.034756 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:33:43.257068 => 16:33:44.034457
[0m16:33:44.035527 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:33:44.132099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff71e36c-2c67-4fb1-99f9-5e08f48e914b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b6720d060>]}
[0m16:33:44.133076 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.89s]
[0m16:33:44.133897 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:33:44.134741 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:33:44.135358 [info ] [Thread-1 (]: 2 of 4 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m16:33:44.136328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:33:44.136875 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:33:44.144476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:33:44.146946 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:33:44.137225 => 16:33:44.146123
[0m16:33:44.148197 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:33:44.156794 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:33:44.159467 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:33:44.162018 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
), src_listings AS (
    SELECT *
    FROM __dbt__cte__src_listings
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
  );
[0m16:33:44.163833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:44.685010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:33:44.702162 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:33:44.148955 => 16:33:44.700209
[0m16:33:44.705158 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:33:44.814634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff71e36c-2c67-4fb1-99f9-5e08f48e914b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b669e3f40>]}
[0m16:33:44.818488 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:33:44.822256 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:33:44.825147 [debug] [Thread-1 (]: Began running node model.dbtdnc.fct_reviews
[0m16:33:44.830108 [info ] [Thread-1 (]: 3 of 4 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m16:33:44.835259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.fct_reviews)
[0m16:33:44.838658 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.fct_reviews
[0m16:33:44.891645 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.fct_reviews"
[0m16:33:44.893665 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (compile): 16:33:44.840410 => 16:33:44.892953
[0m16:33:44.895351 [debug] [Thread-1 (]: Began executing node model.dbtdnc.fct_reviews
[0m16:33:44.946050 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:33:44.947703 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    
with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null
    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m16:33:44.948470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:45.530024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:33:45.546351 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:33:45.548097 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:33:45.655500 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:33:45.672865 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:33:45.674945 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m16:33:45.764788 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:33:45.796157 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:33:45.796935 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:33:45.883670 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:33:45.897250 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:33:45.898771 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m16:33:45.975542 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:33:46.010939 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:33:46.037221 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.fct_reviews"
[0m16:33:46.039372 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:33:46.040375 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m16:33:46.163752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:33:46.165332 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:33:46.167134 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m16:33:46.347666 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m16:33:46.352076 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:33:46.355200 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
COMMIT
[0m16:33:46.520083 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:33:46.530335 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:33:46.537271 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:33:46.537948 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m16:33:46.676167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:33:46.692550 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (execute): 16:33:44.896614 => 16:33:46.691511
[0m16:33:46.694930 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: Close
[0m16:33:46.787014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff71e36c-2c67-4fb1-99f9-5e08f48e914b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b669e3730>]}
[0m16:33:46.789353 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.95s]
[0m16:33:46.792587 [debug] [Thread-1 (]: Finished running node model.dbtdnc.fct_reviews
[0m16:33:46.794912 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_w_hosts
[0m16:33:46.796667 [info ] [Thread-1 (]: 4 of 4 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m16:33:46.799075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.fct_reviews, now model.dbtdnc.dim_listings_w_hosts)
[0m16:33:46.800371 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_w_hosts
[0m16:33:46.806036 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_w_hosts"
[0m16:33:46.807527 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (compile): 16:33:46.801002 => 16:33:46.807095
[0m16:33:46.808684 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_w_hosts
[0m16:33:46.827409 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" because it is of type view
[0m16:33:46.837533 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS"
[0m16:33:46.840822 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_w_hosts"
[0m16:33:46.842200 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_w_hosts"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" cascade
[0m16:33:46.845631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:47.233114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:33:47.270764 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_w_hosts"
[0m16:33:47.274450 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_w_hosts"
[0m16:33:47.276245 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    l as (select * from AIRBNB.dev.dim_listings_cleansed),
    h as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
        );
[0m16:33:48.404405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:33:48.409786 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (execute): 16:33:46.809337 => 16:33:48.409028
[0m16:33:48.411637 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: Close
[0m16:33:48.508310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff71e36c-2c67-4fb1-99f9-5e08f48e914b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b672cf370>]}
[0m16:33:48.513543 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.71s]
[0m16:33:48.517839 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_w_hosts
[0m16:33:48.523923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:48.526063 [debug] [MainThread]: Connection 'model.dbtdnc.dim_listings_w_hosts' was properly closed.
[0m16:33:48.528314 [info ] [MainThread]: 
[0m16:33:48.530063 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 6.58 seconds (6.58s).
[0m16:33:48.533919 [debug] [MainThread]: Command end result
[0m16:33:48.553385 [info ] [MainThread]: 
[0m16:33:48.554405 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:48.555230 [info ] [MainThread]: 
[0m16:33:48.556098 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:33:48.557470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.585126, "process_user_time": 4.573684, "process_kernel_time": 0.792666, "process_mem_max_rss": "196404", "process_out_blocks": "1896", "process_in_blocks": "0"}
[0m16:33:48.558441 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:48.558191 after 7.59 seconds
[0m16:33:48.559370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b945b29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b6765f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b650ce260>]}
[0m16:33:48.560944 [debug] [MainThread]: Flushing usage events
[0m16:37:21.713940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081cd74e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081cbc864a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081cbc86440>]}


============================== 16:37:21.716623 | 220f08e1-6902-4ba7-a3aa-dbdc9c23c696 ==============================
[0m16:37:21.716623 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:37:21.717438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:37:22.440963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '220f08e1-6902-4ba7-a3aa-dbdc9c23c696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081cbc86590>]}
[0m16:37:22.506782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '220f08e1-6902-4ba7-a3aa-dbdc9c23c696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081a48827d0>]}
[0m16:37:22.507843 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:37:22.515872 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:37:22.550716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:37:22.551874 [debug] [MainThread]: Partial parsing: added file: dbtdnc://seeds/seed_full_moon_dates.csv
[0m16:37:22.735432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '220f08e1-6902-4ba7-a3aa-dbdc9c23c696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081a4485840>]}
[0m16:37:22.746146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '220f08e1-6902-4ba7-a3aa-dbdc9c23c696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081a444c460>]}
[0m16:37:22.746827 [info ] [MainThread]: Found 7 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:37:22.747349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '220f08e1-6902-4ba7-a3aa-dbdc9c23c696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081a46cb6a0>]}
[0m16:37:22.748867 [info ] [MainThread]: 
[0m16:37:22.749769 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:37:22.751226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:37:22.769675 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:37:22.770421 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:37:22.771151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:23.412506 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:37:23.419335 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:37:23.523886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:37:23.555871 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:37:23.557459 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:37:23.558455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:23.963835 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:37:23.971467 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:37:24.075940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '220f08e1-6902-4ba7-a3aa-dbdc9c23c696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081a454e7d0>]}
[0m16:37:24.080281 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:24.082965 [info ] [MainThread]: 
[0m16:37:24.091914 [debug] [Thread-1 (]: Began running node seed.dbtdnc.seed_full_moon_dates
[0m16:37:24.094160 [info ] [Thread-1 (]: 1 of 1 START seed file dev.seed_full_moon_dates ................................ [RUN]
[0m16:37:24.096936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now seed.dbtdnc.seed_full_moon_dates)
[0m16:37:24.098797 [debug] [Thread-1 (]: Began compiling node seed.dbtdnc.seed_full_moon_dates
[0m16:37:24.101031 [debug] [Thread-1 (]: Timing info for seed.dbtdnc.seed_full_moon_dates (compile): 16:37:24.100295 => 16:37:24.100302
[0m16:37:24.103381 [debug] [Thread-1 (]: Began executing node seed.dbtdnc.seed_full_moon_dates
[0m16:37:24.158451 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtdnc.seed_full_moon_dates"
[0m16:37:24.159108 [debug] [Thread-1 (]: On seed.dbtdnc.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "seed.dbtdnc.seed_full_moon_dates"} */
create table AIRBNB.dev.seed_full_moon_dates (full_moon_date date)
[0m16:37:24.159640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:24.670919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:24.697979 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtdnc.seed_full_moon_dates"
[0m16:37:24.699109 [debug] [Thread-1 (]: On seed.dbtdnc.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "seed.dbtdnc.seed_full_moon_dates"} */
BEGIN
[0m16:37:24.846093 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:37:24.857354 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtdnc.seed_full_moon_dates"
[0m16:37:24.860240 [debug] [Thread-1 (]: On seed.dbtdnc.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "seed.dbtdnc.seed_full_moon_dates"} */
insert into AIRBNB.dev.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(...
[0m16:37:25.392544 [debug] [Thread-1 (]: SQL status: SUCCESS 272 in 1.0 seconds
[0m16:37:25.395866 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtdnc.seed_full_moon_dates"
[0m16:37:25.398962 [debug] [Thread-1 (]: On seed.dbtdnc.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "seed.dbtdnc.seed_full_moon_dates"} */
COMMIT
[0m16:37:25.789543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:37:25.814856 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtdnc.seed_full_moon_dates"
[0m16:37:25.849555 [debug] [Thread-1 (]: Timing info for seed.dbtdnc.seed_full_moon_dates (execute): 16:37:24.104912 => 16:37:25.848998
[0m16:37:25.850432 [debug] [Thread-1 (]: On seed.dbtdnc.seed_full_moon_dates: Close
[0m16:37:25.935924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '220f08e1-6902-4ba7-a3aa-dbdc9c23c696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081a446fc10>]}
[0m16:37:25.937811 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 1.84s]
[0m16:37:25.939873 [debug] [Thread-1 (]: Finished running node seed.dbtdnc.seed_full_moon_dates
[0m16:37:25.942824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:25.944042 [debug] [MainThread]: Connection 'seed.dbtdnc.seed_full_moon_dates' was properly closed.
[0m16:37:25.945184 [info ] [MainThread]: 
[0m16:37:25.946789 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m16:37:25.948542 [debug] [MainThread]: Command end result
[0m16:37:25.972447 [info ] [MainThread]: 
[0m16:37:25.974661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:25.976198 [info ] [MainThread]: 
[0m16:37:25.977790 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:37:25.981613 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.3125644, "process_user_time": 3.925099, "process_kernel_time": 0.775475, "process_mem_max_rss": "197632", "process_out_blocks": "2632", "process_in_blocks": "0"}
[0m16:37:25.983262 [debug] [MainThread]: Command `dbt seed` succeeded at 16:37:25.982880 after 4.31 seconds
[0m16:37:25.985336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081cd74e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081a446fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081cbc86590>]}
[0m16:37:25.987233 [debug] [MainThread]: Flushing usage events
[0m16:41:19.778898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b3cbb29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b3aebe440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b3aebe3e0>]}


============================== 16:41:19.782042 | 5dd22dd9-f183-4bc3-8559-9a64e0e78a25 ==============================
[0m16:41:19.782042 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:41:19.782799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:41:20.492799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dd22dd9-f183-4bc3-8559-9a64e0e78a25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b3aebe530>]}
[0m16:41:20.555616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dd22dd9-f183-4bc3-8559-9a64e0e78a25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b3aebdc90>]}
[0m16:41:20.556952 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:41:20.568409 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:41:20.607398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:41:20.608229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:41:20.614934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dd22dd9-f183-4bc3-8559-9a64e0e78a25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b0fa5dd80>]}
[0m16:41:20.624733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dd22dd9-f183-4bc3-8559-9a64e0e78a25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b0fc1eda0>]}
[0m16:41:20.625742 [info ] [MainThread]: Found 8 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:41:20.626636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd22dd9-f183-4bc3-8559-9a64e0e78a25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b0fb9af20>]}
[0m16:41:20.629457 [info ] [MainThread]: 
[0m16:41:20.631753 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:41:20.634549 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:41:20.650633 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:41:20.651290 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:41:20.651828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:21.366955 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:41:21.374673 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:41:21.484493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m16:41:21.516613 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:41:21.517798 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:41:21.518774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:21.923968 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:41:21.933325 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:41:22.044725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd22dd9-f183-4bc3-8559-9a64e0e78a25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b0fc1eda0>]}
[0m16:41:22.049692 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:41:22.052621 [info ] [MainThread]: 
[0m16:41:22.059014 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:41:22.062549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.src_hosts)
[0m16:41:22.065158 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:41:22.085161 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:41:22.086481 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:41:22.066712 => 16:41:22.086033
[0m16:41:22.087885 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:41:22.088685 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:41:22.089962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:41:22.090731 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:41:22.093514 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:41:22.094536 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:41:22.091199 => 16:41:22.094179
[0m16:41:22.095838 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:41:22.097041 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:41:22.098370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:41:22.098999 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:41:22.101186 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:41:22.102096 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:41:22.099448 => 16:41:22.101767
[0m16:41:22.103252 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:41:22.103889 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:41:22.104551 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m16:41:22.105363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_reviews, now model.dbtdnc.dim_hosts_cleansed)
[0m16:41:22.105934 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:41:22.112593 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:41:22.114084 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:41:22.106533 => 16:41:22.113351
[0m16:41:22.115675 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:41:22.170417 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:41:22.172544 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_hosts_cleansed"
[0m16:41:22.174382 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    

WITH  __dbt__cte__src_hosts as (
with raw_hosts as (select * from AIRBNB.RAW.RAW_HOSTS)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts AS (
    SELECT *
    FROM __dbt__cte__src_hosts
)
SELECT host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
  );
[0m16:41:22.175814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:22.736938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:22.776317 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:41:22.116203 => 16:41:22.776009
[0m16:41:22.777155 [debug] [Thread-1 (]: On model.dbtdnc.dim_hosts_cleansed: Close
[0m16:41:22.861701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd22dd9-f183-4bc3-8559-9a64e0e78a25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b3aebe650>]}
[0m16:41:22.863138 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.76s]
[0m16:41:22.864622 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:41:22.866034 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:41:22.867488 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m16:41:22.868971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:41:22.869896 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:41:22.879078 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:41:22.880508 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:41:22.870296 => 16:41:22.880114
[0m16:41:22.881297 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:41:22.886958 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_cleansed"
[0m16:41:22.889549 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_cleansed"
[0m16:41:22.890680 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
), src_listings AS (
    SELECT *
    FROM __dbt__cte__src_listings
)
SELECT listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,
    created_at,
    updated_at
FROM src_listings
  );
[0m16:41:22.891582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:23.430664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:23.437466 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:41:22.881826 => 16:41:23.437025
[0m16:41:23.438447 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_cleansed: Close
[0m16:41:23.537798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd22dd9-f183-4bc3-8559-9a64e0e78a25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b0f96e9e0>]}
[0m16:41:23.541003 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.67s]
[0m16:41:23.544597 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:41:23.547270 [debug] [Thread-1 (]: Began running node model.dbtdnc.fct_reviews
[0m16:41:23.551010 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m16:41:23.554780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.fct_reviews)
[0m16:41:23.557329 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.fct_reviews
[0m16:41:23.586526 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.fct_reviews"
[0m16:41:23.587624 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (compile): 16:41:23.559020 => 16:41:23.587259
[0m16:41:23.588288 [debug] [Thread-1 (]: Began executing node model.dbtdnc.fct_reviews
[0m16:41:23.625391 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:41:23.626084 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    
with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from AIRBNB.RAW.RAW_REVIEWS)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null
    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m16:41:23.626693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:24.147337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:24.179298 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:41:24.180661 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:41:24.284392 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:41:24.304769 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:41:24.307123 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m16:41:24.379309 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:41:24.416191 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:41:24.417299 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:41:24.513410 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:41:24.518811 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:41:24.519707 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m16:41:24.585677 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:41:24.626069 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:41:24.648386 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.fct_reviews"
[0m16:41:24.649743 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:41:24.650464 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m16:41:24.766343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:24.769300 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:41:24.772188 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m16:41:25.001099 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m16:41:25.001842 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:41:25.002462 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
COMMIT
[0m16:41:25.159210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:25.190655 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m16:41:25.200972 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.fct_reviews"
[0m16:41:25.201795 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m16:41:25.338425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:25.353432 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (execute): 16:41:23.588704 => 16:41:25.352122
[0m16:41:25.355977 [debug] [Thread-1 (]: On model.dbtdnc.fct_reviews: Close
[0m16:41:25.461396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd22dd9-f183-4bc3-8559-9a64e0e78a25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b0ef2c5e0>]}
[0m16:41:25.465379 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.91s]
[0m16:41:25.469181 [debug] [Thread-1 (]: Finished running node model.dbtdnc.fct_reviews
[0m16:41:25.472014 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_w_hosts
[0m16:41:25.476579 [info ] [Thread-1 (]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m16:41:25.482466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.fct_reviews, now model.dbtdnc.dim_listings_w_hosts)
[0m16:41:25.485601 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_w_hosts
[0m16:41:25.496873 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_w_hosts"
[0m16:41:25.499409 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (compile): 16:41:25.487098 => 16:41:25.498531
[0m16:41:25.500871 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_w_hosts
[0m16:41:25.534021 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.dim_listings_w_hosts"
[0m16:41:25.536220 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.dim_listings_w_hosts"
[0m16:41:25.536934 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    l as (select * from AIRBNB.dev.dim_listings_cleansed),
    h as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
        );
[0m16:41:25.537495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:27.141686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:41:27.159673 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (execute): 16:41:25.501719 => 16:41:27.158365
[0m16:41:27.161983 [debug] [Thread-1 (]: On model.dbtdnc.dim_listings_w_hosts: Close
[0m16:41:27.257370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd22dd9-f183-4bc3-8559-9a64e0e78a25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b0ee8f130>]}
[0m16:41:27.261647 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.78s]
[0m16:41:27.269683 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_w_hosts
[0m16:41:27.273333 [debug] [Thread-1 (]: Began running node model.dbtdnc.mart_fullmoon_reviews
[0m16:41:27.276827 [info ] [Thread-1 (]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m16:41:27.280786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_w_hosts, now model.dbtdnc.mart_fullmoon_reviews)
[0m16:41:27.283586 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.mart_fullmoon_reviews
[0m16:41:27.291169 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.mart_fullmoon_reviews"
[0m16:41:27.293778 [debug] [Thread-1 (]: Timing info for model.dbtdnc.mart_fullmoon_reviews (compile): 16:41:27.285134 => 16:41:27.292857
[0m16:41:27.295811 [debug] [Thread-1 (]: Began executing node model.dbtdnc.mart_fullmoon_reviews
[0m16:41:27.303856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtdnc.mart_fullmoon_reviews"
[0m16:41:27.306307 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdnc.mart_fullmoon_reviews"
[0m16:41:27.307069 [debug] [Thread-1 (]: On model.dbtdnc.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "model.dbtdnc.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.dev.mart_fullmoon_reviews
         as
        (
with
    fct_reviews as (select * from AIRBNB.dev.fct_reviews),
    full_moon_dates as (select * from AIRBNB.dev.seed_full_moon_dates)
select
    r.*,
    case
        when fm.full_moon_date is null then 'not full moon' else 'full moon'
    end as is_full_moon
from fct_reviews r
left join
    full_moon_dates fm on (to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date))
        );
[0m16:41:27.307709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:30.752837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:41:30.774094 [debug] [Thread-1 (]: Timing info for model.dbtdnc.mart_fullmoon_reviews (execute): 16:41:27.296998 => 16:41:30.772201
[0m16:41:30.778844 [debug] [Thread-1 (]: On model.dbtdnc.mart_fullmoon_reviews: Close
[0m16:41:30.885428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd22dd9-f183-4bc3-8559-9a64e0e78a25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b0d582d70>]}
[0m16:41:30.886955 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 3.61s]
[0m16:41:30.888588 [debug] [Thread-1 (]: Finished running node model.dbtdnc.mart_fullmoon_reviews
[0m16:41:30.891043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:30.891776 [debug] [MainThread]: Connection 'model.dbtdnc.mart_fullmoon_reviews' was properly closed.
[0m16:41:30.892633 [info ] [MainThread]: 
[0m16:41:30.893537 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m16:41:30.898990 [debug] [MainThread]: Command end result
[0m16:41:30.916493 [info ] [MainThread]: 
[0m16:41:30.917411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:41:30.918169 [info ] [MainThread]: 
[0m16:41:30.919113 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:41:30.921310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.187114, "process_user_time": 4.551578, "process_kernel_time": 0.844374, "process_mem_max_rss": "196740", "process_out_blocks": "1952", "process_in_blocks": "0"}
[0m16:41:30.923125 [debug] [MainThread]: Command `dbt run` succeeded at 16:41:30.922770 after 11.19 seconds
[0m16:41:30.923921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b3cbb29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b0fa2c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709b0fd8a560>]}
[0m16:41:30.924743 [debug] [MainThread]: Flushing usage events
[0m16:51:00.103806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7a4786140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7a2ac24d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7a2ac2470>]}


============================== 16:51:00.106329 | 9798b9ae-bde4-4108-b2df-0d946e95e4c6 ==============================
[0m16:51:00.106329 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:51:00.107034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m16:51:00.897133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9798b9ae-bde4-4108-b2df-0d946e95e4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7a2ac25c0>]}
[0m16:51:00.963313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9798b9ae-bde4-4108-b2df-0d946e95e4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7777e1c00>]}
[0m16:51:00.964349 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:51:00.972728 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:51:01.005997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:51:01.006672 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:51:01.012537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9798b9ae-bde4-4108-b2df-0d946e95e4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7774ea740>]}
[0m16:51:01.025225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9798b9ae-bde4-4108-b2df-0d946e95e4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a77761c1f0>]}
[0m16:51:01.026184 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:51:01.026752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9798b9ae-bde4-4108-b2df-0d946e95e4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a77761d3f0>]}
[0m16:51:01.028698 [info ] [MainThread]: 
[0m16:51:01.029571 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:51:01.031238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m16:51:01.130873 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:51:01.131811 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:51:01.132732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:01.823113 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m16:51:01.827329 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:51:01.932445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9798b9ae-bde4-4108-b2df-0d946e95e4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7774b4040>]}
[0m16:51:01.936791 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:51:01.939283 [info ] [MainThread]: 
[0m16:51:01.946519 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m16:51:01.948627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtdnc.src_hosts)
[0m16:51:01.950516 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m16:51:01.967595 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m16:51:01.969759 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 16:51:01.952455 => 16:51:01.969001
[0m16:51:01.972018 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m16:51:01.973014 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m16:51:01.974345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m16:51:01.975151 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m16:51:01.978452 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m16:51:01.979353 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 16:51:01.975596 => 16:51:01.978979
[0m16:51:01.980340 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m16:51:01.981012 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m16:51:01.983707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m16:51:01.985484 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m16:51:01.989826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m16:51:01.991196 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 16:51:01.986437 => 16:51:01.990796
[0m16:51:01.992515 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m16:51:01.993145 [debug] [Thread-1 (]: Began running node seed.dbtdnc.seed_full_moon_dates
[0m16:51:01.993916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_reviews, now seed.dbtdnc.seed_full_moon_dates)
[0m16:51:01.994551 [debug] [Thread-1 (]: Began compiling node seed.dbtdnc.seed_full_moon_dates
[0m16:51:01.996692 [debug] [Thread-1 (]: Timing info for seed.dbtdnc.seed_full_moon_dates (compile): 16:51:01.994914 => 16:51:01.996406
[0m16:51:01.997317 [debug] [Thread-1 (]: Began executing node seed.dbtdnc.seed_full_moon_dates
[0m16:51:01.997978 [debug] [Thread-1 (]: Timing info for seed.dbtdnc.seed_full_moon_dates (execute): 16:51:01.997687 => 16:51:01.997695
[0m16:51:01.999083 [debug] [Thread-1 (]: Finished running node seed.dbtdnc.seed_full_moon_dates
[0m16:51:01.999780 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m16:51:02.001025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtdnc.seed_full_moon_dates, now model.dbtdnc.dim_hosts_cleansed)
[0m16:51:02.001751 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m16:51:02.008763 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m16:51:02.009688 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 16:51:02.002226 => 16:51:02.009381
[0m16:51:02.010349 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m16:51:02.011016 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 16:51:02.010711 => 16:51:02.010723
[0m16:51:02.012064 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m16:51:02.012682 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m16:51:02.013471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m16:51:02.014204 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m16:51:02.023182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m16:51:02.024608 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 16:51:02.014808 => 16:51:02.024198
[0m16:51:02.025221 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m16:51:02.025906 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 16:51:02.025598 => 16:51:02.025611
[0m16:51:02.026994 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m16:51:02.027618 [debug] [Thread-1 (]: Began running node model.dbtdnc.fct_reviews
[0m16:51:02.028568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.fct_reviews)
[0m16:51:02.029156 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.fct_reviews
[0m16:51:02.042754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.fct_reviews"
[0m16:51:02.044092 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (compile): 16:51:02.029510 => 16:51:02.043616
[0m16:51:02.044701 [debug] [Thread-1 (]: Began executing node model.dbtdnc.fct_reviews
[0m16:51:02.045584 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (execute): 16:51:02.045071 => 16:51:02.045084
[0m16:51:02.046818 [debug] [Thread-1 (]: Finished running node model.dbtdnc.fct_reviews
[0m16:51:02.047463 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_w_hosts
[0m16:51:02.048669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.fct_reviews, now model.dbtdnc.dim_listings_w_hosts)
[0m16:51:02.049255 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_w_hosts
[0m16:51:02.053774 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_w_hosts"
[0m16:51:02.054918 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (compile): 16:51:02.049699 => 16:51:02.054484
[0m16:51:02.055654 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_w_hosts
[0m16:51:02.056406 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (execute): 16:51:02.056083 => 16:51:02.056103
[0m16:51:02.057576 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_w_hosts
[0m16:51:02.058333 [debug] [Thread-1 (]: Began running node model.dbtdnc.mart_fullmoon_reviews
[0m16:51:02.059137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_w_hosts, now model.dbtdnc.mart_fullmoon_reviews)
[0m16:51:02.059768 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.mart_fullmoon_reviews
[0m16:51:02.063253 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.mart_fullmoon_reviews"
[0m16:51:02.064125 [debug] [Thread-1 (]: Timing info for model.dbtdnc.mart_fullmoon_reviews (compile): 16:51:02.060137 => 16:51:02.063822
[0m16:51:02.064707 [debug] [Thread-1 (]: Began executing node model.dbtdnc.mart_fullmoon_reviews
[0m16:51:02.065425 [debug] [Thread-1 (]: Timing info for model.dbtdnc.mart_fullmoon_reviews (execute): 16:51:02.065066 => 16:51:02.065077
[0m16:51:02.066826 [debug] [Thread-1 (]: Finished running node model.dbtdnc.mart_fullmoon_reviews
[0m16:51:02.068355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:02.069400 [debug] [MainThread]: Connection 'model.dbtdnc.mart_fullmoon_reviews' was properly closed.
[0m16:51:02.071155 [debug] [MainThread]: Command end result
[0m16:51:02.079503 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0231557, "process_user_time": 3.788183, "process_kernel_time": 0.753649, "process_mem_max_rss": "194792", "process_out_blocks": "1888", "process_in_blocks": "0"}
[0m16:51:02.080269 [debug] [MainThread]: Command `dbt compile` succeeded at 16:51:02.080076 after 2.02 seconds
[0m16:51:02.080817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7a4786140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a77732b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a77761c1f0>]}
[0m16:51:02.081590 [debug] [MainThread]: Flushing usage events
[0m16:54:59.659634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757c1d47aa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757c1b982530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757c1b9824d0>]}


============================== 16:54:59.662498 | cc17ef96-172b-4d6c-a4ce-af50b398a06f ==============================
[0m16:54:59.662498 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:54:59.663506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'version_check': 'True', 'profiles_dir': '/home/lkeiti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt source freshness', 'send_anonymous_usage_stats': 'True'}
[0m16:55:00.355321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc17ef96-172b-4d6c-a4ce-af50b398a06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757c1b982620>]}
[0m16:55:00.422538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc17ef96-172b-4d6c-a4ce-af50b398a06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757bf4513d60>]}
[0m16:55:00.424081 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:55:00.431906 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m16:55:00.464202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:00.464791 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:00.471488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc17ef96-172b-4d6c-a4ce-af50b398a06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757bf42367d0>]}
[0m16:55:00.483442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc17ef96-172b-4d6c-a4ce-af50b398a06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757bf455ea70>]}
[0m16:55:00.484076 [info ] [MainThread]: Found 1 seed, 8 models, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:55:00.484608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc17ef96-172b-4d6c-a4ce-af50b398a06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757bf455ef50>]}
[0m16:55:00.486259 [info ] [MainThread]: 
[0m16:55:00.487173 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:55:00.489047 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m16:55:00.579325 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m16:55:00.580152 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m16:55:00.580659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:01.307390 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m16:55:01.315707 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m16:55:01.429843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc17ef96-172b-4d6c-a4ce-af50b398a06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757bf41f3ac0>]}
[0m16:55:01.433967 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:01.437237 [info ] [MainThread]: 
[0m16:55:01.445010 [debug] [Thread-1 (]: Began running node source.dbtdnc.airbnb.reviews
[0m16:55:01.446689 [info ] [Thread-1 (]: 1 of 1 START freshness of airbnb.reviews ....................................... [RUN]
[0m16:55:01.448917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now source.dbtdnc.airbnb.reviews)
[0m16:55:01.450550 [debug] [Thread-1 (]: Began compiling node source.dbtdnc.airbnb.reviews
[0m16:55:01.452236 [debug] [Thread-1 (]: Timing info for source.dbtdnc.airbnb.reviews (compile): 16:55:01.451451 => 16:55:01.451465
[0m16:55:01.453775 [debug] [Thread-1 (]: Began executing node source.dbtdnc.airbnb.reviews
[0m16:55:01.473546 [debug] [Thread-1 (]: Using snowflake connection "source.dbtdnc.airbnb.reviews"
[0m16:55:01.474502 [debug] [Thread-1 (]: On source.dbtdnc.airbnb.reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "source.dbtdnc.airbnb.reviews"} */
select
      max(date) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from AIRBNB.raw.raw_reviews
[0m16:55:01.475225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:02.046665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:55:02.054016 [debug] [Thread-1 (]: On source.dbtdnc.airbnb.reviews: Close
[0m16:55:02.163879 [debug] [Thread-1 (]: Timing info for source.dbtdnc.airbnb.reviews (execute): 16:55:01.455123 => 16:55:02.162440
[0m16:55:02.168335 [warn ] [Thread-1 (]: 1 of 1 WARN freshness of airbnb.reviews ........................................ [[33mWARN[0m in 0.72s]
[0m16:55:02.172715 [debug] [Thread-1 (]: Finished running node source.dbtdnc.airbnb.reviews
[0m16:55:02.177626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:02.181559 [debug] [MainThread]: Connection 'source.dbtdnc.airbnb.reviews' was properly closed.
[0m16:55:02.207868 [info ] [MainThread]: Done.
[0m16:55:02.211003 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 2.594213, "process_user_time": 3.566355, "process_kernel_time": 0.722047, "process_mem_max_rss": "194720", "process_out_blocks": "1800", "process_in_blocks": "0"}
[0m16:55:02.213686 [debug] [MainThread]: Command `dbt source freshness` succeeded at 16:55:02.213073 after 2.60 seconds
[0m16:55:02.215557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757c1d47aa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757bf449e980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757bf407fc70>]}
[0m16:55:02.217202 [debug] [MainThread]: Flushing usage events
[0m17:24:27.865990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040bae9e9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b93aa440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b93aa3e0>]}


============================== 17:24:27.868547 | 818c6557-7302-4719-aee1-f9db223acd3c ==============================
[0m17:24:27.868547 [info ] [MainThread]: Running with dbt=1.7.14
[0m17:24:27.869555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'profiles_dir': '/home/lkeiti/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m17:24:28.549551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '818c6557-7302-4719-aee1-f9db223acd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b93aa530>]}
[0m17:24:28.612295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '818c6557-7302-4719-aee1-f9db223acd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b93a9c90>]}
[0m17:24:28.613189 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:24:28.620224 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m17:24:28.652531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:24:28.653314 [debug] [MainThread]: Partial parsing: added file: dbtdnc://snapshots/scd_raw_listings.sql
[0m17:24:28.895806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '818c6557-7302-4719-aee1-f9db223acd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70408dae15a0>]}
[0m17:24:28.907124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '818c6557-7302-4719-aee1-f9db223acd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70408dd05c00>]}
[0m17:24:28.907894 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:24:28.908606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '818c6557-7302-4719-aee1-f9db223acd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70408dd07ac0>]}
[0m17:24:28.910774 [info ] [MainThread]: 
[0m17:24:28.911855 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:24:28.913252 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:24:28.929872 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:24:28.930701 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:24:28.931224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:29.594416 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:24:29.601787 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m17:24:29.703366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m17:24:29.731916 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m17:24:29.732895 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m17:24:29.733770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:30.186301 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m17:24:30.188850 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m17:24:30.290228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m17:24:30.308533 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:24:30.309985 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m17:24:30.311305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:30.872463 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m17:24:30.881244 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:24:30.987241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '818c6557-7302-4719-aee1-f9db223acd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70408da67520>]}
[0m17:24:30.990946 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:30.993256 [info ] [MainThread]: 
[0m17:24:31.000282 [debug] [Thread-1 (]: Began running node snapshot.dbtdnc.scd_raw_listings
[0m17:24:31.002237 [info ] [Thread-1 (]: 1 of 1 START snapshot DEV.scd_raw_listings ..................................... [RUN]
[0m17:24:31.005558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now snapshot.dbtdnc.scd_raw_listings)
[0m17:24:31.007207 [debug] [Thread-1 (]: Began compiling node snapshot.dbtdnc.scd_raw_listings
[0m17:24:31.028701 [debug] [Thread-1 (]: Timing info for snapshot.dbtdnc.scd_raw_listings (compile): 17:24:31.008029 => 17:24:31.027893
[0m17:24:31.030041 [debug] [Thread-1 (]: Began executing node snapshot.dbtdnc.scd_raw_listings
[0m17:24:31.128317 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtdnc.scd_raw_listings"
[0m17:24:31.129563 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtdnc.scd_raw_listings"
[0m17:24:31.130142 [debug] [Thread-1 (]: On snapshot.dbtdnc.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "snapshot.dbtdnc.scd_raw_listings"} */
create or replace transient table AIRBNB.DEV.scd_raw_listings
         as
        (

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        
    
    select *
    from AIRBNB.raw.raw_listings
    ) sbq



        );
[0m17:24:31.130765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:32.966250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:24:32.997984 [debug] [Thread-1 (]: Timing info for snapshot.dbtdnc.scd_raw_listings (execute): 17:24:31.030947 => 17:24:32.997638
[0m17:24:32.998998 [debug] [Thread-1 (]: On snapshot.dbtdnc.scd_raw_listings: Close
[0m17:24:33.098582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '818c6557-7302-4719-aee1-f9db223acd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70408d134100>]}
[0m17:24:33.103396 [info ] [Thread-1 (]: 1 of 1 OK snapshotted DEV.scd_raw_listings ..................................... [[32mSUCCESS 1[0m in 2.09s]
[0m17:24:33.110158 [debug] [Thread-1 (]: Finished running node snapshot.dbtdnc.scd_raw_listings
[0m17:24:33.121523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:33.125586 [debug] [MainThread]: Connection 'snapshot.dbtdnc.scd_raw_listings' was properly closed.
[0m17:24:33.129722 [info ] [MainThread]: 
[0m17:24:33.133991 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m17:24:33.139755 [debug] [MainThread]: Command end result
[0m17:24:33.176806 [info ] [MainThread]: 
[0m17:24:33.180158 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:24:33.183037 [info ] [MainThread]: 
[0m17:24:33.185800 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:24:33.187976 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.3673997, "process_user_time": 3.98074, "process_kernel_time": 0.828822, "process_mem_max_rss": "198920", "process_in_blocks": "8", "process_out_blocks": "2688"}
[0m17:24:33.190226 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:24:33.189529 after 5.37 seconds
[0m17:24:33.192235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040bae9e9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b93aa530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70408dd05ba0>]}
[0m17:24:33.194354 [debug] [MainThread]: Flushing usage events
[0m17:24:50.395189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721ed9db2a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721ed80c2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721ed80c2410>]}


============================== 17:24:50.397710 | a2d02f50-939c-44e2-b2a6-416b5b35959b ==============================
[0m17:24:50.397710 [info ] [MainThread]: Running with dbt=1.7.14
[0m17:24:50.398467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:24:51.108464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2d02f50-939c-44e2-b2a6-416b5b35959b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721ed80c2560>]}
[0m17:24:51.181036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2d02f50-939c-44e2-b2a6-416b5b35959b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721eb0f2a7a0>]}
[0m17:24:51.182650 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:24:51.192012 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m17:24:51.226837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:51.227677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:51.235697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2d02f50-939c-44e2-b2a6-416b5b35959b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721eb09d80d0>]}
[0m17:24:51.245329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2d02f50-939c-44e2-b2a6-416b5b35959b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721eb0b94dc0>]}
[0m17:24:51.246356 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:24:51.247105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2d02f50-939c-44e2-b2a6-416b5b35959b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721eb0cf7790>]}
[0m17:24:51.249712 [info ] [MainThread]: 
[0m17:24:51.251524 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:24:51.254136 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:24:51.340379 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:24:51.341170 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:24:51.341689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:52.138250 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:24:52.141011 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m17:24:52.227466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m17:24:52.245757 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m17:24:52.247170 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m17:24:52.248097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:52.807672 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:24:52.809519 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m17:24:52.913069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m17:24:52.925349 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:24:52.926547 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m17:24:52.927985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:53.305863 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m17:24:53.312077 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:24:53.410541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2d02f50-939c-44e2-b2a6-416b5b35959b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721eb0bbbd00>]}
[0m17:24:53.411789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:53.412519 [info ] [MainThread]: 
[0m17:24:53.414861 [debug] [Thread-1 (]: Began running node snapshot.dbtdnc.scd_raw_listings
[0m17:24:53.415536 [info ] [Thread-1 (]: 1 of 1 START snapshot DEV.scd_raw_listings ..................................... [RUN]
[0m17:24:53.416785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now snapshot.dbtdnc.scd_raw_listings)
[0m17:24:53.417749 [debug] [Thread-1 (]: Began compiling node snapshot.dbtdnc.scd_raw_listings
[0m17:24:53.429588 [debug] [Thread-1 (]: Timing info for snapshot.dbtdnc.scd_raw_listings (compile): 17:24:53.418225 => 17:24:53.428997
[0m17:24:53.430605 [debug] [Thread-1 (]: Began executing node snapshot.dbtdnc.scd_raw_listings
[0m17:24:53.488814 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtdnc.scd_raw_listings"
[0m17:24:53.489591 [debug] [Thread-1 (]: On snapshot.dbtdnc.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "snapshot.dbtdnc.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m17:24:53.490299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:53.796732 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m17:24:53.859739 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtdnc.scd_raw_listings"
[0m17:24:53.860503 [debug] [Thread-1 (]: On snapshot.dbtdnc.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "snapshot.dbtdnc.scd_raw_listings"} */
create or replace temporary table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
         as
        (with snapshot_query as (

        
    
    select *
    from AIRBNB.raw.raw_listings

    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m17:24:55.630871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:24:55.635864 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtdnc.scd_raw_listings"
[0m17:24:55.636845 [debug] [Thread-1 (]: On snapshot.dbtdnc.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "snapshot.dbtdnc.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m17:24:55.738075 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.0 seconds
[0m17:24:55.743563 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtdnc.scd_raw_listings"
[0m17:24:55.744328 [debug] [Thread-1 (]: On snapshot.dbtdnc.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "snapshot.dbtdnc.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m17:24:55.836270 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m17:24:55.843289 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtdnc.scd_raw_listings"
[0m17:24:55.843965 [debug] [Thread-1 (]: On snapshot.dbtdnc.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "snapshot.dbtdnc.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m17:24:55.925034 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.0 seconds
[0m17:24:55.931067 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtdnc.scd_raw_listings"
[0m17:24:55.932263 [debug] [Thread-1 (]: On snapshot.dbtdnc.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "snapshot.dbtdnc.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m17:24:55.997731 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m17:24:56.007737 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtdnc.scd_raw_listings"
[0m17:24:56.008501 [debug] [Thread-1 (]: On snapshot.dbtdnc.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "snapshot.dbtdnc.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m17:24:56.070542 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.0 seconds
[0m17:24:56.083218 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtdnc.scd_raw_listings"
[0m17:24:56.085013 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtdnc.scd_raw_listings"
[0m17:24:56.085749 [debug] [Thread-1 (]: On snapshot.dbtdnc.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "snapshot.dbtdnc.scd_raw_listings"} */
BEGIN
[0m17:24:56.196833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:24:56.199081 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtdnc.scd_raw_listings"
[0m17:24:56.202206 [debug] [Thread-1 (]: On snapshot.dbtdnc.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "snapshot.dbtdnc.scd_raw_listings"} */
merge into "AIRBNB"."DEV"."SCD_RAW_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m17:24:56.959366 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 1.0 seconds
[0m17:24:56.962850 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtdnc.scd_raw_listings"
[0m17:24:56.965472 [debug] [Thread-1 (]: On snapshot.dbtdnc.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "snapshot.dbtdnc.scd_raw_listings"} */
COMMIT
[0m17:24:57.350385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:24:57.397803 [debug] [Thread-1 (]: Timing info for snapshot.dbtdnc.scd_raw_listings (execute): 17:24:53.431310 => 17:24:57.397488
[0m17:24:57.398509 [debug] [Thread-1 (]: On snapshot.dbtdnc.scd_raw_listings: Close
[0m17:24:57.491844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d02f50-939c-44e2-b2a6-416b5b35959b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721eabf212a0>]}
[0m17:24:57.495863 [info ] [Thread-1 (]: 1 of 1 OK snapshotted DEV.scd_raw_listings ..................................... [[32mSUCCESS 2[0m in 4.07s]
[0m17:24:57.500177 [debug] [Thread-1 (]: Finished running node snapshot.dbtdnc.scd_raw_listings
[0m17:24:57.507837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:57.510681 [debug] [MainThread]: Connection 'snapshot.dbtdnc.scd_raw_listings' was properly closed.
[0m17:24:57.513063 [info ] [MainThread]: 
[0m17:24:57.515561 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m17:24:57.519899 [debug] [MainThread]: Command end result
[0m17:24:57.549565 [info ] [MainThread]: 
[0m17:24:57.550990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:24:57.552066 [info ] [MainThread]: 
[0m17:24:57.553188 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:24:57.555327 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.202699, "process_user_time": 3.864437, "process_kernel_time": 0.83663, "process_mem_max_rss": "196904", "process_out_blocks": "1832", "process_in_blocks": "0"}
[0m17:24:57.558752 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:24:57.557925 after 7.21 seconds
[0m17:24:57.560129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721ed9db2a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721eb0cf45e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721ed80c2560>]}
[0m17:24:57.560958 [debug] [MainThread]: Flushing usage events
[0m17:26:32.126119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc11a07a9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc118586440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc1185863e0>]}


============================== 17:26:32.128667 | 7c1ba60b-40b0-401f-8f03-fe28e922d58f ==============================
[0m17:26:32.128667 [info ] [MainThread]: Running with dbt=1.7.14
[0m17:26:32.129356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'fail_fast': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:26:32.823591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c1ba60b-40b0-401f-8f03-fe28e922d58f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc118586530>]}
[0m17:26:32.886834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c1ba60b-40b0-401f-8f03-fe28e922d58f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc118585c90>]}
[0m17:26:32.887690 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:26:32.895197 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m17:26:32.932386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:26:32.933055 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:26:32.940030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c1ba60b-40b0-401f-8f03-fe28e922d58f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc0f0e5c0d0>]}
[0m17:26:32.952394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c1ba60b-40b0-401f-8f03-fe28e922d58f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc0f0e0cbe0>]}
[0m17:26:32.953129 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 2 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:26:32.953711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1ba60b-40b0-401f-8f03-fe28e922d58f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc0f0e0d8d0>]}
[0m17:26:32.955846 [info ] [MainThread]: 
[0m17:26:32.956783 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:26:32.958748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m17:26:33.036620 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:26:33.037552 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m17:26:33.038082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:33.728329 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:26:33.735876 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:26:33.842005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m17:26:33.865083 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m17:26:33.866936 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m17:26:33.868585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:34.311446 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m17:26:34.318978 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m17:26:34.439732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1ba60b-40b0-401f-8f03-fe28e922d58f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc0f0e0ccd0>]}
[0m17:26:34.440789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:34.441324 [info ] [MainThread]: 
[0m17:26:34.443665 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:26:34.444398 [info ] [Thread-1 (]: 1 of 2 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m17:26:34.445315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m17:26:34.445874 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:26:34.466215 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:26:34.467209 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 17:26:34.446225 => 17:26:34.466911
[0m17:26:34.468044 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:26:34.490580 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:26:34.491983 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:26:34.492608 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m17:26:34.493162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:34.948027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:26:34.974480 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 17:26:34.468397 => 17:26:34.973461
[0m17:26:34.976141 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m17:26:35.058645 [info ] [Thread-1 (]: 1 of 2 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.61s]
[0m17:26:35.063433 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:26:35.066392 [debug] [Thread-1 (]: Began running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:26:35.070346 [info ] [Thread-1 (]: 2 of 2 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m17:26:35.075770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m17:26:35.079086 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:26:35.098826 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:26:35.100320 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 17:26:35.080720 => 17:26:35.099836
[0m17:26:35.101053 [debug] [Thread-1 (]: Began executing node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:26:35.105392 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:26:35.106940 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:26:35.107912 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:26:35.108932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:35.698938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:26:35.709997 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 17:26:35.101512 => 17:26:35.708468
[0m17:26:35.713169 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m17:26:35.815740 [info ] [Thread-1 (]: 2 of 2 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.74s]
[0m17:26:35.819385 [debug] [Thread-1 (]: Finished running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:26:35.824775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:35.826060 [debug] [MainThread]: Connection 'test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m17:26:35.827568 [info ] [MainThread]: 
[0m17:26:35.828954 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m17:26:35.831104 [debug] [MainThread]: Command end result
[0m17:26:35.845592 [info ] [MainThread]: 
[0m17:26:35.847019 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:26:35.848079 [info ] [MainThread]: 
[0m17:26:35.848894 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:26:35.850417 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.7688088, "process_user_time": 3.750523, "process_kernel_time": 0.753276, "process_mem_max_rss": "195640", "process_out_blocks": "1880", "process_in_blocks": "0"}
[0m17:26:35.851474 [debug] [MainThread]: Command `dbt test` succeeded at 17:26:35.851227 after 3.77 seconds
[0m17:26:35.852343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc11a07a9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc0f11175e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc118586530>]}
[0m17:26:35.852992 [debug] [MainThread]: Flushing usage events
[0m17:30:09.256090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8a201ae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8a1e4be410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8a1e4be3b0>]}


============================== 17:30:09.259216 | c9d22e3a-5487-45e2-80c1-e41d46c020d6 ==============================
[0m17:30:09.259216 [info ] [MainThread]: Running with dbt=1.7.14
[0m17:30:09.260091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:30:09.981074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9d22e3a-5487-45e2-80c1-e41d46c020d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8a1e4be500>]}
[0m17:30:10.041220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9d22e3a-5487-45e2-80c1-e41d46c020d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e89f33d7430>]}
[0m17:30:10.042058 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:30:10.049575 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m17:30:10.089210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:10.089780 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:10.096146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9d22e3a-5487-45e2-80c1-e41d46c020d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e89f2e98250>]}
[0m17:30:10.106477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9d22e3a-5487-45e2-80c1-e41d46c020d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e89f3045420>]}
[0m17:30:10.107172 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 4 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:30:10.107774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9d22e3a-5487-45e2-80c1-e41d46c020d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e89f3046110>]}
[0m17:30:10.109698 [info ] [MainThread]: 
[0m17:30:10.110727 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:30:10.112751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m17:30:10.194880 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:30:10.195565 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m17:30:10.196067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:10.869179 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:30:10.876917 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:30:10.985491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m17:30:11.008373 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m17:30:11.011010 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m17:30:11.013317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:11.633861 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:30:11.641926 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m17:30:11.757998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9d22e3a-5487-45e2-80c1-e41d46c020d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e89f3046170>]}
[0m17:30:11.762061 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:11.764651 [info ] [MainThread]: 
[0m17:30:11.772889 [debug] [Thread-1 (]: Began running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:30:11.774992 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m17:30:11.777447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m17:30:11.780010 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:30:11.819672 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m17:30:11.822155 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 17:30:11.781481 => 17:30:11.821314
[0m17:30:11.823697 [debug] [Thread-1 (]: Began executing node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:30:11.857153 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m17:30:11.858920 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m17:30:11.859769 [debug] [Thread-1 (]: On test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m17:30:11.860540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:12.289745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:30:12.298125 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 17:30:11.824635 => 17:30:12.297618
[0m17:30:12.299164 [debug] [Thread-1 (]: On test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m17:30:12.399825 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.62s]
[0m17:30:12.404062 [debug] [Thread-1 (]: Finished running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:30:12.407048 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:30:12.410108 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m17:30:12.414867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m17:30:12.417125 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:30:12.438770 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:30:12.440737 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 17:30:12.418506 => 17:30:12.440082
[0m17:30:12.442251 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:30:12.447760 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:30:12.449031 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:30:12.449774 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m17:30:12.450703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:12.867644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:30:12.869825 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 17:30:12.442887 => 17:30:12.869527
[0m17:30:12.870400 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m17:30:12.953059 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.54s]
[0m17:30:12.957938 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:30:12.961025 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:30:12.964487 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m17:30:12.968205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m17:30:12.971312 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:30:12.986143 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:30:12.988050 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 17:30:12.973146 => 17:30:12.987465
[0m17:30:12.989057 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:30:12.995651 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:30:12.997187 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:30:12.997965 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m17:30:12.998723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:13.389027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:30:13.393521 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 17:30:12.989672 => 17:30:13.392961
[0m17:30:13.394581 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m17:30:13.487783 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.52s]
[0m17:30:13.489595 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:30:13.490846 [debug] [Thread-1 (]: Began running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:30:13.492286 [info ] [Thread-1 (]: 4 of 4 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m17:30:13.493765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m17:30:13.494834 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:30:13.509981 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:30:13.512500 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 17:30:13.495464 => 17:30:13.511551
[0m17:30:13.514464 [debug] [Thread-1 (]: Began executing node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:30:13.525732 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:30:13.527244 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:30:13.528040 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:30:13.528838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:13.889307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:30:13.897380 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 17:30:13.515596 => 17:30:13.896328
[0m17:30:13.899576 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m17:30:14.001191 [info ] [Thread-1 (]: 4 of 4 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.51s]
[0m17:30:14.005359 [debug] [Thread-1 (]: Finished running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:30:14.014440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:14.018255 [debug] [MainThread]: Connection 'test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m17:30:14.022601 [info ] [MainThread]: 
[0m17:30:14.027321 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m17:30:14.034959 [debug] [MainThread]: Command end result
[0m17:30:14.059311 [info ] [MainThread]: 
[0m17:30:14.060637 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:14.061955 [info ] [MainThread]: 
[0m17:30:14.062954 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:30:14.064319 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.8533893, "process_user_time": 4.008479, "process_kernel_time": 0.891213, "process_mem_max_rss": "196360", "process_out_blocks": "1960", "process_in_blocks": "0"}
[0m17:30:14.065554 [debug] [MainThread]: Command `dbt test` succeeded at 17:30:14.065226 after 4.85 seconds
[0m17:30:14.066772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8a201ae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e89f335b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e89f24a4d00>]}
[0m17:30:14.067426 [debug] [MainThread]: Flushing usage events
[0m17:30:24.600549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dea95aaa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dea93dd6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dea93dd6320>]}


============================== 17:30:24.603123 | b1437b8e-5a5b-4b65-874e-c34780ef69f9 ==============================
[0m17:30:24.603123 [info ] [MainThread]: Running with dbt=1.7.14
[0m17:30:24.603918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m17:30:25.363067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1437b8e-5a5b-4b65-874e-c34780ef69f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dea93dd6470>]}
[0m17:30:25.429878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1437b8e-5a5b-4b65-874e-c34780ef69f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dea93dd5c90>]}
[0m17:30:25.431365 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:30:25.439271 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m17:30:25.471641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:25.472255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:25.478339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1437b8e-5a5b-4b65-874e-c34780ef69f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dea6c6dc1c0>]}
[0m17:30:25.490060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1437b8e-5a5b-4b65-874e-c34780ef69f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dea6c68d390>]}
[0m17:30:25.490883 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 4 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:30:25.491462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1437b8e-5a5b-4b65-874e-c34780ef69f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dea6c68e080>]}
[0m17:30:25.493292 [info ] [MainThread]: 
[0m17:30:25.494174 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:30:25.496083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m17:30:25.569209 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:30:25.569891 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m17:30:25.570479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:26.204057 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:30:26.215626 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:30:26.320691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m17:30:26.333751 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m17:30:26.335909 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m17:30:26.337849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:26.726108 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m17:30:26.734566 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m17:30:26.839983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1437b8e-5a5b-4b65-874e-c34780ef69f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dea6c68e0e0>]}
[0m17:30:26.844641 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:26.847963 [info ] [MainThread]: 
[0m17:30:26.855308 [debug] [Thread-1 (]: Began running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5
[0m17:30:26.857836 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room  [RUN]
[0m17:30:26.861234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5)
[0m17:30:26.863445 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5
[0m17:30:26.897033 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5"
[0m17:30:26.898222 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5 (compile): 17:30:26.864659 => 17:30:26.897904
[0m17:30:26.898844 [debug] [Thread-1 (]: Began executing node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5
[0m17:30:26.929088 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5"
[0m17:30:26.931177 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5"
[0m17:30:26.931865 [debug] [Thread-1 (]: On test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','error room','Hotel room'
)



      
    ) dbt_internal_test
[0m17:30:26.932455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:27.315256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:30:27.340843 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5 (execute): 17:30:26.899232 => 17:30:27.339914
[0m17:30:27.342585 [debug] [Thread-1 (]: On test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5: Close
[0m17:30:27.437298 [error] [Thread-1 (]: 1 of 4 FAIL 1 accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room  [[31mFAIL 1[0m in 0.58s]
[0m17:30:27.441089 [debug] [Thread-1 (]: Finished running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5
[0m17:30:27.444674 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:30:27.449071 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m17:30:27.453442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5, now test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m17:30:27.455935 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:30:27.476024 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:30:27.477960 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 17:30:27.457350 => 17:30:27.477271
[0m17:30:27.479298 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:30:27.485071 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:30:27.487223 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:30:27.488387 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m17:30:27.489379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:28.059169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:30:28.069255 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 17:30:27.480000 => 17:30:28.067824
[0m17:30:28.071998 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m17:30:28.173748 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.72s]
[0m17:30:28.177949 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:30:28.181043 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:30:28.184869 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m17:30:28.188654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m17:30:28.190778 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:30:28.203836 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:30:28.205355 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 17:30:28.191982 => 17:30:28.204867
[0m17:30:28.206320 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:30:28.212955 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:30:28.214517 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:30:28.215244 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m17:30:28.216458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:28.587833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:30:28.590029 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 17:30:28.206952 => 17:30:28.589737
[0m17:30:28.590683 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m17:30:28.677815 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.49s]
[0m17:30:28.681807 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:30:28.685205 [debug] [Thread-1 (]: Began running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:30:28.688028 [info ] [Thread-1 (]: 4 of 4 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m17:30:28.692063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m17:30:28.695688 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:30:28.714809 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:30:28.716449 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 17:30:28.697363 => 17:30:28.715911
[0m17:30:28.717958 [debug] [Thread-1 (]: Began executing node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:30:28.725391 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:30:28.727382 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:30:28.728298 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:30:28.729575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:29.150121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:30:29.159830 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 17:30:28.719208 => 17:30:29.158407
[0m17:30:29.163481 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m17:30:29.261364 [info ] [Thread-1 (]: 4 of 4 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.57s]
[0m17:30:29.265430 [debug] [Thread-1 (]: Finished running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:30:29.272942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:29.276052 [debug] [MainThread]: Connection 'test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m17:30:29.278580 [info ] [MainThread]: 
[0m17:30:29.281141 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m17:30:29.287111 [debug] [MainThread]: Command end result
[0m17:30:29.311102 [info ] [MainThread]: 
[0m17:30:29.312067 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:30:29.312848 [info ] [MainThread]: 
[0m17:30:29.313689 [error] [MainThread]: [31mFailure in test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room (models/schema.yml)[0m
[0m17:30:29.314464 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:30:29.315212 [info ] [MainThread]: 
[0m17:30:29.316147 [info ] [MainThread]:   compiled Code at target/compiled/dbtdnc/models/schema.yml/accepted_values_dim_listings_c_cce855c5c848ac94e5728ef06923c340.sql
[0m17:30:29.317567 [info ] [MainThread]: 
[0m17:30:29.318793 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:30:29.320125 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.7642407, "process_user_time": 4.224998, "process_kernel_time": 0.757613, "process_mem_max_rss": "195892", "process_out_blocks": "1952", "command_success": false, "process_in_blocks": "0"}
[0m17:30:29.320950 [debug] [MainThread]: Command `dbt test` failed at 17:30:29.320742 after 4.77 seconds
[0m17:30:29.321553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dea95aaa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dea6c9db010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dea6c4f7880>]}
[0m17:30:29.322166 [debug] [MainThread]: Flushing usage events
[0m17:31:28.228809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440ac67a9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440aab82320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440aab822c0>]}


============================== 17:31:28.231428 | 0c241ae5-3c90-49d7-948f-45e0ea914ddf ==============================
[0m17:31:28.231428 [info ] [MainThread]: Running with dbt=1.7.14
[0m17:31:28.232220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m17:31:28.232901 [info ] [MainThread]: dbt version: 1.7.14
[0m17:31:28.233399 [info ] [MainThread]: python version: 3.10.12
[0m17:31:28.233933 [info ] [MainThread]: python path: /home/lkeiti/Documents/dnc-data-engineer/.env/bin/python3
[0m17:31:28.234486 [info ] [MainThread]: os info: Linux-6.5.0-28-generic-x86_64-with-glibc2.35
[0m17:31:28.813489 [info ] [MainThread]: Using profiles dir at /home/lkeiti/.dbt
[0m17:31:28.814120 [info ] [MainThread]: Using profiles.yml file at /home/lkeiti/.dbt/profiles.yml
[0m17:31:28.814689 [info ] [MainThread]: Using dbt_project.yml file at /home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/dbt_project.yml
[0m17:31:28.815391 [info ] [MainThread]: adapter type: snowflake
[0m17:31:28.815891 [info ] [MainThread]: adapter version: 1.7.1
[0m17:31:28.912712 [info ] [MainThread]: Configuration:
[0m17:31:28.913494 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:31:28.913995 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:31:28.914571 [info ] [MainThread]: Required dependencies:
[0m17:31:28.915078 [debug] [MainThread]: Executing "git --help"
[0m17:31:28.917175 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:31:28.917726 [debug] [MainThread]: STDERR: "b''"
[0m17:31:28.918201 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:31:28.918801 [info ] [MainThread]: Connection:
[0m17:31:28.919363 [info ] [MainThread]:   account: kxjeitm-yy20508
[0m17:31:28.919849 [info ] [MainThread]:   user: dbt
[0m17:31:28.920373 [info ] [MainThread]:   database: AIRBNB
[0m17:31:28.920922 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m17:31:28.921557 [info ] [MainThread]:   role: transform
[0m17:31:28.922130 [info ] [MainThread]:   schema: dev
[0m17:31:28.922740 [info ] [MainThread]:   authenticator: None
[0m17:31:28.923546 [info ] [MainThread]:   private_key_path: None
[0m17:31:28.924065 [info ] [MainThread]:   token: None
[0m17:31:28.924647 [info ] [MainThread]:   oauth_client_id: None
[0m17:31:28.925163 [info ] [MainThread]:   query_tag: None
[0m17:31:28.925682 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:31:28.926222 [info ] [MainThread]:   host: None
[0m17:31:28.927313 [info ] [MainThread]:   port: None
[0m17:31:28.928340 [info ] [MainThread]:   proxy_host: None
[0m17:31:28.928950 [info ] [MainThread]:   proxy_port: None
[0m17:31:28.929527 [info ] [MainThread]:   protocol: None
[0m17:31:28.930092 [info ] [MainThread]:   connect_retries: 1
[0m17:31:28.930723 [info ] [MainThread]:   connect_timeout: None
[0m17:31:28.931249 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:31:28.931777 [info ] [MainThread]:   retry_all: False
[0m17:31:28.932387 [info ] [MainThread]:   insecure_mode: False
[0m17:31:28.932935 [info ] [MainThread]:   reuse_connections: None
[0m17:31:28.933666 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:31:28.934587 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:31:28.935589 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:31:28.936111 [debug] [MainThread]: On debug: select 1 as id
[0m17:31:28.936702 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:29.497676 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:31:29.502673 [debug] [MainThread]: On debug: Close
[0m17:31:29.595114 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:31:29.597746 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:31:29.601920 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.415339, "process_user_time": 3.056614, "process_kernel_time": 0.843066, "process_mem_max_rss": "188216", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m17:31:29.605625 [debug] [MainThread]: Command `dbt debug` succeeded at 17:31:29.604704 after 1.42 seconds
[0m17:31:29.608441 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:31:29.613228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440ac67a9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74407f6aa7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440aab81c30>]}
[0m17:31:29.615781 [debug] [MainThread]: Flushing usage events
[0m17:31:42.532444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748e3ba769b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748e39f82410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748e39f823b0>]}


============================== 17:31:42.535089 | ca80710b-2fc3-433c-bf00-101099db9e2f ==============================
[0m17:31:42.535089 [info ] [MainThread]: Running with dbt=1.7.14
[0m17:31:42.535801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'profiles_dir': '/home/lkeiti/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:31:43.169513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca80710b-2fc3-433c-bf00-101099db9e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748e39f82500>]}
[0m17:31:43.227698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca80710b-2fc3-433c-bf00-101099db9e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748e0eb0f430>]}
[0m17:31:43.228570 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:31:43.235450 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m17:31:43.266910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:31:43.267591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:31:43.273467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca80710b-2fc3-433c-bf00-101099db9e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748e0e854250>]}
[0m17:31:43.283143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca80710b-2fc3-433c-bf00-101099db9e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748e0e805420>]}
[0m17:31:43.283798 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 4 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:31:43.284362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca80710b-2fc3-433c-bf00-101099db9e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748e0e806110>]}
[0m17:31:43.286175 [info ] [MainThread]: 
[0m17:31:43.287165 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:31:43.288995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m17:31:43.356845 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:31:43.357438 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m17:31:43.357931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:44.027175 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:31:44.034485 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:31:44.134745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m17:31:44.155170 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m17:31:44.157580 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m17:31:44.159934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:44.630858 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m17:31:44.637890 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m17:31:44.746578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca80710b-2fc3-433c-bf00-101099db9e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748e0e806170>]}
[0m17:31:44.750614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:44.753008 [info ] [MainThread]: 
[0m17:31:44.761080 [debug] [Thread-1 (]: Began running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5
[0m17:31:44.764317 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room  [RUN]
[0m17:31:44.768536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5)
[0m17:31:44.771335 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5
[0m17:31:44.815389 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5"
[0m17:31:44.816410 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5 (compile): 17:31:44.773019 => 17:31:44.816072
[0m17:31:44.817072 [debug] [Thread-1 (]: Began executing node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5
[0m17:31:44.842337 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5"
[0m17:31:44.843600 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5"
[0m17:31:44.844238 [debug] [Thread-1 (]: On test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','error room','Hotel room'
)



      
    ) dbt_internal_test
[0m17:31:44.844851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:45.211264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:31:45.234005 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5 (execute): 17:31:44.817475 => 17:31:45.233339
[0m17:31:45.235151 [debug] [Thread-1 (]: On test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5: Close
[0m17:31:45.324368 [error] [Thread-1 (]: 1 of 4 FAIL 1 accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room  [[31mFAIL 1[0m in 0.56s]
[0m17:31:45.328168 [debug] [Thread-1 (]: Finished running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5
[0m17:31:45.331139 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:31:45.334154 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m17:31:45.338157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room.10870040b5, now test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m17:31:45.340810 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:31:45.362633 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:31:45.364853 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 17:31:45.342501 => 17:31:45.364059
[0m17:31:45.366555 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:31:45.374609 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:31:45.376774 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:31:45.378051 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m17:31:45.379249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:45.785309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:31:45.794792 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 17:31:45.367651 => 17:31:45.793431
[0m17:31:45.797385 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m17:31:45.903440 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.57s]
[0m17:31:45.907158 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:31:45.910856 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:31:45.914870 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m17:31:45.918908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m17:31:45.921935 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:31:45.935624 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:31:45.937992 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 17:31:45.923322 => 17:31:45.937165
[0m17:31:45.939468 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:31:45.946514 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:31:45.948624 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:31:45.949648 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m17:31:45.950360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:46.495864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:31:46.498141 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 17:31:45.940417 => 17:31:46.497809
[0m17:31:46.498916 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m17:31:46.582651 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.67s]
[0m17:31:46.583595 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:31:46.584236 [debug] [Thread-1 (]: Began running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:31:46.584818 [info ] [Thread-1 (]: 4 of 4 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m17:31:46.585775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m17:31:46.586457 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:31:46.594139 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:31:46.595288 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 17:31:46.586844 => 17:31:46.594878
[0m17:31:46.596319 [debug] [Thread-1 (]: Began executing node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:31:46.600390 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:31:46.601534 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:31:46.602192 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:31:46.602806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:46.970362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:31:46.973216 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 17:31:46.596701 => 17:31:46.972867
[0m17:31:46.974015 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m17:31:47.098755 [info ] [Thread-1 (]: 4 of 4 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.51s]
[0m17:31:47.103569 [debug] [Thread-1 (]: Finished running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:31:47.111363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:47.114604 [debug] [MainThread]: Connection 'test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m17:31:47.117877 [info ] [MainThread]: 
[0m17:31:47.120432 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m17:31:47.126801 [debug] [MainThread]: Command end result
[0m17:31:47.150482 [info ] [MainThread]: 
[0m17:31:47.151494 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:31:47.152329 [info ] [MainThread]: 
[0m17:31:47.153155 [error] [MainThread]: [31mFailure in test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__error_room__Hotel_room (models/schema.yml)[0m
[0m17:31:47.154046 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:31:47.155627 [info ] [MainThread]: 
[0m17:31:47.157042 [info ] [MainThread]:   compiled Code at target/compiled/dbtdnc/models/schema.yml/accepted_values_dim_listings_c_cce855c5c848ac94e5728ef06923c340.sql
[0m17:31:47.157982 [info ] [MainThread]: 
[0m17:31:47.159088 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:31:47.160643 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.67016, "process_user_time": 3.901547, "process_kernel_time": 0.89452, "process_mem_max_rss": "195964", "process_out_blocks": "1976", "command_success": false, "process_in_blocks": "0"}
[0m17:31:47.161985 [debug] [MainThread]: Command `dbt test` failed at 17:31:47.161713 after 4.67 seconds
[0m17:31:47.163035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748e3ba769b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748e0de6f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748e0e804a60>]}
[0m17:31:47.163932 [debug] [MainThread]: Flushing usage events
[0m17:35:18.779729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da67ff72140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da67e2ce4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da67e2ce470>]}


============================== 17:35:18.782354 | 6f9771a8-a863-4ac1-96d0-3f3de3df8a54 ==============================
[0m17:35:18.782354 [info ] [MainThread]: Running with dbt=1.7.14
[0m17:35:18.783026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:35:19.473129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f9771a8-a863-4ac1-96d0-3f3de3df8a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da67e2ce5c0>]}
[0m17:35:19.538697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f9771a8-a863-4ac1-96d0-3f3de3df8a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da652e8dc00>]}
[0m17:35:19.539569 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:35:19.547618 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m17:35:19.583035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:35:19.583795 [debug] [MainThread]: Partial parsing: added file: dbtdnc://tests/dim_listings_minimum_nights.sql
[0m17:35:19.753737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f9771a8-a863-4ac1-96d0-3f3de3df8a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da652ada500>]}
[0m17:35:19.766617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f9771a8-a863-4ac1-96d0-3f3de3df8a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da652d6ed10>]}
[0m17:35:19.767305 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 5 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:35:19.767947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f9771a8-a863-4ac1-96d0-3f3de3df8a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da652d6f520>]}
[0m17:35:19.769856 [info ] [MainThread]: 
[0m17:35:19.770814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:35:19.772293 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m17:35:19.791485 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:35:19.792775 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m17:35:19.794476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:20.520513 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:35:20.529515 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:35:20.624542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m17:35:20.633004 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m17:35:20.634318 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m17:35:20.635025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:21.235497 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:35:21.238773 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m17:35:21.370964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f9771a8-a863-4ac1-96d0-3f3de3df8a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da652d6feb0>]}
[0m17:35:21.375333 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:21.378579 [info ] [MainThread]: 
[0m17:35:21.386031 [debug] [Thread-1 (]: Began running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:35:21.388050 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m17:35:21.391329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m17:35:21.393406 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:35:21.424423 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m17:35:21.425560 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 17:35:21.394384 => 17:35:21.425101
[0m17:35:21.426395 [debug] [Thread-1 (]: Began executing node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:35:21.453649 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m17:35:21.454896 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m17:35:21.455501 [debug] [Thread-1 (]: On test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m17:35:21.456087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:21.884892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:35:21.902288 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 17:35:21.427095 => 17:35:21.901457
[0m17:35:21.903794 [debug] [Thread-1 (]: On test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m17:35:21.993843 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.60s]
[0m17:35:21.997514 [debug] [Thread-1 (]: Finished running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:35:22.000626 [debug] [Thread-1 (]: Began running node test.dbtdnc.dim_listings_minimum_nights
[0m17:35:22.003993 [info ] [Thread-1 (]: 2 of 5 START test dim_listings_minimum_nights .................................. [RUN]
[0m17:35:22.007972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtdnc.dim_listings_minimum_nights)
[0m17:35:22.010607 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.dim_listings_minimum_nights
[0m17:35:22.018992 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.dim_listings_minimum_nights"
[0m17:35:22.022124 [debug] [Thread-1 (]: Timing info for test.dbtdnc.dim_listings_minimum_nights (compile): 17:35:22.012419 => 17:35:22.021239
[0m17:35:22.023911 [debug] [Thread-1 (]: Began executing node test.dbtdnc.dim_listings_minimum_nights
[0m17:35:22.034101 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.dim_listings_minimum_nights"
[0m17:35:22.036294 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.dim_listings_minimum_nights"
[0m17:35:22.037684 [debug] [Thread-1 (]: On test.dbtdnc.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from { { ref("dim_listings_cleansed") } }
where minimum_nights < 1
limit 10
      
    ) dbt_internal_test
[0m17:35:22.038558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:22.444667 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b45a13-0000-4325-0000-000052fd3699
[0m17:35:22.445928 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 7 unexpected '{'.
syntax error line 7 at position 38 unexpected '}'.
[0m17:35:22.447513 [debug] [Thread-1 (]: Timing info for test.dbtdnc.dim_listings_minimum_nights (execute): 17:35:22.025165 => 17:35:22.446935
[0m17:35:22.448530 [debug] [Thread-1 (]: On test.dbtdnc.dim_listings_minimum_nights: Close
[0m17:35:22.549502 [debug] [Thread-1 (]: Database Error in test dim_listings_minimum_nights (tests/dim_listings_minimum_nights.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 7 unexpected '{'.
  syntax error line 7 at position 38 unexpected '}'.
  compiled Code at target/run/dbtdnc/tests/dim_listings_minimum_nights.sql
[0m17:35:22.551343 [error] [Thread-1 (]: 2 of 5 ERROR dim_listings_minimum_nights ....................................... [[31mERROR[0m in 0.54s]
[0m17:35:22.553600 [debug] [Thread-1 (]: Finished running node test.dbtdnc.dim_listings_minimum_nights
[0m17:35:22.554916 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:35:22.557096 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m17:35:22.558722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.dim_listings_minimum_nights, now test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m17:35:22.559844 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:35:22.570498 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:35:22.571661 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 17:35:22.560467 => 17:35:22.571279
[0m17:35:22.572397 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:35:22.576886 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:35:22.578177 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:35:22.578992 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m17:35:22.579678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:23.058602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:35:23.068054 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 17:35:22.572907 => 17:35:23.066686
[0m17:35:23.071393 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m17:35:23.186417 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.63s]
[0m17:35:23.190237 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:35:23.193119 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:35:23.196340 [info ] [Thread-1 (]: 4 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m17:35:23.200308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m17:35:23.203036 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:35:23.219734 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:35:23.222121 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 17:35:23.205099 => 17:35:23.221237
[0m17:35:23.223283 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:35:23.229387 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:35:23.231076 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:35:23.232057 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m17:35:23.232880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:23.658850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:35:23.668191 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 17:35:23.224075 => 17:35:23.666817
[0m17:35:23.670990 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m17:35:23.776973 [info ] [Thread-1 (]: 4 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.58s]
[0m17:35:23.780941 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:35:23.783337 [debug] [Thread-1 (]: Began running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:35:23.785476 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m17:35:23.788247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m17:35:23.789952 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:35:23.803180 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:35:23.804764 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 17:35:23.790888 => 17:35:23.804233
[0m17:35:23.805668 [debug] [Thread-1 (]: Began executing node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:35:23.814427 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:35:23.816267 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:35:23.816926 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:35:23.817502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:24.290987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:35:24.300463 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 17:35:23.806422 => 17:35:24.299095
[0m17:35:24.303082 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m17:35:24.435620 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.65s]
[0m17:35:24.440251 [debug] [Thread-1 (]: Finished running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:35:24.449684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:24.452317 [debug] [MainThread]: Connection 'test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m17:35:24.454908 [info ] [MainThread]: 
[0m17:35:24.457892 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m17:35:24.464824 [debug] [MainThread]: Command end result
[0m17:35:24.483648 [info ] [MainThread]: 
[0m17:35:24.484534 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:35:24.485306 [info ] [MainThread]: 
[0m17:35:24.486075 [error] [MainThread]:   Database Error in test dim_listings_minimum_nights (tests/dim_listings_minimum_nights.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 7 unexpected '{'.
  syntax error line 7 at position 38 unexpected '}'.
  compiled Code at target/run/dbtdnc/tests/dim_listings_minimum_nights.sql
[0m17:35:24.486860 [info ] [MainThread]: 
[0m17:35:24.487642 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:35:24.489206 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.7532625, "process_user_time": 4.231423, "process_kernel_time": 0.834252, "process_mem_max_rss": "199192", "process_out_blocks": "2896", "command_success": false, "process_in_blocks": "0"}
[0m17:35:24.490688 [debug] [MainThread]: Command `dbt test` failed at 17:35:24.490385 after 5.75 seconds
[0m17:35:24.491584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da67ff72140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da652ac05e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da652e8dc00>]}
[0m17:35:24.492435 [debug] [MainThread]: Flushing usage events
[0m17:35:52.252899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725dd64ae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725dd47be410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725dd47be3b0>]}


============================== 17:35:52.257330 | 4f7426d6-6b03-4d0f-9355-2acfb5e2421a ==============================
[0m17:35:52.257330 [info ] [MainThread]: Running with dbt=1.7.14
[0m17:35:52.258493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:35:52.962357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f7426d6-6b03-4d0f-9355-2acfb5e2421a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725dd47be500>]}
[0m17:35:53.021381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f7426d6-6b03-4d0f-9355-2acfb5e2421a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725dad637430>]}
[0m17:35:53.022537 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:35:53.030097 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m17:35:53.067838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:35:53.068660 [debug] [MainThread]: Partial parsing: updated file: dbtdnc://tests/dim_listings_minimum_nights.sql
[0m17:35:53.226771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f7426d6-6b03-4d0f-9355-2acfb5e2421a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725dad1da4a0>]}
[0m17:35:53.235944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f7426d6-6b03-4d0f-9355-2acfb5e2421a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725dad3717e0>]}
[0m17:35:53.236645 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 5 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:35:53.237186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f7426d6-6b03-4d0f-9355-2acfb5e2421a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725dad3724d0>]}
[0m17:35:53.239222 [info ] [MainThread]: 
[0m17:35:53.240164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:35:53.241777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m17:35:53.258174 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:35:53.259311 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m17:35:53.260400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:53.851028 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:35:53.856108 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:35:53.961297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m17:35:53.985453 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m17:35:53.988400 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m17:35:53.991758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:54.430258 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m17:35:54.437514 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m17:35:54.547966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f7426d6-6b03-4d0f-9355-2acfb5e2421a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725dad3719f0>]}
[0m17:35:54.551907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:54.554382 [info ] [MainThread]: 
[0m17:35:54.562976 [debug] [Thread-1 (]: Began running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:35:54.566077 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m17:35:54.570332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m17:35:54.572450 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:35:54.605656 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m17:35:54.606583 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 17:35:54.574377 => 17:35:54.606240
[0m17:35:54.607142 [debug] [Thread-1 (]: Began executing node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:35:54.631200 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m17:35:54.632570 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m17:35:54.633157 [debug] [Thread-1 (]: On test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m17:35:54.633715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:55.172475 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:35:55.200663 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 17:35:54.607491 => 17:35:55.199234
[0m17:35:55.202600 [debug] [Thread-1 (]: On test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m17:35:55.295340 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.73s]
[0m17:35:55.299325 [debug] [Thread-1 (]: Finished running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:35:55.302215 [debug] [Thread-1 (]: Began running node test.dbtdnc.dim_listings_minimum_nights
[0m17:35:55.305280 [info ] [Thread-1 (]: 2 of 5 START test dim_listings_minimum_nights .................................. [RUN]
[0m17:35:55.309325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtdnc.dim_listings_minimum_nights)
[0m17:35:55.312242 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.dim_listings_minimum_nights
[0m17:35:55.323039 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.dim_listings_minimum_nights"
[0m17:35:55.325778 [debug] [Thread-1 (]: Timing info for test.dbtdnc.dim_listings_minimum_nights (compile): 17:35:55.314674 => 17:35:55.325061
[0m17:35:55.326912 [debug] [Thread-1 (]: Began executing node test.dbtdnc.dim_listings_minimum_nights
[0m17:35:55.334540 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.dim_listings_minimum_nights"
[0m17:35:55.336159 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.dim_listings_minimum_nights"
[0m17:35:55.336983 [debug] [Thread-1 (]: On test.dbtdnc.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from AIRBNB.dev.dim_listings_cleansed
where minimum_nights < 1
limit 10
      
    ) dbt_internal_test
[0m17:35:55.337747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:55.728450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:35:55.737613 [debug] [Thread-1 (]: Timing info for test.dbtdnc.dim_listings_minimum_nights (execute): 17:35:55.327642 => 17:35:55.736326
[0m17:35:55.740223 [debug] [Thread-1 (]: On test.dbtdnc.dim_listings_minimum_nights: Close
[0m17:35:55.839079 [info ] [Thread-1 (]: 2 of 5 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.53s]
[0m17:35:55.842687 [debug] [Thread-1 (]: Finished running node test.dbtdnc.dim_listings_minimum_nights
[0m17:35:55.845368 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:35:55.848478 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m17:35:55.852362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.dim_listings_minimum_nights, now test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m17:35:55.855111 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:35:55.878656 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:35:55.881012 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 17:35:55.856754 => 17:35:55.880082
[0m17:35:55.882527 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:35:55.887370 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:35:55.889576 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:35:55.890314 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m17:35:55.890987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:56.285593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:35:56.294695 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 17:35:55.883138 => 17:35:56.293337
[0m17:35:56.297253 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m17:35:56.422500 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.57s]
[0m17:35:56.426201 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:35:56.429226 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:35:56.432295 [info ] [Thread-1 (]: 4 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m17:35:56.436142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m17:35:56.439398 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:35:56.455959 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:35:56.458701 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 17:35:56.441772 => 17:35:56.457684
[0m17:35:56.460278 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:35:56.465524 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:35:56.467319 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:35:56.468166 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m17:35:56.468956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:56.801304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:35:56.810476 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 17:35:56.460909 => 17:35:56.809106
[0m17:35:56.813117 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m17:35:56.904119 [info ] [Thread-1 (]: 4 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.47s]
[0m17:35:56.907715 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:35:56.910439 [debug] [Thread-1 (]: Began running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:35:56.913586 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m17:35:56.917414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m17:35:56.920535 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:35:56.944179 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:35:56.945582 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 17:35:56.922909 => 17:35:56.945081
[0m17:35:56.946506 [debug] [Thread-1 (]: Began executing node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:35:56.951077 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:35:56.952540 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:35:56.953274 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:35:56.953956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:57.316249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:35:57.326377 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 17:35:56.947098 => 17:35:57.324986
[0m17:35:57.329347 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m17:35:57.441386 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.52s]
[0m17:35:57.445118 [debug] [Thread-1 (]: Finished running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:35:57.452142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:57.454485 [debug] [MainThread]: Connection 'test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m17:35:57.457040 [info ] [MainThread]: 
[0m17:35:57.460090 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m17:35:57.466708 [debug] [MainThread]: Command end result
[0m17:35:57.496322 [info ] [MainThread]: 
[0m17:35:57.497901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:35:57.499140 [info ] [MainThread]: 
[0m17:35:57.500394 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:35:57.502621 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.298392, "process_user_time": 4.111276, "process_kernel_time": 0.697914, "process_mem_max_rss": "198368", "process_out_blocks": "2904", "process_in_blocks": "0"}
[0m17:35:57.504572 [debug] [MainThread]: Command `dbt test` succeeded at 17:35:57.504054 after 5.30 seconds
[0m17:35:57.505919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725dd64ae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725dac6933d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725dac6c6230>]}
[0m17:35:57.507076 [debug] [MainThread]: Flushing usage events
[0m17:36:11.710907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fd0d7e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fcf0be4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fcf0be440>]}


============================== 17:36:11.713317 | bffd0419-1462-4f0d-b71a-bcea021c6464 ==============================
[0m17:36:11.713317 [info ] [MainThread]: Running with dbt=1.7.14
[0m17:36:11.714126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:36:12.333167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bffd0419-1462-4f0d-b71a-bcea021c6464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fcf0be590>]}
[0m17:36:12.395502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bffd0419-1462-4f0d-b71a-bcea021c6464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fa3ed27d0>]}
[0m17:36:12.396324 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:36:12.403111 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m17:36:12.439636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:36:12.440438 [debug] [MainThread]: Partial parsing: updated file: dbtdnc://tests/dim_listings_minimum_nights.sql
[0m17:36:12.589073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bffd0419-1462-4f0d-b71a-bcea021c6464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fa3a6e530>]}
[0m17:36:12.598364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bffd0419-1462-4f0d-b71a-bcea021c6464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fa3c098d0>]}
[0m17:36:12.599125 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 5 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:36:12.599689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bffd0419-1462-4f0d-b71a-bcea021c6464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fa3c0a5c0>]}
[0m17:36:12.601603 [info ] [MainThread]: 
[0m17:36:12.602535 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:36:12.604180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m17:36:12.618569 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:36:12.619361 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m17:36:12.619852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:13.233092 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:36:13.240195 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:36:13.344139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m17:36:13.365125 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m17:36:13.367528 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m17:36:13.370373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:13.955278 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:36:13.962397 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m17:36:14.052994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bffd0419-1462-4f0d-b71a-bcea021c6464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fa3c09ae0>]}
[0m17:36:14.053922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:36:14.054520 [info ] [MainThread]: 
[0m17:36:14.056554 [debug] [Thread-1 (]: Began running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:36:14.057264 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m17:36:14.058152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m17:36:14.058818 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:36:14.077452 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m17:36:14.078469 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 17:36:14.059173 => 17:36:14.078103
[0m17:36:14.079078 [debug] [Thread-1 (]: Began executing node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:36:14.100066 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m17:36:14.101273 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m17:36:14.101864 [debug] [Thread-1 (]: On test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m17:36:14.102488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:14.434331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:36:14.463279 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 17:36:14.079445 => 17:36:14.462097
[0m17:36:14.465337 [debug] [Thread-1 (]: On test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m17:36:14.572115 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.51s]
[0m17:36:14.576341 [debug] [Thread-1 (]: Finished running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m17:36:14.579352 [debug] [Thread-1 (]: Began running node test.dbtdnc.dim_listings_minimum_nights
[0m17:36:14.582947 [info ] [Thread-1 (]: 2 of 5 START test dim_listings_minimum_nights .................................. [RUN]
[0m17:36:14.587759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtdnc.dim_listings_minimum_nights)
[0m17:36:14.590398 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.dim_listings_minimum_nights
[0m17:36:14.604490 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.dim_listings_minimum_nights"
[0m17:36:14.607350 [debug] [Thread-1 (]: Timing info for test.dbtdnc.dim_listings_minimum_nights (compile): 17:36:14.592302 => 17:36:14.606392
[0m17:36:14.609236 [debug] [Thread-1 (]: Began executing node test.dbtdnc.dim_listings_minimum_nights
[0m17:36:14.616761 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.dim_listings_minimum_nights"
[0m17:36:14.619485 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.dim_listings_minimum_nights"
[0m17:36:14.621431 [debug] [Thread-1 (]: On test.dbtdnc.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from AIRBNB.dev.dim_listings_cleansed
where minimum_nights < 2
limit 10
      
    ) dbt_internal_test
[0m17:36:14.623227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:15.014715 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:36:15.024141 [debug] [Thread-1 (]: Timing info for test.dbtdnc.dim_listings_minimum_nights (execute): 17:36:14.610348 => 17:36:15.022806
[0m17:36:15.026710 [debug] [Thread-1 (]: On test.dbtdnc.dim_listings_minimum_nights: Close
[0m17:36:15.139100 [error] [Thread-1 (]: 2 of 5 FAIL 10 dim_listings_minimum_nights ..................................... [[31mFAIL 10[0m in 0.55s]
[0m17:36:15.142671 [debug] [Thread-1 (]: Finished running node test.dbtdnc.dim_listings_minimum_nights
[0m17:36:15.145531 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:36:15.148719 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m17:36:15.152533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.dim_listings_minimum_nights, now test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m17:36:15.155423 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:36:15.174866 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:36:15.176398 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 17:36:15.157346 => 17:36:15.175874
[0m17:36:15.178238 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:36:15.184873 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:36:15.186502 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m17:36:15.187267 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m17:36:15.187953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:15.572423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:36:15.584071 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 17:36:15.179215 => 17:36:15.581871
[0m17:36:15.587875 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m17:36:15.694001 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.54s]
[0m17:36:15.697999 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m17:36:15.701056 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:36:15.704463 [info ] [Thread-1 (]: 4 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m17:36:15.708482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m17:36:15.711316 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:36:15.724239 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:36:15.726513 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 17:36:15.712681 => 17:36:15.725702
[0m17:36:15.728039 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:36:15.734138 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:36:15.736343 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m17:36:15.737493 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m17:36:15.738610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:16.108874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:36:16.112212 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 17:36:15.729075 => 17:36:16.111688
[0m17:36:16.113161 [debug] [Thread-1 (]: On test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m17:36:16.221492 [info ] [Thread-1 (]: 4 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.51s]
[0m17:36:16.225861 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m17:36:16.229019 [debug] [Thread-1 (]: Began running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:36:16.232044 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m17:36:16.236111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m17:36:16.239398 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:36:16.257932 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:36:16.259409 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 17:36:16.241092 => 17:36:16.258900
[0m17:36:16.260360 [debug] [Thread-1 (]: Began executing node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:36:16.265754 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:36:16.267121 [debug] [Thread-1 (]: Using snowflake connection "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m17:36:16.267878 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "node_id": "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:36:16.268596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:16.660117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:36:16.662593 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 17:36:16.260883 => 17:36:16.662224
[0m17:36:16.663307 [debug] [Thread-1 (]: On test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m17:36:16.749291 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.51s]
[0m17:36:16.753449 [debug] [Thread-1 (]: Finished running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m17:36:16.760535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:16.762880 [debug] [MainThread]: Connection 'test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m17:36:16.765466 [info ] [MainThread]: 
[0m17:36:16.768550 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 4.16 seconds (4.16s).
[0m17:36:16.775612 [debug] [MainThread]: Command end result
[0m17:36:16.798194 [info ] [MainThread]: 
[0m17:36:16.799300 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:36:16.800294 [info ] [MainThread]: 
[0m17:36:16.801246 [error] [MainThread]: [31mFailure in test dim_listings_minimum_nights (tests/dim_listings_minimum_nights.sql)[0m
[0m17:36:16.802185 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m17:36:16.802985 [info ] [MainThread]: 
[0m17:36:16.803925 [info ] [MainThread]:   compiled Code at target/compiled/dbtdnc/tests/dim_listings_minimum_nights.sql
[0m17:36:16.805185 [info ] [MainThread]: 
[0m17:36:16.806219 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:36:16.807542 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.1371565, "process_user_time": 3.987169, "process_kernel_time": 0.77171, "process_mem_max_rss": "198400", "process_out_blocks": "2896", "command_success": false, "process_in_blocks": "0"}
[0m17:36:16.808535 [debug] [MainThread]: Command `dbt test` failed at 17:36:16.808276 after 5.14 seconds
[0m17:36:16.809272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fd0d7e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fcf0be590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fa3ed27d0>]}
[0m17:36:16.809997 [debug] [MainThread]: Flushing usage events
[0m14:05:01.316250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6bab89e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6ba9daa4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6ba9daa440>]}


============================== 14:05:01.321386 | df6ee9f0-e02f-43cf-af8b-39fc4afbdbcd ==============================
[0m14:05:01.321386 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:05:01.322229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:01.945862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df6ee9f0-e02f-43cf-af8b-39fc4afbdbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6ba9daa590>]}
[0m14:05:02.003688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df6ee9f0-e02f-43cf-af8b-39fc4afbdbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b7eab27d0>]}
[0m14:05:02.007208 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:05:02.014642 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:05:02.053859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:02.054946 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:02.064474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df6ee9f0-e02f-43cf-af8b-39fc4afbdbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b7e583df0>]}
[0m14:05:02.067296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df6ee9f0-e02f-43cf-af8b-39fc4afbdbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b7e735a20>]}
[0m14:05:02.067891 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 5 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:05:02.068391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df6ee9f0-e02f-43cf-af8b-39fc4afbdbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b7e7365c0>]}
[0m14:05:02.070509 [info ] [MainThread]: 
[0m14:05:02.071355 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:05:02.072642 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m14:05:02.088825 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:05:02.089401 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:05:02.090166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:03.089982 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:05:03.099879 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:05:03.286952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m14:05:03.293914 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:05:03.294854 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:05:03.295732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:03.919101 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:05:03.926044 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:05:04.039263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df6ee9f0-e02f-43cf-af8b-39fc4afbdbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b7e736830>]}
[0m14:05:04.043068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:04.045350 [info ] [MainThread]: 
[0m14:05:04.053532 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_hosts
[0m14:05:04.056989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtdnc.src_hosts)
[0m14:05:04.059382 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_hosts
[0m14:05:04.089346 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_hosts"
[0m14:05:04.091259 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_hosts (compile): 14:05:04.060887 => 14:05:04.090644
[0m14:05:04.093899 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_hosts
[0m14:05:04.095338 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_listings
[0m14:05:04.097458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_hosts, now model.dbtdnc.src_listings)
[0m14:05:04.098380 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_listings
[0m14:05:04.102556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_listings"
[0m14:05:04.103589 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_listings (compile): 14:05:04.098930 => 14:05:04.103203
[0m14:05:04.104874 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_listings
[0m14:05:04.105567 [debug] [Thread-1 (]: Began running node model.dbtdnc.src_reviews
[0m14:05:04.106562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_listings, now model.dbtdnc.src_reviews)
[0m14:05:04.107327 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.src_reviews
[0m14:05:04.110686 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.src_reviews"
[0m14:05:04.111567 [debug] [Thread-1 (]: Timing info for model.dbtdnc.src_reviews (compile): 14:05:04.107742 => 14:05:04.111253
[0m14:05:04.112628 [debug] [Thread-1 (]: Finished running node model.dbtdnc.src_reviews
[0m14:05:04.113257 [debug] [Thread-1 (]: Began running node seed.dbtdnc.seed_full_moon_dates
[0m14:05:04.114059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.src_reviews, now seed.dbtdnc.seed_full_moon_dates)
[0m14:05:04.114634 [debug] [Thread-1 (]: Began compiling node seed.dbtdnc.seed_full_moon_dates
[0m14:05:04.116713 [debug] [Thread-1 (]: Timing info for seed.dbtdnc.seed_full_moon_dates (compile): 14:05:04.114985 => 14:05:04.116431
[0m14:05:04.117236 [debug] [Thread-1 (]: Began executing node seed.dbtdnc.seed_full_moon_dates
[0m14:05:04.117886 [debug] [Thread-1 (]: Timing info for seed.dbtdnc.seed_full_moon_dates (execute): 14:05:04.117616 => 14:05:04.117623
[0m14:05:04.118838 [debug] [Thread-1 (]: Finished running node seed.dbtdnc.seed_full_moon_dates
[0m14:05:04.119395 [debug] [Thread-1 (]: Began running node snapshot.dbtdnc.scd_raw_listings
[0m14:05:04.120115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtdnc.seed_full_moon_dates, now snapshot.dbtdnc.scd_raw_listings)
[0m14:05:04.120625 [debug] [Thread-1 (]: Began compiling node snapshot.dbtdnc.scd_raw_listings
[0m14:05:04.123894 [debug] [Thread-1 (]: Timing info for snapshot.dbtdnc.scd_raw_listings (compile): 14:05:04.120947 => 14:05:04.123622
[0m14:05:04.124526 [debug] [Thread-1 (]: Began executing node snapshot.dbtdnc.scd_raw_listings
[0m14:05:04.125118 [debug] [Thread-1 (]: Timing info for snapshot.dbtdnc.scd_raw_listings (execute): 14:05:04.124857 => 14:05:04.124863
[0m14:05:04.126145 [debug] [Thread-1 (]: Finished running node snapshot.dbtdnc.scd_raw_listings
[0m14:05:04.126781 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_hosts_cleansed
[0m14:05:04.127497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtdnc.scd_raw_listings, now model.dbtdnc.dim_hosts_cleansed)
[0m14:05:04.128008 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_hosts_cleansed
[0m14:05:04.133594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_hosts_cleansed"
[0m14:05:04.134363 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (compile): 14:05:04.128333 => 14:05:04.134089
[0m14:05:04.134909 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_hosts_cleansed
[0m14:05:04.135489 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_hosts_cleansed (execute): 14:05:04.135231 => 14:05:04.135239
[0m14:05:04.136436 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_hosts_cleansed
[0m14:05:04.136983 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_cleansed
[0m14:05:04.137744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_hosts_cleansed, now model.dbtdnc.dim_listings_cleansed)
[0m14:05:04.138250 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_cleansed
[0m14:05:04.144381 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_cleansed"
[0m14:05:04.145133 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (compile): 14:05:04.138574 => 14:05:04.144858
[0m14:05:04.145707 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_cleansed
[0m14:05:04.146305 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_cleansed (execute): 14:05:04.146038 => 14:05:04.146047
[0m14:05:04.147289 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_cleansed
[0m14:05:04.147861 [debug] [Thread-1 (]: Began running node model.dbtdnc.fct_reviews
[0m14:05:04.148938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_cleansed, now model.dbtdnc.fct_reviews)
[0m14:05:04.149522 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.fct_reviews
[0m14:05:04.159388 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.fct_reviews"
[0m14:05:04.160190 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (compile): 14:05:04.149862 => 14:05:04.159902
[0m14:05:04.160724 [debug] [Thread-1 (]: Began executing node model.dbtdnc.fct_reviews
[0m14:05:04.161334 [debug] [Thread-1 (]: Timing info for model.dbtdnc.fct_reviews (execute): 14:05:04.161061 => 14:05:04.161070
[0m14:05:04.162371 [debug] [Thread-1 (]: Finished running node model.dbtdnc.fct_reviews
[0m14:05:04.162950 [debug] [Thread-1 (]: Began running node model.dbtdnc.dim_listings_w_hosts
[0m14:05:04.163829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.fct_reviews, now model.dbtdnc.dim_listings_w_hosts)
[0m14:05:04.164357 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.dim_listings_w_hosts
[0m14:05:04.167560 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.dim_listings_w_hosts"
[0m14:05:04.168305 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (compile): 14:05:04.164692 => 14:05:04.168030
[0m14:05:04.168816 [debug] [Thread-1 (]: Began executing node model.dbtdnc.dim_listings_w_hosts
[0m14:05:04.169415 [debug] [Thread-1 (]: Timing info for model.dbtdnc.dim_listings_w_hosts (execute): 14:05:04.169144 => 14:05:04.169152
[0m14:05:04.170421 [debug] [Thread-1 (]: Finished running node model.dbtdnc.dim_listings_w_hosts
[0m14:05:04.171105 [debug] [Thread-1 (]: Began running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:05:04.171915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtdnc.dim_listings_w_hosts, now test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m14:05:04.172452 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:05:04.184747 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:05:04.185575 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 14:05:04.172790 => 14:05:04.185237
[0m14:05:04.186116 [debug] [Thread-1 (]: Began executing node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:05:04.186739 [debug] [Thread-1 (]: Timing info for test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 14:05:04.186457 => 14:05:04.186465
[0m14:05:04.187716 [debug] [Thread-1 (]: Finished running node test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:05:04.188310 [debug] [Thread-1 (]: Began running node test.dbtdnc.dim_listings_minimum_nights
[0m14:05:04.189092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtdnc.dim_listings_minimum_nights)
[0m14:05:04.189633 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.dim_listings_minimum_nights
[0m14:05:04.192321 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.dim_listings_minimum_nights"
[0m14:05:04.193040 [debug] [Thread-1 (]: Timing info for test.dbtdnc.dim_listings_minimum_nights (compile): 14:05:04.189967 => 14:05:04.192764
[0m14:05:04.193601 [debug] [Thread-1 (]: Began executing node test.dbtdnc.dim_listings_minimum_nights
[0m14:05:04.194212 [debug] [Thread-1 (]: Timing info for test.dbtdnc.dim_listings_minimum_nights (execute): 14:05:04.193946 => 14:05:04.193953
[0m14:05:04.195592 [debug] [Thread-1 (]: Finished running node test.dbtdnc.dim_listings_minimum_nights
[0m14:05:04.196632 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:05:04.197794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.dim_listings_minimum_nights, now test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m14:05:04.198322 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:05:04.207299 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:05:04.208067 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 14:05:04.198681 => 14:05:04.207785
[0m14:05:04.208583 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:05:04.209179 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 14:05:04.208913 => 14:05:04.208920
[0m14:05:04.210206 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:05:04.210774 [debug] [Thread-1 (]: Began running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:05:04.211628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m14:05:04.212184 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:05:04.216547 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:05:04.217547 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 14:05:04.212533 => 14:05:04.217050
[0m14:05:04.218120 [debug] [Thread-1 (]: Began executing node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:05:04.218767 [debug] [Thread-1 (]: Timing info for test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 14:05:04.218466 => 14:05:04.218476
[0m14:05:04.219760 [debug] [Thread-1 (]: Finished running node test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:05:04.220351 [debug] [Thread-1 (]: Began running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:05:04.221108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m14:05:04.221773 [debug] [Thread-1 (]: Began compiling node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:05:04.228258 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:05:04.229239 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 14:05:04.222119 => 14:05:04.228815
[0m14:05:04.229860 [debug] [Thread-1 (]: Began executing node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:05:04.230505 [debug] [Thread-1 (]: Timing info for test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 14:05:04.230205 => 14:05:04.230217
[0m14:05:04.231513 [debug] [Thread-1 (]: Finished running node test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:05:04.232236 [debug] [Thread-1 (]: Began running node model.dbtdnc.mart_fullmoon_reviews
[0m14:05:04.233050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtdnc.unique_dim_listings_cleansed_listing_id.930e4e859e, now model.dbtdnc.mart_fullmoon_reviews)
[0m14:05:04.233665 [debug] [Thread-1 (]: Began compiling node model.dbtdnc.mart_fullmoon_reviews
[0m14:05:04.236845 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdnc.mart_fullmoon_reviews"
[0m14:05:04.238016 [debug] [Thread-1 (]: Timing info for model.dbtdnc.mart_fullmoon_reviews (compile): 14:05:04.234006 => 14:05:04.237633
[0m14:05:04.238578 [debug] [Thread-1 (]: Began executing node model.dbtdnc.mart_fullmoon_reviews
[0m14:05:04.239317 [debug] [Thread-1 (]: Timing info for model.dbtdnc.mart_fullmoon_reviews (execute): 14:05:04.239018 => 14:05:04.239029
[0m14:05:04.240328 [debug] [Thread-1 (]: Finished running node model.dbtdnc.mart_fullmoon_reviews
[0m14:05:04.241651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:04.242783 [debug] [MainThread]: Connection 'model.dbtdnc.mart_fullmoon_reviews' was properly closed.
[0m14:05:04.247693 [debug] [MainThread]: Command end result
[0m14:05:04.267311 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m14:05:04.268202 [info ] [MainThread]: Building catalog
[0m14:05:04.272062 [debug] [ThreadPool]: Acquiring new snowflake connection 'AIRBNB.information_schema'
[0m14:05:04.288451 [debug] [ThreadPool]: Using snowflake connection "AIRBNB.information_schema"
[0m14:05:04.289240 [debug] [ThreadPool]: On AIRBNB.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtdnc", "target_name": "dev", "connection_name": "AIRBNB.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from AIRBNB.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('mart_fullmoon_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('dim_listings_w_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('dim_hosts_cleansed')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('scd_raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('fct_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('dim_listings_cleansed')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('seed_full_moon_dates')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from AIRBNB.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('mart_fullmoon_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('dim_listings_w_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('dim_hosts_cleansed')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('scd_raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('fct_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('dim_listings_cleansed')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('seed_full_moon_dates')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m14:05:04.290486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:08.902579 [debug] [ThreadPool]: SQL status: SUCCESS 67 in 5.0 seconds
[0m14:05:08.943980 [debug] [ThreadPool]: On AIRBNB.information_schema: Close
[0m14:05:09.060663 [info ] [MainThread]: Catalog written to /home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/target/catalog.json
[0m14:05:09.062387 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 7.7875896, "process_user_time": 3.552031, "process_kernel_time": 0.802927, "process_mem_max_rss": "196432", "process_in_blocks": "6552", "process_out_blocks": "5032"}
[0m14:05:09.063636 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:05:09.063338 after 7.79 seconds
[0m14:05:09.064409 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:05:09.065102 [debug] [MainThread]: Connection 'AIRBNB.information_schema' was properly closed.
[0m14:05:09.065801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6bab89e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b7eab27d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b7dbdf4f0>]}
[0m14:05:09.066589 [debug] [MainThread]: Flushing usage events
[0m14:05:34.997161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6dc5daa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6dc40b6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6dc40b6320>]}


============================== 14:05:34.999605 | fd218a99-de21-4cbf-b0d8-5aba8f7bbe8d ==============================
[0m14:05:34.999605 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:05:35.000368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtdnc/dbtdnc/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:35.621259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd218a99-de21-4cbf-b0d8-5aba8f7bbe8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6dc40b6470>]}
[0m14:05:35.678832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd218a99-de21-4cbf-b0d8-5aba8f7bbe8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6dc40b5c90>]}
[0m14:07:58.914324 [error] [MainThread]: Encountered an error:

[0m14:07:58.919062 [error] [MainThread]: Traceback (most recent call last):
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m14:07:58.920468 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 143.96466, "process_user_time": 2.870872, "process_kernel_time": 0.836332, "process_mem_max_rss": "183416", "process_in_blocks": "608", "process_out_blocks": "2968", "command_success": false}
[0m14:07:58.921959 [debug] [MainThread]: Command `dbt docs serve` failed at 14:07:58.921527 after 143.97 seconds
[0m14:07:58.922863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6dc5daa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6d9cd0e080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6d9cd0f010>]}
[0m14:07:58.923755 [debug] [MainThread]: Flushing usage events
