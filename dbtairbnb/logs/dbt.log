[0m11:36:38.008958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777deed769b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777ded27e2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777ded27e260>]}


============================== 11:36:38.011402 | 09bc166e-7c68-470f-856a-21f9799ac71c ==============================
[0m11:36:38.011402 [info ] [MainThread]: Running with dbt=1.7.14
[0m11:36:38.012095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:36:38.012693 [info ] [MainThread]: dbt version: 1.7.14
[0m11:36:38.013218 [info ] [MainThread]: python version: 3.10.12
[0m11:36:38.013769 [info ] [MainThread]: python path: /home/lkeiti/Documents/dnc-data-engineer/.env/bin/python3
[0m11:36:38.014416 [info ] [MainThread]: os info: Linux-6.5.0-35-generic-x86_64-with-glibc2.35
[0m11:36:38.560298 [info ] [MainThread]: Using profiles dir at /home/lkeiti/.dbt
[0m11:36:38.560893 [info ] [MainThread]: Using profiles.yml file at /home/lkeiti/.dbt/profiles.yml
[0m11:36:38.561381 [info ] [MainThread]: Using dbt_project.yml file at /home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/dbt_project.yml
[0m11:36:38.564789 [info ] [MainThread]: adapter type: snowflake
[0m11:36:38.565289 [info ] [MainThread]: adapter version: 1.7.1
[0m11:36:38.655499 [info ] [MainThread]: Configuration:
[0m11:36:38.656092 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:36:38.656624 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:36:38.657145 [info ] [MainThread]: Required dependencies:
[0m11:36:38.657688 [debug] [MainThread]: Executing "git --help"
[0m11:36:38.659725 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:36:38.660286 [debug] [MainThread]: STDERR: "b''"
[0m11:36:38.660763 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:36:38.661277 [info ] [MainThread]: Connection:
[0m11:36:38.661889 [info ] [MainThread]:   account: kxjeitm-yy20508
[0m11:36:38.662433 [info ] [MainThread]:   user: dbt
[0m11:36:38.662964 [info ] [MainThread]:   database: AIRBNB
[0m11:36:38.663438 [info ] [MainThread]:   warehouse: COMPUTE_DW
[0m11:36:38.663909 [info ] [MainThread]:   role: transform
[0m11:36:38.664378 [info ] [MainThread]:   schema: dev
[0m11:36:38.664848 [info ] [MainThread]:   authenticator: None
[0m11:36:38.665322 [info ] [MainThread]:   private_key_path: None
[0m11:36:38.665861 [info ] [MainThread]:   token: None
[0m11:36:38.666350 [info ] [MainThread]:   oauth_client_id: None
[0m11:36:38.666821 [info ] [MainThread]:   query_tag: None
[0m11:36:38.667456 [info ] [MainThread]:   client_session_keep_alive: False
[0m11:36:38.668363 [info ] [MainThread]:   host: None
[0m11:36:38.669123 [info ] [MainThread]:   port: None
[0m11:36:38.669743 [info ] [MainThread]:   proxy_host: None
[0m11:36:38.670258 [info ] [MainThread]:   proxy_port: None
[0m11:36:38.670960 [info ] [MainThread]:   protocol: None
[0m11:36:38.671535 [info ] [MainThread]:   connect_retries: 1
[0m11:36:38.672012 [info ] [MainThread]:   connect_timeout: None
[0m11:36:38.672487 [info ] [MainThread]:   retry_on_database_errors: False
[0m11:36:38.672997 [info ] [MainThread]:   retry_all: False
[0m11:36:38.673507 [info ] [MainThread]:   insecure_mode: False
[0m11:36:38.673998 [info ] [MainThread]:   reuse_connections: None
[0m11:36:38.674548 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:36:38.675241 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:36:38.676060 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:36:38.676549 [debug] [MainThread]: On debug: select 1 as id
[0m11:36:38.677134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:40.194701 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:36:40.199090 [debug] [MainThread]: On debug: Close
[0m11:36:40.318893 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:36:40.321447 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:36:40.326849 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.3597374, "process_user_time": 3.015068, "process_kernel_time": 0.805613, "process_mem_max_rss": "188480", "process_in_blocks": "4176", "process_out_blocks": "1096"}
[0m11:36:40.330315 [debug] [MainThread]: Command `dbt debug` succeeded at 11:36:40.329429 after 2.36 seconds
[0m11:36:40.332560 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:36:40.334891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777deed769b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777dc1e4b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777dc2383760>]}
[0m11:36:40.337307 [debug] [MainThread]: Flushing usage events
[0m11:45:44.609215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766a50dae9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766a4f0ba440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766a4f0ba3e0>]}


============================== 11:45:44.611596 | c9dccbfc-71e8-43c5-8a5f-1831611965aa ==============================
[0m11:45:44.611596 [info ] [MainThread]: Running with dbt=1.7.14
[0m11:45:44.612364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/lkeiti/.dbt', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:45:45.229193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9dccbfc-71e8-43c5-8a5f-1831611965aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766a4f0ba530>]}
[0m11:45:45.290437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9dccbfc-71e8-43c5-8a5f-1831611965aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766a23ed3580>]}
[0m11:45:45.291264 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:45:45.298468 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m11:45:45.329841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:45:45.330385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:45:45.335341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9dccbfc-71e8-43c5-8a5f-1831611965aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766a23b2c0d0>]}
[0m11:45:45.343031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9dccbfc-71e8-43c5-8a5f-1831611965aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766a23b00610>]}
[0m11:45:45.343668 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m11:45:45.344190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9dccbfc-71e8-43c5-8a5f-1831611965aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766a23b01300>]}
[0m11:45:45.345653 [info ] [MainThread]: 
[0m11:45:45.346487 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:45:45.347703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m11:45:45.361537 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m11:45:45.362170 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m11:45:45.362670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:46.501729 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:45:46.508204 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m11:45:46.661520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_dev)
[0m11:45:46.665604 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m11:45:46.684174 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_dev"
[0m11:45:46.685480 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */
create schema if not exists AIRBNB.dev
[0m11:45:46.686706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:47.651839 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:45:47.652984 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m11:45:47.780804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_dev, now list_AIRBNB_dev)
[0m11:45:47.816455 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m11:45:47.817851 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m11:45:47.819040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:48.391524 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m11:45:48.395844 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m11:45:48.476721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9dccbfc-71e8-43c5-8a5f-1831611965aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766a2314e1d0>]}
[0m11:45:48.480642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:45:48.483033 [info ] [MainThread]: 
[0m11:45:48.490638 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m11:45:48.493480 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_hosts ...................................... [RUN]
[0m11:45:48.497055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m11:45:48.499085 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m11:45:48.514381 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m11:45:48.515983 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 11:45:48.500568 => 11:45:48.515369
[0m11:45:48.516955 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m11:45:48.545876 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m11:45:48.547028 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m11:45:48.547584 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m11:45:48.548115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:49.189247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:45:49.237968 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 11:45:48.517556 => 11:45:49.237576
[0m11:45:49.238700 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m11:45:49.307241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9dccbfc-71e8-43c5-8a5f-1831611965aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766a217cc580>]}
[0m11:45:49.310743 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.81s]
[0m11:45:49.315129 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m11:45:49.322392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:49.324912 [debug] [MainThread]: Connection 'model.dbtairbnb.src_hosts' was properly closed.
[0m11:45:49.326917 [info ] [MainThread]: 
[0m11:45:49.328599 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.98 seconds (3.98s).
[0m11:45:49.331619 [debug] [MainThread]: Command end result
[0m11:45:49.345645 [info ] [MainThread]: 
[0m11:45:49.346558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:49.347262 [info ] [MainThread]: 
[0m11:45:49.347987 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:45:49.349466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7808485, "process_user_time": 3.559589, "process_kernel_time": 0.802104, "process_mem_max_rss": "195100", "process_in_blocks": "8", "process_out_blocks": "1736"}
[0m11:45:49.350913 [debug] [MainThread]: Command `dbt run` succeeded at 11:45:49.350618 after 4.78 seconds
[0m11:45:49.351580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766a50dae9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766a23ed3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766a217cd060>]}
[0m11:45:49.352355 [debug] [MainThread]: Flushing usage events
[0m11:50:37.698013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74624649e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462449a63e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462449a6380>]}


============================== 11:50:37.700415 | 85d6daa2-85d6-4f42-948b-b59fba36af25 ==============================
[0m11:50:37.700415 [info ] [MainThread]: Running with dbt=1.7.14
[0m11:50:37.701286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:50:38.339205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85d6daa2-85d6-4f42-948b-b59fba36af25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462449a64d0>]}
[0m11:50:38.398884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85d6daa2-85d6-4f42-948b-b59fba36af25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74621d6bca90>]}
[0m11:50:38.399724 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:50:38.406560 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m11:50:38.436056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:50:38.436783 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:50:38.443329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85d6daa2-85d6-4f42-948b-b59fba36af25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74621d3280d0>]}
[0m11:50:38.452448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85d6daa2-85d6-4f42-948b-b59fba36af25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74621d2f8f70>]}
[0m11:50:38.453105 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m11:50:38.453903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85d6daa2-85d6-4f42-948b-b59fba36af25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74621d2f9c60>]}
[0m11:50:38.455480 [info ] [MainThread]: 
[0m11:50:38.456555 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:50:38.458069 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m11:50:38.471893 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m11:50:38.472495 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m11:50:38.472996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:39.367364 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:50:39.369519 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m11:50:39.485408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m11:50:39.497623 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m11:50:39.498560 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m11:50:39.499252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:40.268156 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:50:40.271212 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m11:50:40.356773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85d6daa2-85d6-4f42-948b-b59fba36af25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74621d36d510>]}
[0m11:50:40.358999 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:50:40.360374 [info ] [MainThread]: 
[0m11:50:40.365337 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m11:50:40.366873 [info ] [Thread-1 (]: 1 of 3 START sql view model dev.src_hosts ...................................... [RUN]
[0m11:50:40.368217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m11:50:40.369105 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m11:50:40.381448 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m11:50:40.383026 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 11:50:40.369697 => 11:50:40.382491
[0m11:50:40.384033 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m11:50:40.416753 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m11:50:40.417952 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m11:50:40.418514 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m11:50:40.419057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:41.351027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:50:41.405620 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 11:50:40.384631 => 11:50:41.405246
[0m11:50:41.406373 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m11:50:41.520375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85d6daa2-85d6-4f42-948b-b59fba36af25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74621d24d1e0>]}
[0m11:50:41.523892 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.15s]
[0m11:50:41.527373 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m11:50:41.530123 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m11:50:41.533990 [info ] [Thread-1 (]: 2 of 3 START sql view model dev.src_listings ................................... [RUN]
[0m11:50:41.540091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m11:50:41.544423 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m11:50:41.553391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m11:50:41.555934 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 11:50:41.546382 => 11:50:41.555047
[0m11:50:41.557732 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m11:50:41.567848 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m11:50:41.569403 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m11:50:41.570129 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m11:50:41.570810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:42.579545 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:50:42.593662 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 11:50:41.558872 => 11:50:42.591391
[0m11:50:42.596309 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m11:50:42.737336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85d6daa2-85d6-4f42-948b-b59fba36af25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74620ef3d210>]}
[0m11:50:42.738778 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.20s]
[0m11:50:42.740005 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m11:50:42.740862 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m11:50:42.741862 [info ] [Thread-1 (]: 3 of 3 START sql view model dev.src_reviews .................................... [RUN]
[0m11:50:42.743510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m11:50:42.744732 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m11:50:42.748065 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m11:50:42.749253 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 11:50:42.745250 => 11:50:42.748890
[0m11:50:42.749950 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m11:50:42.755062 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m11:50:42.756995 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m11:50:42.757936 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m11:50:42.758585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:43.501178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:50:43.514398 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 11:50:42.750364 => 11:50:43.513113
[0m11:50:43.516955 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m11:50:43.642976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85d6daa2-85d6-4f42-948b-b59fba36af25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74621c96fc70>]}
[0m11:50:43.643884 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.90s]
[0m11:50:43.644754 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m11:50:43.646523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:43.647065 [debug] [MainThread]: Connection 'model.dbtairbnb.src_reviews' was properly closed.
[0m11:50:43.647615 [info ] [MainThread]: 
[0m11:50:43.648199 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.19 seconds (5.19s).
[0m11:50:43.649412 [debug] [MainThread]: Command end result
[0m11:50:43.658025 [info ] [MainThread]: 
[0m11:50:43.658698 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:43.659389 [info ] [MainThread]: 
[0m11:50:43.660351 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:50:43.661730 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0058446, "process_user_time": 3.501616, "process_kernel_time": 0.886334, "process_mem_max_rss": "195368", "process_out_blocks": "1784", "process_in_blocks": "0"}
[0m11:50:43.662508 [debug] [MainThread]: Command `dbt run` succeeded at 11:50:43.662300 after 6.01 seconds
[0m11:50:43.663092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74624649e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74621d641870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74621c8836d0>]}
[0m11:50:43.663681 [debug] [MainThread]: Flushing usage events
[0m11:57:38.452636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59ea0b29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59e83da410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59e83da3b0>]}


============================== 11:57:38.455132 | 208564dc-fb0e-4e60-9f8c-123ac14e373b ==============================
[0m11:57:38.455132 [info ] [MainThread]: Running with dbt=1.7.14
[0m11:57:38.455761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:57:39.088954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '208564dc-fb0e-4e60-9f8c-123ac14e373b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59e83da500>]}
[0m11:57:39.147340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '208564dc-fb0e-4e60-9f8c-123ac14e373b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59c0fa5ff0>]}
[0m11:57:39.148171 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:57:39.154880 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m11:57:39.182233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:57:39.183043 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:57:39.188869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '208564dc-fb0e-4e60-9f8c-123ac14e373b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59c0c981c0>]}
[0m11:57:39.197246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '208564dc-fb0e-4e60-9f8c-123ac14e373b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59c0e613c0>]}
[0m11:57:39.197976 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m11:57:39.198514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '208564dc-fb0e-4e60-9f8c-123ac14e373b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59c0e620b0>]}
[0m11:57:39.200378 [info ] [MainThread]: 
[0m11:57:39.201259 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:57:39.202706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m11:57:39.215528 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m11:57:39.216165 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m11:57:39.216690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:40.177811 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:57:40.187955 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m11:57:40.328540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m11:57:40.361516 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m11:57:40.362840 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m11:57:40.363995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:40.981562 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:57:40.988337 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m11:57:41.095954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '208564dc-fb0e-4e60-9f8c-123ac14e373b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59c0cca260>]}
[0m11:57:41.099835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:57:41.102290 [info ] [MainThread]: 
[0m11:57:41.110161 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m11:57:41.113009 [info ] [Thread-1 (]: 1 of 4 START sql view model dev.src_hosts ...................................... [RUN]
[0m11:57:41.116624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m11:57:41.119162 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m11:57:41.148001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m11:57:41.149964 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 11:57:41.121072 => 11:57:41.149270
[0m11:57:41.151123 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m11:57:41.186961 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m11:57:41.188006 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m11:57:41.188557 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m11:57:41.189083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:41.924354 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:57:41.979792 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 11:57:41.152420 => 11:57:41.979422
[0m11:57:41.980633 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m11:57:42.052058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '208564dc-fb0e-4e60-9f8c-123ac14e373b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59c03bbdf0>]}
[0m11:57:42.053686 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.94s]
[0m11:57:42.055463 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m11:57:42.056811 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m11:57:42.058444 [info ] [Thread-1 (]: 2 of 4 START sql view model dev.src_listings ................................... [RUN]
[0m11:57:42.060161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m11:57:42.061801 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m11:57:42.065234 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m11:57:42.066077 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 11:57:42.062664 => 11:57:42.065794
[0m11:57:42.066620 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m11:57:42.071434 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m11:57:42.072567 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m11:57:42.073122 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m11:57:42.073718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:42.848505 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:57:42.863615 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 11:57:42.066965 => 11:57:42.862392
[0m11:57:42.866324 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m11:57:42.985311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '208564dc-fb0e-4e60-9f8c-123ac14e373b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59c03bb9d0>]}
[0m11:57:42.988731 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.93s]
[0m11:57:42.992595 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m11:57:42.995466 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m11:57:42.999237 [info ] [Thread-1 (]: 3 of 4 START sql view model dev.src_reviews .................................... [RUN]
[0m11:57:43.003596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m11:57:43.006266 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m11:57:43.013181 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m11:57:43.015067 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 11:57:43.008104 => 11:57:43.014385
[0m11:57:43.016366 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m11:57:43.024891 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m11:57:43.026578 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m11:57:43.027489 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m11:57:43.028299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:43.769800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:57:43.784352 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 11:57:43.017218 => 11:57:43.783131
[0m11:57:43.786893 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m11:57:43.930639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '208564dc-fb0e-4e60-9f8c-123ac14e373b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59c03bbb20>]}
[0m11:57:43.933970 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.93s]
[0m11:57:43.937373 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m11:57:43.940098 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m11:57:43.943486 [info ] [Thread-1 (]: 4 of 4 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m11:57:43.947174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m11:57:43.950140 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m11:57:43.961703 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m11:57:43.963858 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 11:57:43.952138 => 11:57:43.963127
[0m11:57:43.965367 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m11:57:43.974491 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m11:57:43.976718 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m11:57:43.977718 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m11:57:43.978496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:44.997162 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:57:45.001812 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 11:57:43.966353 => 11:57:45.001476
[0m11:57:45.002381 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m11:57:45.087060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '208564dc-fb0e-4e60-9f8c-123ac14e373b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59c0348220>]}
[0m11:57:45.090517 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.14s]
[0m11:57:45.093956 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m11:57:45.100633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:45.103020 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_hosts_cleansed' was properly closed.
[0m11:57:45.105402 [info ] [MainThread]: 
[0m11:57:45.107855 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.90 seconds (5.90s).
[0m11:57:45.113253 [debug] [MainThread]: Command end result
[0m11:57:45.129291 [info ] [MainThread]: 
[0m11:57:45.130158 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:57:45.131002 [info ] [MainThread]: 
[0m11:57:45.131886 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:57:45.133338 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.723039, "process_user_time": 3.887319, "process_kernel_time": 0.807028, "process_mem_max_rss": "195936", "process_out_blocks": "1824", "process_in_blocks": "0"}
[0m11:57:45.134286 [debug] [MainThread]: Command `dbt run` succeeded at 11:57:45.134068 after 6.72 seconds
[0m11:57:45.135032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59ea0b29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59e83d9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59c03480a0>]}
[0m11:57:45.136246 [debug] [MainThread]: Flushing usage events
[0m12:01:19.280284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665e1a6e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665dff76410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665dff763b0>]}


============================== 12:01:19.282788 | 70f02e61-1079-4814-91a5-3a6fa056a524 ==============================
[0m12:01:19.282788 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:01:19.283418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:01:19.996953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70f02e61-1079-4814-91a5-3a6fa056a524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665dff76500>]}
[0m12:01:20.067061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70f02e61-1079-4814-91a5-3a6fa056a524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b8c0dff0>]}
[0m12:01:20.068033 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:01:20.076004 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:01:20.106750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:01:20.107572 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:01:20.113766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70f02e61-1079-4814-91a5-3a6fa056a524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b890fd90>]}
[0m12:01:20.122424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70f02e61-1079-4814-91a5-3a6fa056a524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b88d5cc0>]}
[0m12:01:20.123070 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:01:20.123641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70f02e61-1079-4814-91a5-3a6fa056a524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b88d6590>]}
[0m12:01:20.125658 [info ] [MainThread]: 
[0m12:01:20.126852 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:01:20.128747 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:01:20.142714 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:01:20.143407 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:01:20.143961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:21.087389 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:01:21.094311 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:01:21.231781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:01:21.266863 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:01:21.268669 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:01:21.269935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:21.850222 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:01:21.857188 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:01:22.001400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70f02e61-1079-4814-91a5-3a6fa056a524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b893ace0>]}
[0m12:01:22.007073 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:01:22.009784 [info ] [MainThread]: 
[0m12:01:22.018048 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:01:22.020920 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:01:22.025069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:01:22.028773 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:01:22.045622 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:01:22.047628 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:01:22.030026 => 12:01:22.046978
[0m12:01:22.049105 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:01:22.081938 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:01:22.083011 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:01:22.083587 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:01:22.084225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:22.809846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:01:22.854863 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:01:22.049973 => 12:01:22.854545
[0m12:01:22.855534 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:01:22.985298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70f02e61-1079-4814-91a5-3a6fa056a524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b8752b00>]}
[0m12:01:22.988656 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.96s]
[0m12:01:22.992103 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:01:22.994813 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:01:22.998439 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m12:01:23.002166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:01:23.004725 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:01:23.016957 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:01:23.020770 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:01:23.006694 => 12:01:23.019344
[0m12:01:23.023424 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:01:23.040349 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:01:23.043567 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:01:23.045169 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:01:23.046667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:24.038718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:01:24.052849 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:01:23.025270 => 12:01:24.051626
[0m12:01:24.055471 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:01:24.212648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70f02e61-1079-4814-91a5-3a6fa056a524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b8750f10>]}
[0m12:01:24.215966 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.21s]
[0m12:01:24.219403 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:01:24.222148 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:01:24.225270 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m12:01:24.229840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:01:24.234666 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:01:24.245094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:01:24.247131 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:01:24.237603 => 12:01:24.246395
[0m12:01:24.248684 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:01:24.256358 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:01:24.258650 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:01:24.260019 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:01:24.260822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:25.267104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:01:25.275433 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:01:24.249713 => 12:01:25.274747
[0m12:01:25.276824 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:01:25.362058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70f02e61-1079-4814-91a5-3a6fa056a524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b8753df0>]}
[0m12:01:25.365676 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.13s]
[0m12:01:25.370633 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:01:25.373912 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:01:25.376660 [info ] [Thread-1 (]: 4 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:01:25.379640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:01:25.381324 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:01:25.388257 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:01:25.389950 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:01:25.382227 => 12:01:25.389316
[0m12:01:25.391075 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:01:25.398490 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:01:25.400005 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:01:25.400816 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:01:25.401628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:26.058414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:01:26.080723 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:01:25.391684 => 12:01:26.079723
[0m12:01:26.083059 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:01:26.187178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70f02e61-1079-4814-91a5-3a6fa056a524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b85b40d0>]}
[0m12:01:26.190665 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.81s]
[0m12:01:26.194620 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:01:26.197339 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:01:26.201817 [info ] [Thread-1 (]: 5 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:01:26.207796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:01:26.210824 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:01:26.221687 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:01:26.223975 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:01:26.212789 => 12:01:26.223190
[0m12:01:26.225444 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:01:26.234280 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:01:26.236598 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:01:26.238010 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:01:26.238728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:27.110137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:01:27.124313 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:01:26.226391 => 12:01:27.123054
[0m12:01:27.127250 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:01:27.271694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70f02e61-1079-4814-91a5-3a6fa056a524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b8595b70>]}
[0m12:01:27.275195 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.07s]
[0m12:01:27.278718 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:01:27.285334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:27.288545 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_cleansed' was properly closed.
[0m12:01:27.291565 [info ] [MainThread]: 
[0m12:01:27.294028 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.16 seconds (7.16s).
[0m12:01:27.301984 [debug] [MainThread]: Command end result
[0m12:01:27.326100 [info ] [MainThread]: 
[0m12:01:27.327643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:01:27.328748 [info ] [MainThread]: 
[0m12:01:27.329884 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:01:27.331541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.09409, "process_user_time": 4.196848, "process_kernel_time": 0.732656, "process_mem_max_rss": "195756", "process_out_blocks": "1848", "process_in_blocks": "0"}
[0m12:01:27.332544 [debug] [MainThread]: Command `dbt run` succeeded at 12:01:27.332275 after 8.10 seconds
[0m12:01:27.333295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665e1a6e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665dff76500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b85b4af0>]}
[0m12:01:27.334086 [debug] [MainThread]: Flushing usage events
[0m12:03:36.092192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567d7dba9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567d60c6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567d60c63b0>]}


============================== 12:03:36.094947 | 9ed591c7-5ff5-4c3d-a4ac-74594abd495b ==============================
[0m12:03:36.094947 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:03:36.095699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'version_check': 'True', 'profiles_dir': '/home/lkeiti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:03:36.731448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ed591c7-5ff5-4c3d-a4ac-74594abd495b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567d60c6500>]}
[0m12:03:36.789473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ed591c7-5ff5-4c3d-a4ac-74594abd495b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567aaf33430>]}
[0m12:03:36.790434 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:03:36.797284 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:03:36.825337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:03:36.825942 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:03:36.831333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ed591c7-5ff5-4c3d-a4ac-74594abd495b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567aabb7d90>]}
[0m12:03:36.839545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ed591c7-5ff5-4c3d-a4ac-74594abd495b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567aab81cc0>]}
[0m12:03:36.840183 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:03:36.840728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ed591c7-5ff5-4c3d-a4ac-74594abd495b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567aab82590>]}
[0m12:03:36.842436 [info ] [MainThread]: 
[0m12:03:36.843264 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:03:36.844636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:03:36.859251 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:03:36.859845 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:03:36.860334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:37.806046 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:03:37.812944 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:03:37.936644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:03:37.969650 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:03:37.971121 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:03:37.972272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:38.560227 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:03:38.567319 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:03:38.710815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ed591c7-5ff5-4c3d-a4ac-74594abd495b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567d60c6350>]}
[0m12:03:38.712384 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:03:38.713268 [info ] [MainThread]: 
[0m12:03:38.716938 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:03:38.718179 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:03:38.720035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:03:38.721254 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:03:38.736980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:03:38.739007 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:03:38.722059 => 12:03:38.738286
[0m12:03:38.740273 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:03:38.776859 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:03:38.777935 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:03:38.778499 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:03:38.779099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:39.519427 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:03:39.575802 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:03:38.741092 => 12:03:39.575460
[0m12:03:39.576531 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:03:39.684621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed591c7-5ff5-4c3d-a4ac-74594abd495b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567d60c6350>]}
[0m12:03:39.687928 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.96s]
[0m12:03:39.691296 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:03:39.694335 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:03:39.698023 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m12:03:39.701680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:03:39.704411 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:03:39.713533 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:03:39.716872 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:03:39.706340 => 12:03:39.715692
[0m12:03:39.718864 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:03:39.731530 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:03:39.734140 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:03:39.735161 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:03:39.736756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:40.241037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:03:40.255990 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:03:39.719981 => 12:03:40.254796
[0m12:03:40.258822 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:03:40.348096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed591c7-5ff5-4c3d-a4ac-74594abd495b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567aa1dfaf0>]}
[0m12:03:40.351533 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.65s]
[0m12:03:40.355212 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:03:40.358081 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:03:40.362037 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m12:03:40.366627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:03:40.369611 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:03:40.378725 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:03:40.382482 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:03:40.371307 => 12:03:40.381168
[0m12:03:40.385097 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:03:40.398625 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:03:40.401068 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:03:40.402438 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:03:40.403663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:41.360319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:03:41.370630 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:03:40.386838 => 12:03:41.369693
[0m12:03:41.372649 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:03:41.508602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed591c7-5ff5-4c3d-a4ac-74594abd495b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567aa0eb3d0>]}
[0m12:03:41.512201 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.14s]
[0m12:03:41.515907 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:03:41.518820 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:03:41.522080 [info ] [Thread-1 (]: 4 of 5 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m12:03:41.524900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:03:41.526510 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:03:41.533176 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:03:41.534943 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:03:41.527371 => 12:03:41.534371
[0m12:03:41.535981 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:03:41.551767 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type view
[0m12:03:41.562917 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED"
[0m12:03:41.570179 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:03:41.570918 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m12:03:41.571526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:42.285029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:03:42.312371 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:03:42.313430 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:03:42.314077 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.dev.dim_hosts_cleansed
         as
        (with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
        );
[0m12:03:42.759325 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469a7-0000-437b-0000-000052fd5559
[0m12:03:42.760532 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:03:42.762097 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:03:41.536549 => 12:03:42.761536
[0m12:03:42.763198 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:03:42.905368 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/dim/dim_hosts_cleansed.sql
[0m12:03:42.908626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed591c7-5ff5-4c3d-a4ac-74594abd495b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567aa9e9b40>]}
[0m12:03:42.912086 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model dev.dim_hosts_cleansed ................... [[31mERROR[0m in 1.38s]
[0m12:03:42.915870 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:03:42.918776 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:03:42.923515 [info ] [Thread-1 (]: 5 of 5 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m12:03:42.926032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:03:42.927466 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:03:42.933634 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:03:42.935153 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:03:42.928342 => 12:03:42.934643
[0m12:03:42.936093 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:03:42.940455 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type view
[0m12:03:42.944747 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED"
[0m12:03:42.946774 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:03:42.947536 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m12:03:42.948244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:43.740443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:03:43.748121 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:03:43.753966 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:03:43.756045 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
        );
[0m12:03:44.127436 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469a7-0000-4377-0000-000052fd4549
[0m12:03:44.130053 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:03:44.133364 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:03:42.936671 => 12:03:44.132115
[0m12:03:44.136025 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:03:44.254817 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/dim/dim_listings_cleansed.sql
[0m12:03:44.257955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed591c7-5ff5-4c3d-a4ac-74594abd495b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567aa13b640>]}
[0m12:03:44.261302 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model dev.dim_listings_cleansed ................ [[31mERROR[0m in 1.33s]
[0m12:03:44.264764 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:03:44.271783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:44.274063 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_cleansed' was properly closed.
[0m12:03:44.276410 [info ] [MainThread]: 
[0m12:03:44.279298 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 7.43 seconds (7.43s).
[0m12:03:44.287486 [debug] [MainThread]: Command end result
[0m12:03:44.311623 [info ] [MainThread]: 
[0m12:03:44.312764 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:03:44.314032 [info ] [MainThread]: 
[0m12:03:44.315095 [error] [MainThread]:   Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/dim/dim_hosts_cleansed.sql
[0m12:03:44.316094 [info ] [MainThread]: 
[0m12:03:44.316982 [error] [MainThread]:   Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/dim/dim_listings_cleansed.sql
[0m12:03:44.317978 [info ] [MainThread]: 
[0m12:03:44.318905 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m12:03:44.320453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.269353, "process_user_time": 4.009021, "process_kernel_time": 0.832212, "process_mem_max_rss": "196888", "process_in_blocks": "872", "process_out_blocks": "1864", "command_success": false}
[0m12:03:44.321539 [debug] [MainThread]: Command `dbt run` failed at 12:03:44.321255 after 8.27 seconds
[0m12:03:44.322513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567d7dba9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567d60c6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7567aaec38b0>]}
[0m12:03:44.323364 [debug] [MainThread]: Flushing usage events
[0m12:04:33.083692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e29abaa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e298eb6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e298eb63b0>]}


============================== 12:04:33.086154 | 6de85c09-af76-461e-a99e-159270d89e72 ==============================
[0m12:04:33.086154 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:04:33.087127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:04:33.701746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6de85c09-af76-461e-a99e-159270d89e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e298eb6500>]}
[0m12:04:33.760246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6de85c09-af76-461e-a99e-159270d89e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e26dcbf430>]}
[0m12:04:33.761064 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:04:33.767807 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:04:33.798126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:04:33.798673 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:04:33.799439 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbtlearn.dim
- models.dbtlearn
[0m12:04:33.804457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6de85c09-af76-461e-a99e-159270d89e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e26d947d90>]}
[0m12:04:33.812695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6de85c09-af76-461e-a99e-159270d89e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e26d90dcc0>]}
[0m12:04:33.813437 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:04:33.814366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6de85c09-af76-461e-a99e-159270d89e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e26d90e590>]}
[0m12:04:33.816427 [info ] [MainThread]: 
[0m12:04:33.817379 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:04:33.818895 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:04:33.832023 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:04:33.832630 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:04:33.833102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:34.645340 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:04:34.651759 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:04:34.801848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:04:34.812038 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:04:34.812545 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:04:34.813012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:35.595108 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:04:35.601157 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:04:35.731162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6de85c09-af76-461e-a99e-159270d89e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e298eb6350>]}
[0m12:04:35.735010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:04:35.737330 [info ] [MainThread]: 
[0m12:04:35.745043 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:04:35.748000 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:04:35.751782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:04:35.754737 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:04:35.782014 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:04:35.784057 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:04:35.756310 => 12:04:35.783304
[0m12:04:35.785694 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:04:35.819703 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:04:35.820782 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:04:35.821359 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:04:35.821915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:36.966830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:04:37.009340 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:04:35.786727 => 12:04:37.008989
[0m12:04:37.010117 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:04:37.148378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de85c09-af76-461e-a99e-159270d89e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e26d868580>]}
[0m12:04:37.151844 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.40s]
[0m12:04:37.155703 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:04:37.158679 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:04:37.162649 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m12:04:37.166549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:04:37.169571 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:04:37.178517 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:04:37.180576 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:04:37.171403 => 12:04:37.179859
[0m12:04:37.182166 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:04:37.189974 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:04:37.191870 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:04:37.193083 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:04:37.194196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:38.195958 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:04:38.210794 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:04:37.183074 => 12:04:38.209565
[0m12:04:38.213298 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:04:38.339062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de85c09-af76-461e-a99e-159270d89e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e26d7efa90>]}
[0m12:04:38.342424 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.17s]
[0m12:04:38.346088 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:04:38.348869 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:04:38.352130 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m12:04:38.356518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:04:38.359096 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:04:38.365901 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:04:38.367940 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:04:38.360341 => 12:04:38.367206
[0m12:04:38.369135 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:04:38.376449 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:04:38.378196 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:04:38.379099 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:04:38.379904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:39.382049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:04:39.396779 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:04:38.370048 => 12:04:39.395429
[0m12:04:39.399373 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:04:39.537282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de85c09-af76-461e-a99e-159270d89e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e26d8681f0>]}
[0m12:04:39.540759 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.18s]
[0m12:04:39.544312 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:04:39.547144 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:04:39.550551 [info ] [Thread-1 (]: 4 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:04:39.554704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:04:39.557578 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:04:39.568513 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:04:39.571548 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:04:39.559496 => 12:04:39.570543
[0m12:04:39.572942 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:04:39.582268 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:04:39.583851 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:04:39.584650 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:04:39.585397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:40.367846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:04:40.380954 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:04:39.573680 => 12:04:40.379719
[0m12:04:40.383471 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:04:40.542297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de85c09-af76-461e-a99e-159270d89e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e26c607880>]}
[0m12:04:40.545805 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.99s]
[0m12:04:40.549229 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:04:40.551955 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:04:40.554967 [info ] [Thread-1 (]: 5 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:04:40.559115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:04:40.561649 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:04:40.574138 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:04:40.576249 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:04:40.563258 => 12:04:40.575531
[0m12:04:40.577441 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:04:40.585966 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:04:40.587862 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:04:40.588676 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:04:40.589449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:41.274726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:04:41.287489 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:04:40.578669 => 12:04:41.286279
[0m12:04:41.289973 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:04:41.392064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de85c09-af76-461e-a99e-159270d89e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e26d90d2d0>]}
[0m12:04:41.395398 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.83s]
[0m12:04:41.398828 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:04:41.405194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:41.407486 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_cleansed' was properly closed.
[0m12:04:41.410291 [info ] [MainThread]: 
[0m12:04:41.414141 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.59 seconds (7.59s).
[0m12:04:41.421278 [debug] [MainThread]: Command end result
[0m12:04:41.443698 [info ] [MainThread]: 
[0m12:04:41.445565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:04:41.446475 [info ] [MainThread]: 
[0m12:04:41.447344 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:04:41.449219 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.406699, "process_user_time": 4.010364, "process_kernel_time": 0.783588, "process_mem_max_rss": "195848", "process_out_blocks": "1856", "process_in_blocks": "0"}
[0m12:04:41.450345 [debug] [MainThread]: Command `dbt run` succeeded at 12:04:41.450082 after 8.41 seconds
[0m12:04:41.451084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e29abaa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e26c599690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e26c59a170>]}
[0m12:04:41.451848 [debug] [MainThread]: Flushing usage events
[0m12:06:24.048418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cff0ae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cfd3ba410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cfd3ba3b0>]}


============================== 12:06:24.050738 | 3163811e-cb07-4e67-8a83-0a1757228c97 ==============================
[0m12:06:24.050738 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:06:24.051448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:06:24.659951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3163811e-cb07-4e67-8a83-0a1757228c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cfd3ba500>]}
[0m12:06:24.715581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3163811e-cb07-4e67-8a83-0a1757228c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cd2237430>]}
[0m12:06:24.716387 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:06:24.723075 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:06:24.751557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:06:24.752096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:06:24.752841 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbtlearn
- models.dbtlearn.dim
[0m12:06:24.758412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3163811e-cb07-4e67-8a83-0a1757228c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cd1ebbd90>]}
[0m12:06:24.766849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3163811e-cb07-4e67-8a83-0a1757228c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cd1e81cc0>]}
[0m12:06:24.767524 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:06:24.768091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3163811e-cb07-4e67-8a83-0a1757228c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cd1e82590>]}
[0m12:06:24.769736 [info ] [MainThread]: 
[0m12:06:24.770593 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:06:24.771936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:06:24.786359 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:06:24.787209 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:06:24.787709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:25.848528 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:06:25.855317 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:06:25.988262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:06:26.007882 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:06:26.008783 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:06:26.009694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:26.806989 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:06:26.817854 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:06:26.947831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3163811e-cb07-4e67-8a83-0a1757228c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cd1e81690>]}
[0m12:06:26.951645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:06:26.954702 [info ] [MainThread]: 
[0m12:06:26.962502 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:06:26.965313 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:06:26.968906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:06:26.971400 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:06:26.996518 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:06:26.998163 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:06:26.972966 => 12:06:26.997597
[0m12:06:26.999310 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:06:27.034172 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:06:27.035186 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:06:27.035725 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:06:27.036239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:27.873876 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:06:27.929688 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:06:27.000011 => 12:06:27.929333
[0m12:06:27.930430 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:06:28.041982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3163811e-cb07-4e67-8a83-0a1757228c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cd1ddc160>]}
[0m12:06:28.045267 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.07s]
[0m12:06:28.048705 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:06:28.053567 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:06:28.057585 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m12:06:28.061707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:06:28.064281 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:06:28.071095 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:06:28.073179 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:06:28.065868 => 12:06:28.072473
[0m12:06:28.074559 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:06:28.081997 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:06:28.084279 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:06:28.085206 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:06:28.086038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:28.793741 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:06:28.809984 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:06:28.075448 => 12:06:28.807801
[0m12:06:28.814644 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:06:28.909120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3163811e-cb07-4e67-8a83-0a1757228c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cd14dfaf0>]}
[0m12:06:28.912444 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.85s]
[0m12:06:28.916413 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:06:28.919301 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:06:28.923022 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m12:06:28.928839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:06:28.932106 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:06:28.938655 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:06:28.940929 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:06:28.933384 => 12:06:28.940065
[0m12:06:28.943326 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:06:28.953151 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:06:28.955484 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:06:28.956843 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:06:28.958118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:30.021394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:06:30.038678 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:06:28.944579 => 12:06:30.037435
[0m12:06:30.041161 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:06:30.163160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3163811e-cb07-4e67-8a83-0a1757228c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cd141d000>]}
[0m12:06:30.166544 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.24s]
[0m12:06:30.169924 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:06:30.172617 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:06:30.175750 [info ] [Thread-1 (]: 4 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:06:30.179407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:06:30.181894 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:06:30.193094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:06:30.195286 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:06:30.183489 => 12:06:30.194577
[0m12:06:30.196604 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:06:30.206879 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:06:30.208295 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:06:30.209091 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:06:30.209863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:31.156927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:06:31.171751 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:06:30.197338 => 12:06:31.170547
[0m12:06:31.174288 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:06:31.264704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3163811e-cb07-4e67-8a83-0a1757228c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cd02e82e0>]}
[0m12:06:31.268085 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.09s]
[0m12:06:31.271003 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:06:31.272906 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:06:31.275070 [info ] [Thread-1 (]: 5 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:06:31.277054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:06:31.278416 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:06:31.284742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:06:31.286739 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:06:31.279264 => 12:06:31.286212
[0m12:06:31.287640 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:06:31.293270 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:06:31.294869 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:06:31.295554 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:06:31.296219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:32.275584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:06:32.280401 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:06:31.288207 => 12:06:32.280019
[0m12:06:32.281198 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:06:32.432686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3163811e-cb07-4e67-8a83-0a1757228c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cd02ebc70>]}
[0m12:06:32.435976 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.16s]
[0m12:06:32.441307 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:06:32.450776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:32.454341 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_cleansed' was properly closed.
[0m12:06:32.456926 [info ] [MainThread]: 
[0m12:06:32.458632 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.69 seconds (7.69s).
[0m12:06:32.463923 [debug] [MainThread]: Command end result
[0m12:06:32.479941 [info ] [MainThread]: 
[0m12:06:32.480782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:06:32.481512 [info ] [MainThread]: 
[0m12:06:32.482211 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:06:32.483351 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.47495, "process_user_time": 4.133236, "process_kernel_time": 0.785556, "process_mem_max_rss": "195916", "process_out_blocks": "1864", "process_in_blocks": "0"}
[0m12:06:32.484193 [debug] [MainThread]: Command `dbt run` succeeded at 12:06:32.483968 after 8.48 seconds
[0m12:06:32.484836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cff0ae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cd02fce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cd02fd750>]}
[0m12:06:32.485509 [debug] [MainThread]: Flushing usage events
[0m12:06:55.279532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d987a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d7d82410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d7d823b0>]}


============================== 12:06:55.282002 | db880011-8c09-4ce3-b678-f84dba2b31c9 ==============================
[0m12:06:55.282002 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:06:55.282686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:06:55.919683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db880011-8c09-4ce3-b678-f84dba2b31c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d7d82500>]}
[0m12:06:55.975856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db880011-8c09-4ce3-b678-f84dba2b31c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592b0913430>]}
[0m12:06:55.976632 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:06:55.983569 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:06:56.012350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:06:56.012880 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:06:56.017973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db880011-8c09-4ce3-b678-f84dba2b31c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592b0623d90>]}
[0m12:06:56.026862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db880011-8c09-4ce3-b678-f84dba2b31c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592b05e9cc0>]}
[0m12:06:56.027901 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:06:56.028802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db880011-8c09-4ce3-b678-f84dba2b31c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592b05ea590>]}
[0m12:06:56.031199 [info ] [MainThread]: 
[0m12:06:56.032535 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:06:56.034294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:06:56.047501 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:06:56.048074 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:06:56.048582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:56.890632 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:06:56.897702 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:06:57.030598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:06:57.063710 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:06:57.065244 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:06:57.066565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:57.979230 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:06:57.986229 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:06:58.148191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db880011-8c09-4ce3-b678-f84dba2b31c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592b0652b30>]}
[0m12:06:58.152300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:06:58.154679 [info ] [MainThread]: 
[0m12:06:58.161860 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:06:58.164027 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:06:58.166179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:06:58.167558 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:06:58.180861 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:06:58.182274 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:06:58.168449 => 12:06:58.181855
[0m12:06:58.183132 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:06:58.218177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:06:58.219204 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:06:58.219750 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:06:58.220283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:58.867583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:06:58.923084 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:06:58.183897 => 12:06:58.922726
[0m12:06:58.923837 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:06:59.051154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db880011-8c09-4ce3-b678-f84dba2b31c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592b0548730>]}
[0m12:06:59.054465 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.89s]
[0m12:06:59.057921 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:06:59.060928 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:06:59.064813 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m12:06:59.068440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:06:59.071097 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:06:59.079881 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:06:59.083103 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:06:59.073016 => 12:06:59.082045
[0m12:06:59.084481 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:06:59.092864 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:06:59.094667 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:06:59.095599 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:06:59.096376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:00.127744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:00.142093 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:06:59.085409 => 12:07:00.140779
[0m12:07:00.144609 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:07:00.273897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db880011-8c09-4ce3-b678-f84dba2b31c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592b0447af0>]}
[0m12:07:00.277224 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.21s]
[0m12:07:00.280739 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:07:00.283485 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:07:00.287897 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m12:07:00.292007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:07:00.294531 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:07:00.304378 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:07:00.306983 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:07:00.296172 => 12:07:00.306239
[0m12:07:00.308339 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:07:00.316519 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:07:00.318215 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:07:00.319121 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:07:00.320029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:01.356832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:01.371168 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:07:00.309211 => 12:07:01.369966
[0m12:07:01.373666 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:07:01.453121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db880011-8c09-4ce3-b678-f84dba2b31c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592b0384d30>]}
[0m12:07:01.456485 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.16s]
[0m12:07:01.460196 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:07:01.463000 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:07:01.466168 [info ] [Thread-1 (]: 4 of 5 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m12:07:01.469831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:07:01.472316 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:07:01.481710 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:07:01.483678 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:07:01.473972 => 12:07:01.482979
[0m12:07:01.484977 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:07:01.501744 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type view
[0m12:07:01.511225 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED"
[0m12:07:01.517133 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:07:01.517748 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m12:07:01.518281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:02.118631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:02.134718 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:07:02.136094 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:07:02.136821 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.dev.dim_hosts_cleansed
         as
        (with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
        );
[0m12:07:02.584636 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469ab-0000-437b-0000-000052fd55ed
[0m12:07:02.585248 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:07:02.586175 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:07:01.485704 => 12:07:02.585871
[0m12:07:02.586777 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:07:02.678800 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/dim/dim_hosts_cleansed.sql
[0m12:07:02.681636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db880011-8c09-4ce3-b678-f84dba2b31c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592b0652c20>]}
[0m12:07:02.685297 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model dev.dim_hosts_cleansed ................... [[31mERROR[0m in 1.21s]
[0m12:07:02.688852 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:07:02.691883 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:07:02.697040 [info ] [Thread-1 (]: 5 of 5 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m12:07:02.700817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:07:02.703399 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:07:02.715860 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:07:02.718285 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:07:02.705015 => 12:07:02.717697
[0m12:07:02.719379 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:07:02.724668 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type view
[0m12:07:02.729365 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED"
[0m12:07:02.731723 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:07:02.732487 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m12:07:02.733141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:03.086206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:07:03.093921 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:07:03.098930 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:07:03.101438 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
        );
[0m12:07:03.507974 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469ab-0000-4377-0000-000052fd45d5
[0m12:07:03.510645 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:07:03.513975 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:07:02.720078 => 12:07:03.512702
[0m12:07:03.517018 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:07:03.610504 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/dim/dim_listings_cleansed.sql
[0m12:07:03.613321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db880011-8c09-4ce3-b678-f84dba2b31c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592b03a0880>]}
[0m12:07:03.616741 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model dev.dim_listings_cleansed ................ [[31mERROR[0m in 0.91s]
[0m12:07:03.620637 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:07:03.627900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:03.630361 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_cleansed' was properly closed.
[0m12:07:03.632834 [info ] [MainThread]: 
[0m12:07:03.635408 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 7.60 seconds (7.60s).
[0m12:07:03.642211 [debug] [MainThread]: Command end result
[0m12:07:03.666912 [info ] [MainThread]: 
[0m12:07:03.668081 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:07:03.669120 [info ] [MainThread]: 
[0m12:07:03.670193 [error] [MainThread]:   Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/dim/dim_hosts_cleansed.sql
[0m12:07:03.671207 [info ] [MainThread]: 
[0m12:07:03.672093 [error] [MainThread]:   Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/dim/dim_listings_cleansed.sql
[0m12:07:03.673077 [info ] [MainThread]: 
[0m12:07:03.674083 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m12:07:03.675696 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.438301, "process_user_time": 4.006193, "process_kernel_time": 0.925734, "process_mem_max_rss": "197308", "process_out_blocks": "1856", "command_success": false, "process_in_blocks": "0"}
[0m12:07:03.676945 [debug] [MainThread]: Command `dbt run` failed at 12:07:03.676644 after 8.44 seconds
[0m12:07:03.677912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d987a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592b08a38b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592b02e9780>]}
[0m12:07:03.678828 [debug] [MainThread]: Flushing usage events
[0m12:07:48.733628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74865f87a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74865dd82410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74865dd823b0>]}


============================== 12:07:48.735940 | cbca4811-0422-4400-bc04-20acf993fd13 ==============================
[0m12:07:48.735940 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:07:48.736581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:49.345687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbca4811-0422-4400-bc04-20acf993fd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74865dd82500>]}
[0m12:07:49.402782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbca4811-0422-4400-bc04-20acf993fd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74863291f430>]}
[0m12:07:49.403587 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:07:49.410218 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:07:49.438423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:07:49.438955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:07:49.444240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbca4811-0422-4400-bc04-20acf993fd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748632623d90>]}
[0m12:07:49.452076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbca4811-0422-4400-bc04-20acf993fd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7486325e9cc0>]}
[0m12:07:49.452678 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:07:49.453354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbca4811-0422-4400-bc04-20acf993fd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7486325ea590>]}
[0m12:07:49.455199 [info ] [MainThread]: 
[0m12:07:49.456144 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:07:49.457458 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:07:49.471671 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:07:49.472279 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:07:49.472813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:50.385788 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:07:50.392290 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:07:50.532300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:07:50.566713 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:07:50.568095 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:07:50.569351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:51.432129 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:07:51.435319 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:07:51.552786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbca4811-0422-4400-bc04-20acf993fd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748632652b30>]}
[0m12:07:51.556736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:07:51.559280 [info ] [MainThread]: 
[0m12:07:51.568481 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:07:51.573574 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:07:51.578956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:07:51.580935 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:07:51.597713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:07:51.599842 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:07:51.582115 => 12:07:51.599062
[0m12:07:51.601099 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:07:51.634073 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:07:51.635164 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:07:51.635706 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:07:51.636228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:52.970003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:53.026548 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:07:51.601921 => 12:07:53.026203
[0m12:07:53.027274 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:07:53.121700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbca4811-0422-4400-bc04-20acf993fd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7486325e89d0>]}
[0m12:07:53.122563 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.54s]
[0m12:07:53.123328 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:07:53.123933 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:07:53.124528 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m12:07:53.125595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:07:53.126144 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:07:53.128129 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:07:53.128895 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:07:53.126497 => 12:07:53.128618
[0m12:07:53.129434 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:07:53.133386 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:07:53.135081 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:07:53.135849 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:07:53.136399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:53.890349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:53.905059 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:07:53.129828 => 12:07:53.903854
[0m12:07:53.907672 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:07:53.994490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbca4811-0422-4400-bc04-20acf993fd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748632540310>]}
[0m12:07:53.998122 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.87s]
[0m12:07:54.001702 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:07:54.004386 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:07:54.008510 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m12:07:54.014464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:07:54.017736 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:07:54.026326 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:07:54.028755 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:07:54.019645 => 12:07:54.027790
[0m12:07:54.030576 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:07:54.039947 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:07:54.042094 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:07:54.042795 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:07:54.043455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:54.812084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:54.826545 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:07:54.031552 => 12:07:54.825303
[0m12:07:54.829409 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:07:54.963569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbca4811-0422-4400-bc04-20acf993fd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748631b83e50>]}
[0m12:07:54.966929 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.95s]
[0m12:07:54.970387 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:07:54.973075 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:07:54.977162 [info ] [Thread-1 (]: 4 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:07:54.984300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:07:54.987991 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:07:55.000056 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:07:55.002433 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:07:54.989910 => 12:07:55.001641
[0m12:07:55.003966 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:07:55.013321 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:07:55.015371 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:07:55.016500 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    

with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:07:55.017559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:55.733021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:55.746274 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:07:55.004912 => 12:07:55.745027
[0m12:07:55.748993 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:07:55.908334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbca4811-0422-4400-bc04-20acf993fd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7486302de7a0>]}
[0m12:07:55.910776 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.93s]
[0m12:07:55.913258 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:07:55.915227 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:07:55.917554 [info ] [Thread-1 (]: 5 of 5 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m12:07:55.920369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:07:55.922234 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:07:55.930148 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:07:55.932911 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:07:55.923369 => 12:07:55.931867
[0m12:07:55.934110 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:07:55.962436 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:07:55.963762 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:07:55.964354 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
        );
[0m12:07:55.964902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:56.661069 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469ab-0000-437b-0000-000052fd55f9
[0m12:07:56.661721 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:07:56.662452 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:07:55.934819 => 12:07:56.662178
[0m12:07:56.662996 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:07:56.744224 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/dim/dim_listings_cleansed.sql
[0m12:07:56.747380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbca4811-0422-4400-bc04-20acf993fd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7486302b64d0>]}
[0m12:07:56.750751 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model dev.dim_listings_cleansed ................ [[31mERROR[0m in 0.83s]
[0m12:07:56.754527 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:07:56.763932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:56.765629 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_cleansed' was properly closed.
[0m12:07:56.767414 [info ] [MainThread]: 
[0m12:07:56.769194 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 7.31 seconds (7.31s).
[0m12:07:56.772496 [debug] [MainThread]: Command end result
[0m12:07:56.791915 [info ] [MainThread]: 
[0m12:07:56.792732 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:07:56.793437 [info ] [MainThread]: 
[0m12:07:56.794158 [error] [MainThread]:   Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/dim/dim_listings_cleansed.sql
[0m12:07:56.794810 [info ] [MainThread]: 
[0m12:07:56.795481 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:07:56.796669 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.103406, "process_user_time": 4.001605, "process_kernel_time": 0.895881, "process_mem_max_rss": "196752", "process_out_blocks": "1848", "command_success": false, "process_in_blocks": "0"}
[0m12:07:56.797607 [debug] [MainThread]: Command `dbt run` failed at 12:07:56.797320 after 8.10 seconds
[0m12:07:56.798307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74865f87a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748631c75a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748631c75b40>]}
[0m12:07:56.799013 [debug] [MainThread]: Flushing usage events
[0m12:08:20.223008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156d8eaa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156d71b63b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156d71b6350>]}


============================== 12:08:20.225462 | 7c78395a-987c-425b-a9b6-4c9d6550bd51 ==============================
[0m12:08:20.225462 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:08:20.226232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:08:20.853152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c78395a-987c-425b-a9b6-4c9d6550bd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156d71b64a0>]}
[0m12:08:20.910927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c78395a-987c-425b-a9b6-4c9d6550bd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156abf5b250>]}
[0m12:08:20.911767 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:08:20.918652 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:08:20.946690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:08:20.947244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:08:20.952568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c78395a-987c-425b-a9b6-4c9d6550bd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156abc4c640>]}
[0m12:08:20.960862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c78395a-987c-425b-a9b6-4c9d6550bd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156abc1dc60>]}
[0m12:08:20.961476 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:08:20.962159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c78395a-987c-425b-a9b6-4c9d6550bd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156abc1e530>]}
[0m12:08:20.963783 [info ] [MainThread]: 
[0m12:08:20.964629 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:08:20.966048 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:08:20.979875 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:08:20.980480 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:08:20.980979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:21.967949 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:08:21.974341 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:08:22.116752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:08:22.152294 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:08:22.154217 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:08:22.155411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:22.900419 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:08:22.907063 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:08:23.050384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c78395a-987c-425b-a9b6-4c9d6550bd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156aba86a70>]}
[0m12:08:23.054278 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:08:23.056686 [info ] [MainThread]: 
[0m12:08:23.064694 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:08:23.067558 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:08:23.071150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:08:23.073673 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:08:23.099119 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:08:23.100740 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:08:23.075347 => 12:08:23.100172
[0m12:08:23.101844 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:08:23.139394 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:08:23.140550 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:08:23.141110 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:08:23.141693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:24.305388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:08:24.362756 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:08:23.102532 => 12:08:24.362402
[0m12:08:24.363506 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:08:24.479991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78395a-987c-425b-a9b6-4c9d6550bd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156abc1d120>]}
[0m12:08:24.483320 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.41s]
[0m12:08:24.486749 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:08:24.489394 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:08:24.494235 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m12:08:24.500120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:08:24.504246 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:08:24.514000 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:08:24.516662 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:08:24.506616 => 12:08:24.515776
[0m12:08:24.518542 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:08:24.528378 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:08:24.530750 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:08:24.531997 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:08:24.533130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:25.198168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:08:25.201440 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:08:24.519678 => 12:08:25.201172
[0m12:08:25.202005 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:08:25.353813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78395a-987c-425b-a9b6-4c9d6550bd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156ab17c100>]}
[0m12:08:25.357475 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.86s]
[0m12:08:25.361209 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:08:25.365909 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:08:25.371346 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m12:08:25.376454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:08:25.379275 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:08:25.384277 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:08:25.385961 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:08:25.380152 => 12:08:25.385347
[0m12:08:25.387081 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:08:25.394428 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:08:25.395946 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:08:25.396751 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:08:25.397646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:26.147152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:08:26.162510 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:08:25.387781 => 12:08:26.160915
[0m12:08:26.164416 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:08:26.264239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78395a-987c-425b-a9b6-4c9d6550bd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156ab1bbe50>]}
[0m12:08:26.267582 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.89s]
[0m12:08:26.271157 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:08:26.273885 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:08:26.277176 [info ] [Thread-1 (]: 4 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:08:26.281015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:08:26.283715 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:08:26.296066 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:08:26.298799 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:08:26.285589 => 12:08:26.298019
[0m12:08:26.300190 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:08:26.309967 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:08:26.311657 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:08:26.312488 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    

with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:08:26.313253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:27.081613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:08:27.096214 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:08:26.301054 => 12:08:27.094984
[0m12:08:27.098883 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:08:27.245668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78395a-987c-425b-a9b6-4c9d6550bd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156a990e8f0>]}
[0m12:08:27.250868 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.97s]
[0m12:08:27.256376 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:08:27.260791 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:08:27.265573 [info ] [Thread-1 (]: 5 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:08:27.270126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:08:27.272768 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:08:27.283371 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:08:27.285557 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:08:27.274202 => 12:08:27.284782
[0m12:08:27.287008 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:08:27.295465 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:08:27.297788 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:08:27.298472 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    

with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:08:27.299313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:27.991151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:08:27.994940 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:08:27.287816 => 12:08:27.994670
[0m12:08:27.995485 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:08:28.077395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78395a-987c-425b-a9b6-4c9d6550bd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156a990e260>]}
[0m12:08:28.080740 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.81s]
[0m12:08:28.084416 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:08:28.090863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:28.093483 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_cleansed' was properly closed.
[0m12:08:28.095948 [info ] [MainThread]: 
[0m12:08:28.098353 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.13 seconds (7.13s).
[0m12:08:28.104625 [debug] [MainThread]: Command end result
[0m12:08:28.134874 [info ] [MainThread]: 
[0m12:08:28.136207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:08:28.137216 [info ] [MainThread]: 
[0m12:08:28.138436 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:08:28.140848 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9586587, "process_user_time": 4.125779, "process_kernel_time": 0.86335, "process_mem_max_rss": "195660", "process_out_blocks": "1864", "process_in_blocks": "0"}
[0m12:08:28.141951 [debug] [MainThread]: Command `dbt run` succeeded at 12:08:28.141663 after 7.96 seconds
[0m12:08:28.142722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156d8eaa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156b04d7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156a98a9f60>]}
[0m12:08:28.143490 [debug] [MainThread]: Flushing usage events
[0m12:08:42.418828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c27cac7aa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c27c9182470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c27c9182410>]}


============================== 12:08:42.421318 | 1cecf0f9-0865-46d2-b661-160c13d70600 ==============================
[0m12:08:42.421318 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:08:42.422126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m12:08:43.038501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cecf0f9-0865-46d2-b661-160c13d70600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c27c9182560>]}
[0m12:08:43.103505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cecf0f9-0865-46d2-b661-160c13d70600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c279dd22cb0>]}
[0m12:08:43.104335 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:08:43.111208 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:08:43.141042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:08:43.141654 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:08:43.146967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cecf0f9-0865-46d2-b661-160c13d70600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c279da23df0>]}
[0m12:08:43.154919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cecf0f9-0865-46d2-b661-160c13d70600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c279d9e9d20>]}
[0m12:08:43.155528 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:08:43.156047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cecf0f9-0865-46d2-b661-160c13d70600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c279d9ea5f0>]}
[0m12:08:43.157794 [info ] [MainThread]: 
[0m12:08:43.158628 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:08:43.160280 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:08:43.177141 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:08:43.177843 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:08:43.178345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:44.091172 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:08:44.098698 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:08:44.261009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:08:44.295400 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:08:44.297116 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:08:44.298749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:45.056023 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:08:45.063190 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:08:45.203264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cecf0f9-0865-46d2-b661-160c13d70600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c279da52d10>]}
[0m12:08:45.207645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:08:45.210284 [info ] [MainThread]: 
[0m12:08:45.218441 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:08:45.221596 [info ] [Thread-1 (]: 1 of 5 START sql table model dev.src_hosts ..................................... [RUN]
[0m12:08:45.225831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:08:45.228334 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:08:45.259830 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:08:45.262040 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:08:45.230731 => 12:08:45.261212
[0m12:08:45.263514 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:08:45.292305 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."SRC_HOSTS" because it is of type view
[0m12:08:45.302456 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."SRC_HOSTS"
[0m12:08:45.308599 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:08:45.309190 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
drop view if exists "AIRBNB"."DEV"."SRC_HOSTS" cascade
[0m12:08:45.309870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:45.988292 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:08:46.029460 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:08:46.031071 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:08:46.031973 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace transient table AIRBNB.dev.src_hosts
         as
        (with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
        );
[0m12:08:46.425444 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469ac-0000-437b-0000-000052fd5619
[0m12:08:46.426563 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:08:46.427925 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:08:45.264418 => 12:08:46.427508
[0m12:08:46.428741 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:08:46.561707 [debug] [Thread-1 (]: Database Error in model src_hosts (models/src/src_hosts.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_hosts.sql
[0m12:08:46.562437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cecf0f9-0865-46d2-b661-160c13d70600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c279d074280>]}
[0m12:08:46.563189 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model dev.src_hosts ............................ [[31mERROR[0m in 1.34s]
[0m12:08:46.563978 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:08:46.564780 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:08:46.565595 [info ] [Thread-1 (]: 2 of 5 START sql table model dev.src_listings .................................. [RUN]
[0m12:08:46.567439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:08:46.568054 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:08:46.571012 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:08:46.572453 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:08:46.568419 => 12:08:46.571973
[0m12:08:46.573488 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:08:46.578226 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."SRC_LISTINGS" because it is of type view
[0m12:08:46.582723 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."SRC_LISTINGS"
[0m12:08:46.584384 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:08:46.584970 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
drop view if exists "AIRBNB"."DEV"."SRC_LISTINGS" cascade
[0m12:08:46.585602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:47.100516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:08:47.107907 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:08:47.112522 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:08:47.115332 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace transient table AIRBNB.dev.src_listings
         as
        (with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
        );
[0m12:08:47.273283 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469ac-0000-4377-0000-000052fd460d
[0m12:08:47.276342 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:08:47.280093 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:08:46.574102 => 12:08:47.278825
[0m12:08:47.282652 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:08:47.411318 [debug] [Thread-1 (]: Database Error in model src_listings (models/src/src_listings.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_listings.sql
[0m12:08:47.415548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cecf0f9-0865-46d2-b661-160c13d70600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c279d047400>]}
[0m12:08:47.419028 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model dev.src_listings ......................... [[31mERROR[0m in 0.85s]
[0m12:08:47.422534 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:08:47.425633 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:08:47.430212 [info ] [Thread-1 (]: 3 of 5 START sql table model dev.src_reviews ................................... [RUN]
[0m12:08:47.434012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:08:47.436291 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:08:47.441525 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:08:47.443394 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:08:47.437466 => 12:08:47.442714
[0m12:08:47.444516 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:08:47.451372 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."SRC_REVIEWS" because it is of type view
[0m12:08:47.456407 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."SRC_REVIEWS"
[0m12:08:47.458934 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:08:47.459729 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
drop view if exists "AIRBNB"."DEV"."SRC_REVIEWS" cascade
[0m12:08:47.460490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:48.267671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:08:48.274920 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:08:48.279423 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:08:48.282677 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace transient table AIRBNB.dev.src_reviews
         as
        (with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
        );
[0m12:08:48.527991 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469ac-0000-4377-0000-000052fd4611
[0m12:08:48.530811 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:08:48.535158 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:08:47.445216 => 12:08:48.533873
[0m12:08:48.537707 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:08:48.683402 [debug] [Thread-1 (]: Database Error in model src_reviews (models/src/src_reviews.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_reviews.sql
[0m12:08:48.686489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cecf0f9-0865-46d2-b661-160c13d70600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c279c5b4700>]}
[0m12:08:48.689837 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model dev.src_reviews .......................... [[31mERROR[0m in 1.25s]
[0m12:08:48.693769 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:08:48.696556 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:08:48.699694 [info ] [Thread-1 (]: 4 of 5 SKIP relation dev.dim_hosts_cleansed .................................... [[33mSKIP[0m]
[0m12:08:48.702278 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:08:48.704207 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:08:48.706570 [info ] [Thread-1 (]: 5 of 5 SKIP relation dev.dim_listings_cleansed ................................. [[33mSKIP[0m]
[0m12:08:48.708106 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:08:48.711674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:48.712656 [debug] [MainThread]: Connection 'model.dbtairbnb.src_reviews' was properly closed.
[0m12:08:48.713756 [info ] [MainThread]: 
[0m12:08:48.715674 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 5.56 seconds (5.56s).
[0m12:08:48.717914 [debug] [MainThread]: Command end result
[0m12:08:48.728392 [info ] [MainThread]: 
[0m12:08:48.729680 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:08:48.730409 [info ] [MainThread]: 
[0m12:08:48.731052 [error] [MainThread]:   Database Error in model src_hosts (models/src/src_hosts.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_hosts.sql
[0m12:08:48.731692 [info ] [MainThread]: 
[0m12:08:48.732258 [error] [MainThread]:   Database Error in model src_listings (models/src/src_listings.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_listings.sql
[0m12:08:48.732841 [info ] [MainThread]: 
[0m12:08:48.733402 [error] [MainThread]:   Database Error in model src_reviews (models/src/src_reviews.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_reviews.sql
[0m12:08:48.734009 [info ] [MainThread]: 
[0m12:08:48.734632 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m12:08:48.735680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.3581486, "process_user_time": 3.976341, "process_kernel_time": 0.770639, "process_mem_max_rss": "196780", "process_out_blocks": "1824", "command_success": false, "process_in_blocks": "0"}
[0m12:08:48.736511 [debug] [MainThread]: Command `dbt run` failed at 12:08:48.736282 after 6.36 seconds
[0m12:08:48.737268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c27cac7aa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c279c5a6a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c279c5c13c0>]}
[0m12:08:48.737963 [debug] [MainThread]: Flushing usage events
[0m12:09:18.967353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719eb0f7e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719eaf486380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719eaf486320>]}


============================== 12:09:18.969747 | 102331c7-2ae2-4f8d-b08f-5154ec3e953a ==============================
[0m12:09:18.969747 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:09:18.970409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:09:19.585751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '102331c7-2ae2-4f8d-b08f-5154ec3e953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719eaf486470>]}
[0m12:09:19.642163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '102331c7-2ae2-4f8d-b08f-5154ec3e953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719eaf485c90>]}
[0m12:09:19.642963 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:09:19.649626 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:09:19.678972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:19.679511 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:19.684865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '102331c7-2ae2-4f8d-b08f-5154ec3e953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719e83c94610>]}
[0m12:09:19.692916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '102331c7-2ae2-4f8d-b08f-5154ec3e953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719e83c65c30>]}
[0m12:09:19.693596 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:09:19.694118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '102331c7-2ae2-4f8d-b08f-5154ec3e953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719e83c66500>]}
[0m12:09:19.695733 [info ] [MainThread]: 
[0m12:09:19.696557 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:09:19.697950 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:09:19.711029 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:09:19.711643 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:09:19.712220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:20.651822 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:09:20.653922 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:09:20.782095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:09:20.815582 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:09:20.817280 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:09:20.818723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:21.597899 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m12:09:21.604821 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:09:21.740276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '102331c7-2ae2-4f8d-b08f-5154ec3e953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719e83b3bca0>]}
[0m12:09:21.741368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:09:21.742215 [info ] [MainThread]: 
[0m12:09:21.744399 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:09:21.745067 [info ] [Thread-1 (]: 1 of 5 START sql table model dev.src_hosts ..................................... [RUN]
[0m12:09:21.745914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:09:21.746451 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:09:21.754113 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:09:21.755029 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:09:21.746792 => 12:09:21.754733
[0m12:09:21.755820 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:09:21.784757 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:09:21.785886 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:09:21.786431 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace transient table AIRBNB.dev.src_hosts
         as
        (with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
        );
[0m12:09:21.786958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:22.831347 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469ad-0000-437b-0000-000052fd5635
[0m12:09:22.832068 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:09:22.832956 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:09:21.756324 => 12:09:22.832661
[0m12:09:22.833558 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:09:22.929238 [debug] [Thread-1 (]: Database Error in model src_hosts (models/src/src_hosts.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_hosts.sql
[0m12:09:22.932189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '102331c7-2ae2-4f8d-b08f-5154ec3e953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719e83bbbd00>]}
[0m12:09:22.935441 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model dev.src_hosts ............................ [[31mERROR[0m in 1.19s]
[0m12:09:22.938961 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:09:22.941669 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:09:22.948383 [info ] [Thread-1 (]: 2 of 5 START sql table model dev.src_listings .................................. [RUN]
[0m12:09:22.954373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:09:22.958494 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:09:22.975217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:09:22.978626 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:09:22.961160 => 12:09:22.977522
[0m12:09:22.980793 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:09:22.990408 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:09:22.993149 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:09:22.994160 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace transient table AIRBNB.dev.src_listings
         as
        (with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
        );
[0m12:09:22.994932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:23.903782 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469ad-0000-437b-0000-000052fd5639
[0m12:09:23.906412 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:09:23.909738 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:09:22.982174 => 12:09:23.908475
[0m12:09:23.912182 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:09:24.049066 [debug] [Thread-1 (]: Database Error in model src_listings (models/src/src_listings.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_listings.sql
[0m12:09:24.051877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '102331c7-2ae2-4f8d-b08f-5154ec3e953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719e83b93c10>]}
[0m12:09:24.055037 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model dev.src_listings ......................... [[31mERROR[0m in 1.10s]
[0m12:09:24.059361 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:09:24.063369 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:09:24.066652 [info ] [Thread-1 (]: 3 of 5 START sql table model dev.src_reviews ................................... [RUN]
[0m12:09:24.068883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:09:24.070288 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:09:24.074807 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:09:24.076828 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:09:24.071156 => 12:09:24.075862
[0m12:09:24.078190 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:09:24.083473 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:09:24.084946 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:09:24.085786 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace transient table AIRBNB.dev.src_reviews
         as
        (with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
        );
[0m12:09:24.086547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:24.825395 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469ad-0000-4377-0000-000052fd4639
[0m12:09:24.828104 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:09:24.831479 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:09:24.078782 => 12:09:24.830238
[0m12:09:24.834028 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:09:24.962373 [debug] [Thread-1 (]: Database Error in model src_reviews (models/src/src_reviews.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_reviews.sql
[0m12:09:24.965167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '102331c7-2ae2-4f8d-b08f-5154ec3e953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719e83b93a90>]}
[0m12:09:24.968396 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model dev.src_reviews .......................... [[31mERROR[0m in 0.90s]
[0m12:09:24.972011 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:09:24.975398 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:09:24.978702 [info ] [Thread-1 (]: 4 of 5 SKIP relation dev.dim_hosts_cleansed .................................... [[33mSKIP[0m]
[0m12:09:24.981809 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:09:24.984483 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:09:24.988032 [info ] [Thread-1 (]: 5 of 5 SKIP relation dev.dim_listings_cleansed ................................. [[33mSKIP[0m]
[0m12:09:24.991356 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:09:25.000544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:25.004687 [debug] [MainThread]: Connection 'model.dbtairbnb.src_reviews' was properly closed.
[0m12:09:25.008838 [info ] [MainThread]: 
[0m12:09:25.010987 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m12:09:25.014663 [debug] [MainThread]: Command end result
[0m12:09:25.029701 [info ] [MainThread]: 
[0m12:09:25.030748 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:09:25.031588 [info ] [MainThread]: 
[0m12:09:25.032439 [error] [MainThread]:   Database Error in model src_hosts (models/src/src_hosts.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_hosts.sql
[0m12:09:25.033291 [info ] [MainThread]: 
[0m12:09:25.034060 [error] [MainThread]:   Database Error in model src_listings (models/src/src_listings.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_listings.sql
[0m12:09:25.034849 [info ] [MainThread]: 
[0m12:09:25.035538 [error] [MainThread]:   Database Error in model src_reviews (models/src/src_reviews.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_reviews.sql
[0m12:09:25.036347 [info ] [MainThread]: 
[0m12:09:25.037422 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m12:09:25.038854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.1124344, "process_user_time": 3.656612, "process_kernel_time": 0.741633, "process_mem_max_rss": "196060", "process_out_blocks": "1824", "command_success": false, "process_in_blocks": "0"}
[0m12:09:25.039748 [debug] [MainThread]: Command `dbt run` failed at 12:09:25.039529 after 6.11 seconds
[0m12:09:25.040426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719eb0f7e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719e8190f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719e8190cb80>]}
[0m12:09:25.041063 [debug] [MainThread]: Flushing usage events
[0m12:09:42.658625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa0a5b29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa088be3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa088be380>]}


============================== 12:09:42.661137 | 12b08dd5-b7ac-4abc-b01f-f67d6a3fa2ea ==============================
[0m12:09:42.661137 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:09:42.661915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:09:43.276607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12b08dd5-b7ac-4abc-b01f-f67d6a3fa2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa088be4d0>]}
[0m12:09:43.332803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12b08dd5-b7ac-4abc-b01f-f67d6a3fa2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9e17d0a90>]}
[0m12:09:43.333658 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:09:43.340244 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:09:43.367931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:43.368497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:43.373685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12b08dd5-b7ac-4abc-b01f-f67d6a3fa2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9e1457d60>]}
[0m12:09:43.381387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12b08dd5-b7ac-4abc-b01f-f67d6a3fa2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9e141dcc0>]}
[0m12:09:43.382092 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:09:43.382685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12b08dd5-b7ac-4abc-b01f-f67d6a3fa2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9e141e620>]}
[0m12:09:43.384262 [info ] [MainThread]: 
[0m12:09:43.385091 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:09:43.386491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:09:43.399685 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:09:43.400340 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:09:43.400871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:44.282323 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:09:44.289143 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:09:44.426943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:09:44.461763 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:09:44.463089 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:09:44.464281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:44.896225 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:09:44.902737 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:09:45.030696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12b08dd5-b7ac-4abc-b01f-f67d6a3fa2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9e128ac20>]}
[0m12:09:45.035847 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:09:45.039738 [info ] [MainThread]: 
[0m12:09:45.048195 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:09:45.051092 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:09:45.055235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:09:45.057852 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:09:45.079769 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:09:45.081971 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:09:45.059660 => 12:09:45.081238
[0m12:09:45.083087 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:09:45.118805 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:09:45.119840 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:09:45.120390 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:09:45.120919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:46.331341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:09:46.382898 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:09:45.083681 => 12:09:46.382501
[0m12:09:46.383720 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:09:46.493434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12b08dd5-b7ac-4abc-b01f-f67d6a3fa2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9e0084040>]}
[0m12:09:46.496957 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.44s]
[0m12:09:46.500438 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:09:46.503231 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:09:46.504613 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m12:09:46.505586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:09:46.506139 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:09:46.509243 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:09:46.510494 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:09:46.506469 => 12:09:46.510088
[0m12:09:46.511075 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:09:46.515733 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:09:46.517615 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:09:46.518249 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:09:46.518829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:47.206260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:09:47.219440 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:09:46.511421 => 12:09:47.217712
[0m12:09:47.223661 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:09:47.298822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12b08dd5-b7ac-4abc-b01f-f67d6a3fa2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9e0086c20>]}
[0m12:09:47.302182 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.79s]
[0m12:09:47.305858 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:09:47.308578 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:09:47.311930 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m12:09:47.316123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:09:47.319037 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:09:47.327001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:09:47.329347 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:09:47.320860 => 12:09:47.328616
[0m12:09:47.330911 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:09:47.339417 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:09:47.341114 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:09:47.342126 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:09:47.343355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:48.741940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:09:48.746616 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:09:47.332536 => 12:09:48.746350
[0m12:09:48.747277 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:09:48.880514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12b08dd5-b7ac-4abc-b01f-f67d6a3fa2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9e0086080>]}
[0m12:09:48.883920 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.57s]
[0m12:09:48.887492 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:09:48.890222 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:09:48.893716 [info ] [Thread-1 (]: 4 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:09:48.897821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:09:48.900338 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:09:48.911982 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:09:48.913983 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:09:48.902095 => 12:09:48.913258
[0m12:09:48.915329 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:09:48.924467 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:09:48.926169 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:09:48.927143 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    

with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:09:48.927939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:49.708922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:09:49.715785 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:09:48.916206 => 12:09:49.715520
[0m12:09:49.716328 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:09:49.844019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12b08dd5-b7ac-4abc-b01f-f67d6a3fa2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9e09ec400>]}
[0m12:09:49.847500 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.95s]
[0m12:09:49.851117 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:09:49.853817 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:09:49.857216 [info ] [Thread-1 (]: 5 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:09:49.861379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:09:49.863912 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:09:49.875750 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:09:49.878428 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:09:49.865528 => 12:09:49.877123
[0m12:09:49.880053 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:09:49.887361 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:09:49.889188 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:09:49.890099 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    

with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:09:49.890861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:50.938465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:09:50.943531 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:09:49.880750 => 12:09:50.943263
[0m12:09:50.944080 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:09:51.074958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12b08dd5-b7ac-4abc-b01f-f67d6a3fa2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9e0106680>]}
[0m12:09:51.078321 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.21s]
[0m12:09:51.082006 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:09:51.088591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:51.091075 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_cleansed' was properly closed.
[0m12:09:51.093580 [info ] [MainThread]: 
[0m12:09:51.096039 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.71 seconds (7.71s).
[0m12:09:51.102444 [debug] [MainThread]: Command end result
[0m12:09:51.127416 [info ] [MainThread]: 
[0m12:09:51.128521 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:51.129358 [info ] [MainThread]: 
[0m12:09:51.130239 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:09:51.131734 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.519568, "process_user_time": 4.005056, "process_kernel_time": 0.848223, "process_mem_max_rss": "196136", "process_out_blocks": "1848", "process_in_blocks": "0"}
[0m12:09:51.132884 [debug] [MainThread]: Command `dbt run` succeeded at 12:09:51.132567 after 8.52 seconds
[0m12:09:51.133858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa0a5b29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9e09ec400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9e1760ac0>]}
[0m12:09:51.135250 [debug] [MainThread]: Flushing usage events
[0m12:11:26.856432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce459ba9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce43cc6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce43cc6320>]}


============================== 12:11:26.858817 | 11f474c6-510d-42b9-9249-2dc68f9774b8 ==============================
[0m12:11:26.858817 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:11:26.859433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:11:27.484053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11f474c6-510d-42b9-9249-2dc68f9774b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce43cc6470>]}
[0m12:11:27.541454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11f474c6-510d-42b9-9249-2dc68f9774b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce1c909cc0>]}
[0m12:11:27.542289 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:11:27.548940 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:11:27.575492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:27.576043 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:27.581249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11f474c6-510d-42b9-9249-2dc68f9774b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce1c7c0610>]}
[0m12:11:27.588890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11f474c6-510d-42b9-9249-2dc68f9774b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce1c791c60>]}
[0m12:11:27.589482 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:11:27.590119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11f474c6-510d-42b9-9249-2dc68f9774b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce1c7925c0>]}
[0m12:11:27.592167 [info ] [MainThread]: 
[0m12:11:27.593609 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:11:27.595044 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:11:27.608183 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:11:27.608750 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:11:27.609219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:28.633158 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:11:28.640046 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:11:28.731305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:11:28.764924 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:11:28.766035 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:11:28.766953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:29.859228 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:11:29.865172 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:11:29.993253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11f474c6-510d-42b9-9249-2dc68f9774b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce1c66bd00>]}
[0m12:11:29.994619 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:11:29.995422 [info ] [MainThread]: 
[0m12:11:29.998360 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:11:29.999342 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:11:30.000622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:11:30.001577 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:11:30.015073 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:11:30.016841 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:11:30.002190 => 12:11:30.016234
[0m12:11:30.018212 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:11:30.055526 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:11:30.056641 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:11:30.057312 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:11:30.058264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:30.773614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:11:30.825770 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:11:30.018984 => 12:11:30.825446
[0m12:11:30.826485 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:11:30.936824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f474c6-510d-42b9-9249-2dc68f9774b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce1c427b50>]}
[0m12:11:30.939430 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.94s]
[0m12:11:30.941871 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:11:30.943708 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:11:30.946287 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m12:11:30.948111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:11:30.949251 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:11:30.954327 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:11:30.955732 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:11:30.950017 => 12:11:30.955259
[0m12:11:30.956948 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:11:30.963350 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:11:30.965123 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:11:30.966028 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:11:30.966882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:32.010509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:11:32.026983 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:11:30.957789 => 12:11:32.025693
[0m12:11:32.029947 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:11:32.165036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f474c6-510d-42b9-9249-2dc68f9774b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce1c424af0>]}
[0m12:11:32.166292 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.22s]
[0m12:11:32.167511 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:11:32.168466 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:11:32.169588 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m12:11:32.170988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:11:32.171854 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:11:32.175135 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:11:32.176424 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:11:32.172411 => 12:11:32.175961
[0m12:11:32.177318 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:11:32.184565 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:11:32.186271 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:11:32.187205 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:11:32.188084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:32.935030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:11:32.949613 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:11:32.177893 => 12:11:32.948377
[0m12:11:32.952147 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:11:33.030297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f474c6-510d-42b9-9249-2dc68f9774b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce1c425570>]}
[0m12:11:33.033639 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.86s]
[0m12:11:33.037014 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:11:33.039720 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:11:33.042713 [info ] [Thread-1 (]: 4 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:11:33.046300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:11:33.048773 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:11:33.059180 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:11:33.061398 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:11:33.050821 => 12:11:33.060605
[0m12:11:33.062785 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:11:33.071436 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:11:33.073050 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:11:33.073856 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:11:33.074724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:34.773419 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:11:34.777555 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:11:33.063512 => 12:11:34.777195
[0m12:11:34.778277 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:11:34.873104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f474c6-510d-42b9-9249-2dc68f9774b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce1c46c0d0>]}
[0m12:11:34.876552 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.83s]
[0m12:11:34.880280 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:11:34.883103 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:11:34.886370 [info ] [Thread-1 (]: 5 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:11:34.889987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:11:34.892951 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:11:34.905216 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:11:34.907764 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:11:34.894862 => 12:11:34.906969
[0m12:11:34.909027 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:11:34.915746 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:11:34.917549 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:11:34.918452 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:11:34.919235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:35.809831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:11:35.815876 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:11:34.909750 => 12:11:35.815338
[0m12:11:35.816978 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:11:35.923989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f474c6-510d-42b9-9249-2dc68f9774b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce1c44f700>]}
[0m12:11:35.927546 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.03s]
[0m12:11:35.932328 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:11:35.939521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:35.940835 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_cleansed' was properly closed.
[0m12:11:35.942254 [info ] [MainThread]: 
[0m12:11:35.943925 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 8.35 seconds (8.35s).
[0m12:11:35.947916 [debug] [MainThread]: Command end result
[0m12:11:35.960497 [info ] [MainThread]: 
[0m12:11:35.961499 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:35.962215 [info ] [MainThread]: 
[0m12:11:35.962874 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:11:35.964048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.148861, "process_user_time": 3.983503, "process_kernel_time": 0.838212, "process_mem_max_rss": "195656", "process_out_blocks": "1864", "process_in_blocks": "0"}
[0m12:11:35.964909 [debug] [MainThread]: Command `dbt run` succeeded at 12:11:35.964703 after 9.15 seconds
[0m12:11:35.965608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce459ba9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce1cb4fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dce1c46cdc0>]}
[0m12:11:35.966574 [debug] [MainThread]: Flushing usage events
[0m12:16:40.958730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730ea87ae9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730ea6aba440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730ea6aba3e0>]}


============================== 12:16:40.961247 | 72e1c630-73bd-4eed-8bc7-7b231d29f5d0 ==============================
[0m12:16:40.961247 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:16:40.962157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:16:41.586094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72e1c630-73bd-4eed-8bc7-7b231d29f5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730ea6aba530>]}
[0m12:16:41.644110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72e1c630-73bd-4eed-8bc7-7b231d29f5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7b8db580>]}
[0m12:16:41.644979 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:16:41.651656 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:16:41.678179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:16:41.678780 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:16:41.684726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72e1c630-73bd-4eed-8bc7-7b231d29f5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7b54cbb0>]}
[0m12:16:41.697264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72e1c630-73bd-4eed-8bc7-7b231d29f5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7b51e170>]}
[0m12:16:41.698484 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:16:41.699492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72e1c630-73bd-4eed-8bc7-7b231d29f5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7b51eaa0>]}
[0m12:16:41.702319 [info ] [MainThread]: 
[0m12:16:41.703766 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:41.705875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:16:41.722083 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:16:41.722694 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:16:41.723369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:42.679161 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:16:42.685487 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:16:42.768579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:16:42.800022 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:16:42.801107 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:16:42.802097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:43.657606 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:16:43.664525 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:16:43.830149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72e1c630-73bd-4eed-8bc7-7b231d29f5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7b382f20>]}
[0m12:16:43.834132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:43.836305 [info ] [MainThread]: 
[0m12:16:43.842589 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:16:43.844218 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:16:43.846336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:16:43.847887 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:16:43.862677 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:16:43.864131 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:16:43.848749 => 12:16:43.863576
[0m12:16:43.865056 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:16:43.898845 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:16:43.900308 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:16:43.900900 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:16:43.901428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:45.030177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:45.083725 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:16:43.865637 => 12:16:45.083382
[0m12:16:45.084451 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:16:45.207226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e1c630-73bd-4eed-8bc7-7b231d29f5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7aae37c0>]}
[0m12:16:45.211040 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.36s]
[0m12:16:45.214503 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:16:45.217146 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:16:45.220997 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m12:16:45.224881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:16:45.227637 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:16:45.235581 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:16:45.237569 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:16:45.229150 => 12:16:45.236783
[0m12:16:45.238902 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:16:45.246067 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:16:45.247879 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:16:45.249087 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:16:45.250008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:46.099994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:46.107755 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:16:45.239620 => 12:16:46.107150
[0m12:16:46.109031 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:16:46.225890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e1c630-73bd-4eed-8bc7-7b231d29f5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7b442ad0>]}
[0m12:16:46.229278 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.00s]
[0m12:16:46.233250 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:16:46.236284 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:16:46.240150 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dev.src_reviews ............................. [RUN]
[0m12:16:46.244996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:16:46.248039 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:16:46.261967 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:16:46.263309 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:16:46.249673 => 12:16:46.262861
[0m12:16:46.264111 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:16:46.301945 [debug] [Thread-1 (]: Dropping relation AIRBNB.dev.src_reviews because it is a view and this model is a table.
[0m12:16:46.308843 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."SRC_REVIEWS"
[0m12:16:46.315667 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:16:46.316293 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
drop view if exists "AIRBNB"."DEV"."SRC_REVIEWS" cascade
[0m12:16:46.316818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:46.797576 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:16:46.830763 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:16:46.832374 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:16:46.833156 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace transient table AIRBNB.dev.src_reviews
         as
        (

with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from
    raw_reviews

    
        );
[0m12:16:47.013470 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469b4-0000-437b-0000-000052fd56dd
[0m12:16:47.016248 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:16:47.019706 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:16:46.264613 => 12:16:47.018424
[0m12:16:47.022267 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:16:47.138614 [debug] [Thread-1 (]: Database Error in model src_reviews (models/src/src_reviews.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_reviews.sql
[0m12:16:47.141427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e1c630-73bd-4eed-8bc7-7b231d29f5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e791d1660>]}
[0m12:16:47.144749 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model dev.src_reviews .................... [[31mERROR[0m in 0.90s]
[0m12:16:47.150290 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:16:47.155008 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:16:47.160587 [info ] [Thread-1 (]: 4 of 6 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:16:47.164023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:16:47.166210 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:16:47.174697 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:16:47.176821 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:16:47.167335 => 12:16:47.176075
[0m12:16:47.178158 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:16:47.186189 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:16:47.188298 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:16:47.189522 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:16:47.190677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:48.097954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:48.101643 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:16:47.178971 => 12:16:48.101228
[0m12:16:48.102489 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:16:48.253849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e1c630-73bd-4eed-8bc7-7b231d29f5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7aaa57b0>]}
[0m12:16:48.256206 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.09s]
[0m12:16:48.258801 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:16:48.260850 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:16:48.263401 [info ] [Thread-1 (]: 5 of 6 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:16:48.267340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:16:48.269549 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:16:48.279597 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:16:48.284128 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:16:48.270760 => 12:16:48.282519
[0m12:16:48.287263 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:16:48.297722 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:16:48.301689 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:16:48.302943 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:16:48.303944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:49.031753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:49.036368 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:16:48.288500 => 12:16:49.035989
[0m12:16:49.037149 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:16:49.150111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e1c630-73bd-4eed-8bc7-7b231d29f5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7914f310>]}
[0m12:16:49.151943 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.88s]
[0m12:16:49.153805 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:16:49.155306 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m12:16:49.156900 [info ] [Thread-1 (]: 6 of 6 SKIP relation dev.fct_reviews ........................................... [[33mSKIP[0m]
[0m12:16:49.158594 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m12:16:49.163285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:49.165170 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_cleansed' was properly closed.
[0m12:16:49.166803 [info ] [MainThread]: 
[0m12:16:49.168175 [info ] [MainThread]: Finished running 5 view models, 1 incremental model in 0 hours 0 minutes and 7.46 seconds (7.46s).
[0m12:16:49.172411 [debug] [MainThread]: Command end result
[0m12:16:49.191400 [info ] [MainThread]: 
[0m12:16:49.192543 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:16:49.193628 [info ] [MainThread]: 
[0m12:16:49.194836 [error] [MainThread]:   Database Error in model src_reviews (models/src/src_reviews.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/src/src_reviews.sql
[0m12:16:49.196108 [info ] [MainThread]: 
[0m12:16:49.197281 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m12:16:49.199306 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.28185, "process_user_time": 4.193902, "process_kernel_time": 0.700317, "process_mem_max_rss": "197456", "process_out_blocks": "1872", "command_success": false, "process_in_blocks": "0"}
[0m12:16:49.200673 [debug] [MainThread]: Command `dbt run` failed at 12:16:49.200356 after 8.28 seconds
[0m12:16:49.201661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730ea87ae9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7914f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7914fb80>]}
[0m12:16:49.202608 [debug] [MainThread]: Flushing usage events
[0m12:18:51.065107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5f63b29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5f46be3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5f46be380>]}


============================== 12:18:51.067549 | 5a5e012b-b67f-44f5-a219-b25f5007dcd0 ==============================
[0m12:18:51.067549 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:18:51.068281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:18:51.690151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a5e012b-b67f-44f5-a219-b25f5007dcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5f46be4d0>]}
[0m12:18:51.746936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a5e012b-b67f-44f5-a219-b25f5007dcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5cd538a90>]}
[0m12:18:51.747754 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:18:51.754477 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:18:51.789432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:51.790705 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:51.796463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a5e012b-b67f-44f5-a219-b25f5007dcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5cd1b8b50>]}
[0m12:18:51.804579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a5e012b-b67f-44f5-a219-b25f5007dcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5cd18a1a0>]}
[0m12:18:51.805174 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:18:51.805964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a5e012b-b67f-44f5-a219-b25f5007dcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5cd18ab00>]}
[0m12:18:51.807642 [info ] [MainThread]: 
[0m12:18:51.808459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:18:51.809891 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:18:51.823925 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:18:51.824553 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:18:51.825032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:52.702350 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:18:52.708743 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:18:52.833945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:18:52.845138 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:18:52.845904 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:18:52.846442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:53.568413 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:18:53.577219 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:18:53.676901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a5e012b-b67f-44f5-a219-b25f5007dcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5ccff4b20>]}
[0m12:18:53.679433 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:18:53.680722 [info ] [MainThread]: 
[0m12:18:53.683888 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:18:53.684983 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:18:53.686308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:18:53.687081 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:18:53.698308 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:18:53.699492 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:18:53.687565 => 12:18:53.699078
[0m12:18:53.700258 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:18:53.736592 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:18:53.737955 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:18:53.738574 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:18:53.739175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:54.229212 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:18:54.266682 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:18:53.700742 => 12:18:54.266362
[0m12:18:54.267381 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:18:54.353158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5e012b-b67f-44f5-a219-b25f5007dcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5cc614e50>]}
[0m12:18:54.354748 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.67s]
[0m12:18:54.356354 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:18:54.358175 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:18:54.360848 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m12:18:54.363430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:18:54.364917 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:18:54.370353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:18:54.371705 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:18:54.365648 => 12:18:54.371166
[0m12:18:54.372771 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:18:54.378686 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:18:54.380129 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:18:54.380833 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:18:54.381514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:55.257140 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:18:55.271644 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:18:54.373363 => 12:18:55.270462
[0m12:18:55.274366 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:18:55.403372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5e012b-b67f-44f5-a219-b25f5007dcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5cc616200>]}
[0m12:18:55.406705 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.04s]
[0m12:18:55.410059 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:18:55.412676 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:18:55.417464 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dev.src_reviews ............................. [RUN]
[0m12:18:55.423635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:18:55.426901 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:18:55.447194 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:18:55.449708 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:18:55.429328 => 12:18:55.448839
[0m12:18:55.451325 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:18:55.513202 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:18:55.515125 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:18:55.515962 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace transient table AIRBNB.dev.src_reviews
         as
        (

with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from
    raw_reviews

    
        );
[0m12:18:55.516594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:00.172713 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m12:19:00.206056 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.src_reviews__dbt_tmp
[0m12:19:00.217675 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:19:00.218592 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
drop view if exists AIRBNB.dev.src_reviews__dbt_tmp cascade
[0m12:19:00.293838 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:19:00.297863 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:18:55.452328 => 12:19:00.297580
[0m12:19:00.298399 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:19:00.387493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5e012b-b67f-44f5-a219-b25f5007dcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5cc6146a0>]}
[0m12:19:00.390975 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model dev.src_reviews ........................ [[32mSUCCESS 1[0m in 4.97s]
[0m12:19:00.394428 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:19:00.397087 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:19:00.400614 [info ] [Thread-1 (]: 4 of 6 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:19:00.404310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:19:00.406827 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:19:00.417807 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:19:00.420980 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:19:00.408497 => 12:19:00.420019
[0m12:19:00.422350 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:19:00.430432 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:19:00.432083 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:19:00.433070 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:19:00.434025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:01.399210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:19:01.413126 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:19:00.423261 => 12:19:01.411938
[0m12:19:01.415777 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:19:01.506626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5e012b-b67f-44f5-a219-b25f5007dcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5cc6bbdc0>]}
[0m12:19:01.510514 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.10s]
[0m12:19:01.514456 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:19:01.516861 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:19:01.519035 [info ] [Thread-1 (]: 5 of 6 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:19:01.521703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:19:01.523248 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:19:01.531341 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:19:01.533144 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:19:01.524177 => 12:19:01.532548
[0m12:19:01.534273 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:19:01.541907 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:19:01.543867 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:19:01.544870 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:19:01.545885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:02.319691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:19:02.323795 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:19:01.535033 => 12:19:02.323390
[0m12:19:02.324740 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:19:02.462702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5e012b-b67f-44f5-a219-b25f5007dcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5cc615120>]}
[0m12:19:02.466056 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.94s]
[0m12:19:02.469588 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:19:02.472286 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m12:19:02.475446 [info ] [Thread-1 (]: 6 of 6 START sql view model dev.fct_reviews .................................... [RUN]
[0m12:19:02.479367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m12:19:02.481916 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m12:19:02.495734 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m12:19:02.497611 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 12:19:02.483666 => 12:19:02.497029
[0m12:19:02.498681 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m12:19:02.505336 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m12:19:02.507655 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:19:02.508519 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace   view AIRBNB.dev.fct_reviews
  
   as (
    with src_reviews as (select * from AIRBNB.dev.src_reviews)
select *
from src_reviews
where review_text is not null
  );
[0m12:19:02.509295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:03.414575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:19:03.426268 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 12:19:02.499368 => 12:19:03.425404
[0m12:19:03.427789 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m12:19:03.547767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5e012b-b67f-44f5-a219-b25f5007dcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5cc6a0070>]}
[0m12:19:03.549105 [info ] [Thread-1 (]: 6 of 6 OK created sql view model dev.fct_reviews ............................... [[32mSUCCESS 1[0m in 1.07s]
[0m12:19:03.550489 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m12:19:03.553119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:03.554027 [debug] [MainThread]: Connection 'model.dbtairbnb.fct_reviews' was properly closed.
[0m12:19:03.554934 [info ] [MainThread]: 
[0m12:19:03.555936 [info ] [MainThread]: Finished running 5 view models, 1 incremental model in 0 hours 0 minutes and 11.75 seconds (11.75s).
[0m12:19:03.558750 [debug] [MainThread]: Command end result
[0m12:19:03.571741 [info ] [MainThread]: 
[0m12:19:03.572869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:19:03.573951 [info ] [MainThread]: 
[0m12:19:03.574949 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:19:03.576584 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.551832, "process_user_time": 4.102185, "process_kernel_time": 0.770582, "process_mem_max_rss": "196304", "process_in_blocks": "72", "process_out_blocks": "1888"}
[0m12:19:03.578305 [debug] [MainThread]: Command `dbt run` succeeded at 12:19:03.577730 after 12.55 seconds
[0m12:19:03.579821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5f63b29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5f46be4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b5cc6dd720>]}
[0m12:19:03.580868 [debug] [MainThread]: Flushing usage events
[0m12:19:37.933921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fd637e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fd4886380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fd4886320>]}


============================== 12:19:37.936281 | 017f7620-e7f0-40a4-9003-70bf7758f0a8 ==============================
[0m12:19:37.936281 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:19:37.937122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:19:38.554009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '017f7620-e7f0-40a4-9003-70bf7758f0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fd4886470>]}
[0m12:19:38.611357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '017f7620-e7f0-40a4-9003-70bf7758f0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fad541cc0>]}
[0m12:19:38.612166 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:19:38.619209 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:19:38.646947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:19:38.647520 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:19:38.652916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '017f7620-e7f0-40a4-9003-70bf7758f0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fad180af0>]}
[0m12:19:38.661634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '017f7620-e7f0-40a4-9003-70bf7758f0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fad152140>]}
[0m12:19:38.662268 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:19:38.662793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '017f7620-e7f0-40a4-9003-70bf7758f0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fad152aa0>]}
[0m12:19:38.664441 [info ] [MainThread]: 
[0m12:19:38.665276 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:19:38.666837 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:19:38.679406 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:19:38.679987 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:19:38.680475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:39.623270 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:19:39.630088 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:19:39.765818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:19:39.778745 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:19:39.779397 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:19:39.779988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:40.423553 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:19:40.430878 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:19:40.725554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '017f7620-e7f0-40a4-9003-70bf7758f0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fad1b2f50>]}
[0m12:19:40.729400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:40.731880 [info ] [MainThread]: 
[0m12:19:40.740047 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:19:40.742923 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:19:40.746489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:19:40.749873 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:19:40.767460 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:19:40.768819 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:19:40.751915 => 12:19:40.768348
[0m12:19:40.769750 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:19:40.815777 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:19:40.816840 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:19:40.817384 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:19:40.817987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:41.554855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:19:41.608832 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:19:40.770244 => 12:19:41.608485
[0m12:19:41.609571 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:19:41.731242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017f7620-e7f0-40a4-9003-70bf7758f0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fac7178b0>]}
[0m12:19:41.734566 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.99s]
[0m12:19:41.738034 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:19:41.740705 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:19:41.744353 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m12:19:41.748035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:19:41.750669 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:19:41.763528 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:19:41.765591 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:19:41.752592 => 12:19:41.764843
[0m12:19:41.766897 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:19:41.774365 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:19:41.776145 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:19:41.777021 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:19:41.777806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:42.559210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:19:42.580289 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:19:41.767614 => 12:19:42.579075
[0m12:19:42.582841 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:19:42.718600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017f7620-e7f0-40a4-9003-70bf7758f0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fac79b730>]}
[0m12:19:42.721879 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.97s]
[0m12:19:42.725433 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:19:42.728119 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:19:42.731527 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dev.src_reviews ............................. [RUN]
[0m12:19:42.735130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:19:42.737613 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:19:42.761155 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:19:42.762859 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:19:42.739369 => 12:19:42.762354
[0m12:19:42.763791 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:19:42.805203 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:19:42.805924 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace  temporary view AIRBNB.dev.src_reviews__dbt_tmp
  
   as (
    

with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from
    raw_reviews

    
        and review_date > (select max(review_date) from AIRBNB.dev.src_reviews)
    
  );
[0m12:19:42.806463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:43.239117 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469b7-0000-4377-0000-000052fd4715
[0m12:19:43.241748 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 8 unexpected 'and'.
syntax error line 17 at position 51 unexpected 'from'.
[0m12:19:43.245111 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:19:42.764450 => 12:19:43.243849
[0m12:19:43.247608 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:19:43.402166 [debug] [Thread-1 (]: Database Error in model src_reviews (models/src/src_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 8 unexpected 'and'.
  syntax error line 17 at position 51 unexpected 'from'.
[0m12:19:43.402988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017f7620-e7f0-40a4-9003-70bf7758f0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fac5e3e50>]}
[0m12:19:43.403878 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model dev.src_reviews .................... [[31mERROR[0m in 0.67s]
[0m12:19:43.404890 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:19:43.405709 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:19:43.407339 [info ] [Thread-1 (]: 4 of 6 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:19:43.408397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:19:43.409131 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:19:43.413173 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:19:43.414266 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:19:43.409612 => 12:19:43.413882
[0m12:19:43.415000 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:19:43.422418 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:19:43.423821 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:19:43.424586 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:19:43.425334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:44.400203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:19:44.414635 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:19:43.415481 => 12:19:44.413388
[0m12:19:44.417099 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:19:44.549737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017f7620-e7f0-40a4-9003-70bf7758f0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fac61a1d0>]}
[0m12:19:44.553013 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.14s]
[0m12:19:44.556415 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:19:44.559373 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:19:44.562866 [info ] [Thread-1 (]: 5 of 6 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:19:44.566576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:19:44.569108 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:19:44.581173 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:19:44.583330 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:19:44.570973 => 12:19:44.582621
[0m12:19:44.584680 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:19:44.592236 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:19:44.594099 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:19:44.595002 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:19:44.595760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:45.616111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:19:45.631415 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:19:44.585436 => 12:19:45.630208
[0m12:19:45.634072 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:19:45.795766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017f7620-e7f0-40a4-9003-70bf7758f0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fad076d10>]}
[0m12:19:45.799137 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.23s]
[0m12:19:45.802568 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:19:45.805215 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m12:19:45.808248 [info ] [Thread-1 (]: 6 of 6 SKIP relation dev.fct_reviews ........................................... [[33mSKIP[0m]
[0m12:19:45.811406 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m12:19:45.818273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:45.820516 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_cleansed' was properly closed.
[0m12:19:45.822883 [info ] [MainThread]: 
[0m12:19:45.826729 [info ] [MainThread]: Finished running 5 view models, 1 incremental model in 0 hours 0 minutes and 7.16 seconds (7.16s).
[0m12:19:45.834559 [debug] [MainThread]: Command end result
[0m12:19:45.856802 [info ] [MainThread]: 
[0m12:19:45.858488 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:19:45.859818 [info ] [MainThread]: 
[0m12:19:45.860724 [error] [MainThread]:   Database Error in model src_reviews (models/src/src_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 8 unexpected 'and'.
  syntax error line 17 at position 51 unexpected 'from'.
[0m12:19:45.861447 [info ] [MainThread]: 
[0m12:19:45.862692 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m12:19:45.864895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.971852, "process_user_time": 4.106545, "process_kernel_time": 0.815738, "process_mem_max_rss": "197068", "process_in_blocks": "48", "process_out_blocks": "1864", "command_success": false}
[0m12:19:45.866283 [debug] [MainThread]: Command `dbt run` failed at 12:19:45.865872 after 7.97 seconds
[0m12:19:45.867578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fd637e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fad541cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fac60d5d0>]}
[0m12:19:45.868824 [debug] [MainThread]: Flushing usage events
[0m12:22:03.889111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7f0f26e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7f0d776380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7f0d776320>]}


============================== 12:22:03.891591 | c4d52e38-4d53-4334-a6ec-f7aedf89e069 ==============================
[0m12:22:03.891591 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:22:03.892344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:22:04.505875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4d52e38-4d53-4334-a6ec-f7aedf89e069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7f0d776470>]}
[0m12:22:04.570455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4d52e38-4d53-4334-a6ec-f7aedf89e069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee2449cc0>]}
[0m12:22:04.571361 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:22:04.577993 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:22:04.607555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:22:04.608553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:22:04.614721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4d52e38-4d53-4334-a6ec-f7aedf89e069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee2104610>]}
[0m12:22:04.622645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4d52e38-4d53-4334-a6ec-f7aedf89e069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee20d5c60>]}
[0m12:22:04.623263 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:22:04.623817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d52e38-4d53-4334-a6ec-f7aedf89e069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee20d65c0>]}
[0m12:22:04.625439 [info ] [MainThread]: 
[0m12:22:04.626331 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:22:04.627697 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:22:04.641052 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:22:04.641698 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:22:04.642193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:05.498000 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:22:05.504458 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:22:05.645232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:22:05.678740 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:22:05.679991 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:22:05.681157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:06.611014 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:22:06.613163 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:22:06.743456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d52e38-4d53-4334-a6ec-f7aedf89e069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee2136d70>]}
[0m12:22:06.749943 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:06.753880 [info ] [MainThread]: 
[0m12:22:06.762598 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:22:06.765234 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:22:06.768211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:22:06.770072 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:22:06.785784 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:22:06.787010 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:22:06.771317 => 12:22:06.786521
[0m12:22:06.788115 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:22:06.822115 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:22:06.823134 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:22:06.823678 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:22:06.824388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:07.840328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:22:07.870956 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:22:06.788906 => 12:22:07.870605
[0m12:22:07.871699 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:22:07.983316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d52e38-4d53-4334-a6ec-f7aedf89e069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee0558e20>]}
[0m12:22:07.984541 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.22s]
[0m12:22:07.985795 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:22:07.986846 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:22:07.988168 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m12:22:07.989578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:22:07.990740 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:22:07.995676 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:22:07.997108 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:22:07.991447 => 12:22:07.996596
[0m12:22:07.998079 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:22:08.005624 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:22:08.007502 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:22:08.008732 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:22:08.009722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:08.850091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:22:08.864781 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:22:07.998694 => 12:22:08.863571
[0m12:22:08.867362 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:22:08.984029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d52e38-4d53-4334-a6ec-f7aedf89e069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee0559de0>]}
[0m12:22:08.985323 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.99s]
[0m12:22:08.986632 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:22:08.987646 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:22:08.988971 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m12:22:08.990421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:22:08.991396 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:22:08.995300 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:22:08.996662 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:22:08.992066 => 12:22:08.996192
[0m12:22:08.997562 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:22:09.009969 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."SRC_REVIEWS" because it is of type table
[0m12:22:09.019632 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."SRC_REVIEWS"
[0m12:22:09.026699 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:22:09.027466 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
drop table if exists "AIRBNB"."DEV"."SRC_REVIEWS" cascade
[0m12:22:09.028008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:09.685207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:22:09.695087 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:22:09.699425 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:22:09.702018 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:22:09.965378 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:22:09.978512 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:22:08.998139 => 12:22:09.976866
[0m12:22:09.981027 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:22:10.105174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d52e38-4d53-4334-a6ec-f7aedf89e069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee055ae60>]}
[0m12:22:10.108755 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.11s]
[0m12:22:10.112499 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:22:10.115514 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:22:10.118705 [info ] [Thread-1 (]: 4 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:22:10.122361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:22:10.125228 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:22:10.139617 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:22:10.141265 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:22:10.127784 => 12:22:10.140687
[0m12:22:10.142808 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:22:10.148849 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:22:10.150969 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:22:10.151721 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:22:10.152397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:10.914291 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:22:10.928803 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:22:10.143612 => 12:22:10.927581
[0m12:22:10.931637 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:22:11.030109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d52e38-4d53-4334-a6ec-f7aedf89e069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee05bb550>]}
[0m12:22:11.033877 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.91s]
[0m12:22:11.037602 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:22:11.040416 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:22:11.043755 [info ] [Thread-1 (]: 5 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:22:11.047441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:22:11.049956 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:22:11.060206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:22:11.062163 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:22:11.051577 => 12:22:11.061459
[0m12:22:11.063236 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:22:11.071439 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:22:11.073115 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:22:11.073929 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:22:11.074713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:11.658345 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:22:11.672611 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:22:11.063921 => 12:22:11.671401
[0m12:22:11.675136 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:22:11.780951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d52e38-4d53-4334-a6ec-f7aedf89e069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee05a0df0>]}
[0m12:22:11.782418 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.73s]
[0m12:22:11.783675 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:22:11.786189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:11.787137 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_cleansed' was properly closed.
[0m12:22:11.787878 [info ] [MainThread]: 
[0m12:22:11.788804 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.16 seconds (7.16s).
[0m12:22:11.792126 [debug] [MainThread]: Command end result
[0m12:22:11.806716 [info ] [MainThread]: 
[0m12:22:11.807771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:22:11.808697 [info ] [MainThread]: 
[0m12:22:11.809524 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:22:11.810817 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9622817, "process_user_time": 4.1543, "process_kernel_time": 0.777691, "process_mem_max_rss": "196172", "process_out_blocks": "1872", "process_in_blocks": "0"}
[0m12:22:11.812061 [debug] [MainThread]: Command `dbt run` succeeded at 12:22:11.811772 after 7.96 seconds
[0m12:22:11.813140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7f0f26e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee240fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee05934f0>]}
[0m12:22:11.814193 [debug] [MainThread]: Flushing usage events
[0m12:23:11.363615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceda66769b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceda4b7e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceda4b7e3b0>]}


============================== 12:23:11.366092 | 82ee3690-ed05-4fde-9138-fa53c2de4736 ==============================
[0m12:23:11.366092 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:23:11.366734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:23:12.008249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82ee3690-ed05-4fde-9138-fa53c2de4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceda4b7e500>]}
[0m12:23:12.075257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82ee3690-ed05-4fde-9138-fa53c2de4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced7d725ff0>]}
[0m12:23:12.076124 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:23:12.084046 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:23:12.121467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:23:12.122069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:23:12.127623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82ee3690-ed05-4fde-9138-fa53c2de4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced7d420b80>]}
[0m12:23:12.136348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82ee3690-ed05-4fde-9138-fa53c2de4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced7d3f21a0>]}
[0m12:23:12.137006 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:23:12.137563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82ee3690-ed05-4fde-9138-fa53c2de4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced7d3f2a70>]}
[0m12:23:12.139314 [info ] [MainThread]: 
[0m12:23:12.140207 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:23:12.141717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:23:12.159930 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:23:12.160538 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:23:12.161039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:13.084543 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:23:13.091478 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:23:13.177731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:23:13.190227 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:23:13.190987 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:23:13.191615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:13.883215 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:23:13.890151 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:23:13.989106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82ee3690-ed05-4fde-9138-fa53c2de4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced7d3f23b0>]}
[0m12:23:13.991457 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:23:13.992942 [info ] [MainThread]: 
[0m12:23:13.997047 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:23:13.998353 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:23:14.000143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:23:14.001064 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:23:14.013367 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:23:14.014818 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:23:14.001672 => 12:23:14.014279
[0m12:23:14.015766 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:23:14.050779 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:23:14.051818 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:23:14.052362 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:23:14.052888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:14.817053 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:14.867843 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:23:14.016554 => 12:23:14.867496
[0m12:23:14.868573 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:23:14.980942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ee3690-ed05-4fde-9138-fa53c2de4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced7c9b7940>]}
[0m12:23:14.984645 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.98s]
[0m12:23:14.988323 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:23:14.991113 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:23:14.995013 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m12:23:14.998850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:23:15.001956 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:23:15.010713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:23:15.012712 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:23:15.003620 => 12:23:15.012013
[0m12:23:15.014194 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:23:15.021597 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:23:15.023416 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:23:15.024533 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:23:15.025554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:15.728351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:15.751553 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:23:15.014988 => 12:23:15.749423
[0m12:23:15.755499 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:23:15.913788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ee3690-ed05-4fde-9138-fa53c2de4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced7d3f2740>]}
[0m12:23:15.917265 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.92s]
[0m12:23:15.920789 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:23:15.924230 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:23:15.929033 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.src_reviews .................................... [RUN]
[0m12:23:15.933296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:23:15.935923 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:23:15.943348 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:23:15.945362 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:23:15.937242 => 12:23:15.944649
[0m12:23:15.946553 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:23:15.954628 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:23:15.956492 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:23:15.957963 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:23:15.959434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:16.955392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:16.970198 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:23:15.947243 => 12:23:16.968937
[0m12:23:16.972410 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:23:17.104403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ee3690-ed05-4fde-9138-fa53c2de4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced7c083dc0>]}
[0m12:23:17.107748 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.17s]
[0m12:23:17.111384 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:23:17.114107 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:23:17.117911 [info ] [Thread-1 (]: 4 of 6 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:23:17.121735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:23:17.124558 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:23:17.134772 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:23:17.136797 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:23:17.126484 => 12:23:17.136085
[0m12:23:17.137903 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:23:17.146017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:23:17.147648 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:23:17.148571 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:23:17.149369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:17.942066 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:17.963943 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:23:17.138599 => 12:23:17.962525
[0m12:23:17.966397 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:23:18.114291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ee3690-ed05-4fde-9138-fa53c2de4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced7c0cfaf0>]}
[0m12:23:18.115184 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.99s]
[0m12:23:18.116025 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:23:18.116660 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:23:18.117418 [info ] [Thread-1 (]: 5 of 6 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:23:18.118345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:23:18.118922 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:23:18.122306 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:23:18.123355 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:23:18.119267 => 12:23:18.122894
[0m12:23:18.123941 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:23:18.128175 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:23:18.130296 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:23:18.131028 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:23:18.131669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:19.412461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:19.427803 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:23:18.124299 => 12:23:19.426581
[0m12:23:19.430384 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:23:19.563894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ee3690-ed05-4fde-9138-fa53c2de4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced7c0bd000>]}
[0m12:23:19.567219 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.45s]
[0m12:23:19.570660 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:23:19.573373 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m12:23:19.576507 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m12:23:19.580124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m12:23:19.582650 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m12:23:19.600349 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m12:23:19.601834 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 12:23:19.584412 => 12:23:19.601317
[0m12:23:19.602761 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m12:23:19.641380 [debug] [Thread-1 (]: Dropping relation AIRBNB.dev.fct_reviews because it is a view and this model is a table.
[0m12:23:19.647756 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."FCT_REVIEWS"
[0m12:23:19.653548 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:23:19.654110 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists "AIRBNB"."DEV"."FCT_REVIEWS" cascade
[0m12:23:19.654636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:20.332948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:20.347819 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m12:23:20.348842 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:23:20.349445 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace transient table AIRBNB.dev.fct_reviews
         as
        (
with src_reviews as (select * from AIRBNB.dev.src_reviews)
select *
from src_reviews
where
    review_text is not null
    
        );
[0m12:23:20.644697 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469bb-0000-437b-0000-000052fd5745
[0m12:23:20.647329 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:23:20.649649 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 12:23:19.603344 => 12:23:20.648975
[0m12:23:20.650814 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m12:23:20.805199 [debug] [Thread-1 (]: Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/fct/fct_reviews.sql
[0m12:23:20.806094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ee3690-ed05-4fde-9138-fa53c2de4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced7ca3b9a0>]}
[0m12:23:20.806913 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model dev.fct_reviews .................... [[31mERROR[0m in 1.23s]
[0m12:23:20.807782 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m12:23:20.810072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:20.810577 [debug] [MainThread]: Connection 'model.dbtairbnb.fct_reviews' was properly closed.
[0m12:23:20.811102 [info ] [MainThread]: 
[0m12:23:20.811723 [info ] [MainThread]: Finished running 5 view models, 1 incremental model in 0 hours 0 minutes and 8.67 seconds (8.67s).
[0m12:23:20.814253 [debug] [MainThread]: Command end result
[0m12:23:20.825629 [info ] [MainThread]: 
[0m12:23:20.826353 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:23:20.826875 [info ] [MainThread]: 
[0m12:23:20.827623 [error] [MainThread]:   Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/fct/fct_reviews.sql
[0m12:23:20.828496 [info ] [MainThread]: 
[0m12:23:20.829591 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m12:23:20.830766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.508694, "process_user_time": 4.236203, "process_kernel_time": 0.906332, "process_mem_max_rss": "197572", "process_out_blocks": "1888", "command_success": false, "process_in_blocks": "0"}
[0m12:23:20.831600 [debug] [MainThread]: Command `dbt run` failed at 12:23:20.831353 after 9.51 seconds
[0m12:23:20.832200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceda66769b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceda4b7dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced7d31b3a0>]}
[0m12:23:20.832847 [debug] [MainThread]: Flushing usage events
[0m12:30:19.331336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d71e1bb29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d71dfebe380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d71dfebe320>]}


============================== 12:30:19.333743 | 42ba1ea2-0ca0-48c0-a88d-6a528a826690 ==============================
[0m12:30:19.333743 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:30:19.334397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:19.947976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42ba1ea2-0ca0-48c0-a88d-6a528a826690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d71dfebe470>]}
[0m12:30:20.005096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42ba1ea2-0ca0-48c0-a88d-6a528a826690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d71b8b99cc0>]}
[0m12:30:20.005964 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:30:20.012704 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:30:20.039509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:30:20.040048 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:30:20.045199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42ba1ea2-0ca0-48c0-a88d-6a528a826690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d71b8a50af0>]}
[0m12:30:20.052408 [error] [MainThread]: Encountered an error:
Found a cycle: model.dbtairbnb.fct_reviews
[0m12:30:20.057166 [error] [MainThread]: Traceback (most recent call last):
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/task/runnable.py", line 482, in run
    self._runtime_initialize()
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/task/compile.py", line 147, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/task/runnable.py", line 144, in _runtime_initialize
    self.compile_manifest()
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/compilation.py", line 455, in compile
    linker.link_graph(manifest)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/compilation.py", line 200, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.dbtairbnb.fct_reviews

[0m12:30:20.060106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7695893, "process_user_time": 2.864128, "process_kernel_time": 0.77678, "process_mem_max_rss": "187576", "process_in_blocks": "128", "process_out_blocks": "856", "command_success": false}
[0m12:30:20.061910 [debug] [MainThread]: Command `dbt run` failed at 12:30:20.061403 after 0.77 seconds
[0m12:30:20.063270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d71e1bb29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d71b8a21d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d71b8a22aa0>]}
[0m12:30:20.064038 [debug] [MainThread]: Flushing usage events
[0m12:31:05.559572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c3d5769e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c3ba7e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c3ba7e3e0>]}


============================== 12:31:05.561976 | 7a3d5591-a68b-41f4-ac63-1b60b2b29a02 ==============================
[0m12:31:05.561976 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:31:05.562745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'version_check': 'True', 'profiles_dir': '/home/lkeiti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:31:06.176254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a3d5591-a68b-41f4-ac63-1b60b2b29a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c3ba7e530>]}
[0m12:31:06.233495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a3d5591-a68b-41f4-ac63-1b60b2b29a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c1461f580>]}
[0m12:31:06.234341 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:31:06.240957 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:31:06.269844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:31:06.270393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:31:06.275746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a3d5591-a68b-41f4-ac63-1b60b2b29a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c14318bb0>]}
[0m12:31:06.284347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a3d5591-a68b-41f4-ac63-1b60b2b29a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c142ea1d0>]}
[0m12:31:06.285007 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:31:06.285633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a3d5591-a68b-41f4-ac63-1b60b2b29a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c142eaaa0>]}
[0m12:31:06.287333 [info ] [MainThread]: 
[0m12:31:06.288220 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:06.290047 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:31:06.302880 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:31:06.303461 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:31:06.303944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:07.552583 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:31:07.559774 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:31:07.664565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:31:07.687274 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:31:07.688210 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:31:07.689061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:08.225778 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:31:08.232245 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:31:08.384661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a3d5591-a68b-41f4-ac63-1b60b2b29a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c1434af20>]}
[0m12:31:08.388797 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:08.391601 [info ] [MainThread]: 
[0m12:31:08.399603 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:31:08.402488 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:31:08.406294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:31:08.408754 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:31:08.429878 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:31:08.431478 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:31:08.410452 => 12:31:08.430921
[0m12:31:08.432397 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:31:08.463418 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:31:08.464666 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:31:08.465221 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:31:08.465805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:09.394677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:31:09.448703 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:31:08.432958 => 12:31:09.448359
[0m12:31:09.449423 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:31:09.583141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3d5591-a68b-41f4-ac63-1b60b2b29a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c140af7c0>]}
[0m12:31:09.584416 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.18s]
[0m12:31:09.585935 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:31:09.586967 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:31:09.587899 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m12:31:09.589230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:31:09.589965 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:31:09.594990 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:31:09.596702 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:31:09.590576 => 12:31:09.596052
[0m12:31:09.597936 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:31:09.603829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:31:09.604939 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:31:09.605478 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:31:09.606149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:10.325292 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:31:10.342928 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:31:09.598797 => 12:31:10.341693
[0m12:31:10.345636 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:31:10.474052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3d5591-a68b-41f4-ac63-1b60b2b29a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c1420ead0>]}
[0m12:31:10.477725 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.88s]
[0m12:31:10.483582 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:31:10.487286 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:31:10.491832 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.src_reviews .................................... [RUN]
[0m12:31:10.497515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:31:10.500381 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:31:10.507878 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:31:10.510500 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:31:10.501948 => 12:31:10.509514
[0m12:31:10.512140 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:31:10.521617 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:31:10.523939 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:31:10.525189 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:31:10.526287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:11.236226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:31:11.250579 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:31:10.513162 => 12:31:11.249268
[0m12:31:11.253129 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:31:11.338731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3d5591-a68b-41f4-ac63-1b60b2b29a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c14175810>]}
[0m12:31:11.342097 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.84s]
[0m12:31:11.345716 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:31:11.348537 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:31:11.352842 [info ] [Thread-1 (]: 4 of 6 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:31:11.358948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:31:11.361879 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:31:11.370177 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:31:11.371774 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:31:11.363104 => 12:31:11.371212
[0m12:31:11.372985 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:31:11.381531 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:31:11.383599 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:31:11.384564 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:31:11.385228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:12.155446 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:31:12.158959 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:31:11.373932 => 12:31:12.158670
[0m12:31:12.159555 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:31:12.274889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3d5591-a68b-41f4-ac63-1b60b2b29a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c0df47f10>]}
[0m12:31:12.278161 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.92s]
[0m12:31:12.281959 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:31:12.284702 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:31:12.287905 [info ] [Thread-1 (]: 5 of 6 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:31:12.291631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:31:12.294230 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:31:12.306988 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:31:12.309122 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:31:12.295935 => 12:31:12.308441
[0m12:31:12.310442 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:31:12.319079 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:31:12.320882 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:31:12.321804 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:31:12.322726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:13.152768 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:31:13.167013 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:31:12.311304 => 12:31:13.165915
[0m12:31:13.168741 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:31:13.302377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3d5591-a68b-41f4-ac63-1b60b2b29a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c0df63f40>]}
[0m12:31:13.303484 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.01s]
[0m12:31:13.304580 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:31:13.305433 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m12:31:13.306419 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m12:31:13.307556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m12:31:13.308492 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m12:31:13.321239 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m12:31:13.323392 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 12:31:13.309061 => 12:31:13.322618
[0m12:31:13.324686 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m12:31:13.387155 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m12:31:13.388360 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:31:13.388980 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace transient table AIRBNB.dev.fct_reviews
         as
        (

with src_reviews as (select * from AIRBNB.dev.src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        );
[0m12:31:13.389590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:14.045598 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b469c3-0000-437b-0000-000052fd5781
[0m12:31:14.048210 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m12:31:14.051617 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 12:31:13.325520 => 12:31:14.050347
[0m12:31:14.054171 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m12:31:14.170418 [debug] [Thread-1 (]: Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/fct/fct_reviews.sql
[0m12:31:14.173608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3d5591-a68b-41f4-ac63-1b60b2b29a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c0deff430>]}
[0m12:31:14.176812 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model dev.fct_reviews .................... [[31mERROR[0m in 0.87s]
[0m12:31:14.180329 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m12:31:14.189311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:14.192059 [debug] [MainThread]: Connection 'model.dbtairbnb.fct_reviews' was properly closed.
[0m12:31:14.194729 [info ] [MainThread]: 
[0m12:31:14.197131 [info ] [MainThread]: Finished running 5 view models, 1 incremental model in 0 hours 0 minutes and 7.91 seconds (7.91s).
[0m12:31:14.206264 [debug] [MainThread]: Command end result
[0m12:31:14.232097 [info ] [MainThread]: 
[0m12:31:14.233049 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:31:14.233885 [info ] [MainThread]: 
[0m12:31:14.234711 [error] [MainThread]:   Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/dbtairbnb/models/fct/fct_reviews.sql
[0m12:31:14.235556 [info ] [MainThread]: 
[0m12:31:14.236319 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m12:31:14.237609 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.719906, "process_user_time": 4.251999, "process_kernel_time": 0.805515, "process_mem_max_rss": "197284", "process_out_blocks": "1880", "command_success": false, "process_in_blocks": "0"}
[0m12:31:14.238685 [debug] [MainThread]: Command `dbt run` failed at 12:31:14.238368 after 8.72 seconds
[0m12:31:14.239481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c3d5769e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c0df47970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793c0df47fd0>]}
[0m12:31:14.240265 [debug] [MainThread]: Flushing usage events
[0m12:33:01.481564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a39411a29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a393f6aa380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a393f6aa320>]}


============================== 12:33:01.483987 | 642c5780-ef3c-4042-9a1b-7b5027b54f44 ==============================
[0m12:33:01.483987 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:33:01.484853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/lkeiti/.dbt', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:33:02.107249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '642c5780-ef3c-4042-9a1b-7b5027b54f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a393f6aa470>]}
[0m12:33:02.164711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '642c5780-ef3c-4042-9a1b-7b5027b54f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3918085cc0>]}
[0m12:33:02.165692 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:33:02.173446 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:33:02.205662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:33:02.206224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:33:02.211492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '642c5780-ef3c-4042-9a1b-7b5027b54f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3913ebcaf0>]}
[0m12:33:02.219428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '642c5780-ef3c-4042-9a1b-7b5027b54f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3913e8e140>]}
[0m12:33:02.220032 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:33:02.220567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '642c5780-ef3c-4042-9a1b-7b5027b54f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3913e8eaa0>]}
[0m12:33:02.222332 [info ] [MainThread]: 
[0m12:33:02.223243 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:33:02.224626 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:33:02.237686 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:33:02.238263 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:33:02.238730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:03.170398 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:33:03.176642 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:33:03.281570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:33:03.315867 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:33:03.317194 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:33:03.318382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:04.142336 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:33:04.148332 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:33:04.268251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '642c5780-ef3c-4042-9a1b-7b5027b54f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3913ee9210>]}
[0m12:33:04.269216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:04.269817 [info ] [MainThread]: 
[0m12:33:04.271907 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:33:04.272646 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:33:04.273607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:33:04.274147 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:33:04.282317 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:33:04.283343 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:33:04.274524 => 12:33:04.282950
[0m12:33:04.283906 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:33:04.312452 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:33:04.313465 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:33:04.314070 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:33:04.314604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:05.205533 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:33:05.259485 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:33:04.284255 => 12:33:05.259140
[0m12:33:05.260201 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:33:05.364381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642c5780-ef3c-4042-9a1b-7b5027b54f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a39134e0cd0>]}
[0m12:33:05.367721 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.09s]
[0m12:33:05.371436 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:33:05.374171 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:33:05.378209 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m12:33:05.382057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:33:05.384555 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:33:05.395507 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:33:05.397451 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:33:05.386927 => 12:33:05.396752
[0m12:33:05.398794 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:33:05.406774 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:33:05.408667 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:33:05.409565 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:33:05.410991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:06.124988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:33:06.140019 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:33:05.399532 => 12:33:06.138664
[0m12:33:06.142565 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:33:06.249698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642c5780-ef3c-4042-9a1b-7b5027b54f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a39134e2bc0>]}
[0m12:33:06.253239 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.87s]
[0m12:33:06.257213 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:33:06.260177 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:33:06.263899 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.src_reviews .................................... [RUN]
[0m12:33:06.267485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:33:06.269957 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:33:06.277942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:33:06.281008 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:33:06.271855 => 12:33:06.280165
[0m12:33:06.282389 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:33:06.292279 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:33:06.294806 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:33:06.296118 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:33:06.297346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:07.007469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:33:07.022771 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:33:06.283264 => 12:33:07.021293
[0m12:33:07.025546 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:33:07.161564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642c5780-ef3c-4042-9a1b-7b5027b54f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a39134e09d0>]}
[0m12:33:07.162367 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.90s]
[0m12:33:07.163106 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:33:07.163683 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:33:07.164268 [info ] [Thread-1 (]: 4 of 6 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:33:07.165028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:33:07.165609 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:33:07.168431 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:33:07.169643 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:33:07.165955 => 12:33:07.169170
[0m12:33:07.170194 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:33:07.175232 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:33:07.176388 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:33:07.177023 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:33:07.177650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:08.275266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:33:08.289477 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:33:07.170533 => 12:33:08.288270
[0m12:33:08.292224 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:33:08.433631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642c5780-ef3c-4042-9a1b-7b5027b54f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3911b67e50>]}
[0m12:33:08.436937 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.27s]
[0m12:33:08.440540 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:33:08.443340 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:33:08.446660 [info ] [Thread-1 (]: 5 of 6 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:33:08.450386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:33:08.453009 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:33:08.462127 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:33:08.464461 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:33:08.454383 => 12:33:08.463843
[0m12:33:08.465565 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:33:08.475216 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:33:08.477958 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:33:08.479195 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:33:08.480332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:09.292404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:33:09.306685 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:33:08.466301 => 12:33:09.305345
[0m12:33:09.309229 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:33:09.445018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642c5780-ef3c-4042-9a1b-7b5027b54f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3911b7e6b0>]}
[0m12:33:09.448413 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.00s]
[0m12:33:09.451900 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:33:09.454562 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m12:33:09.457838 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m12:33:09.461460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m12:33:09.463940 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m12:33:09.484756 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m12:33:09.486864 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 12:33:09.465565 => 12:33:09.486247
[0m12:33:09.487809 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m12:33:09.538691 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m12:33:09.539750 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:33:09.540335 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace transient table AIRBNB.dev.fct_reviews
         as
        (

with src_reviews as (select * from AIRBNB.dev.src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        );
[0m12:33:09.540875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:14.482483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m12:33:14.515360 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m12:33:14.527173 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:33:14.528143 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m12:33:14.612798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:33:14.625720 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 12:33:09.488401 => 12:33:14.624498
[0m12:33:14.628196 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m12:33:14.757625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642c5780-ef3c-4042-9a1b-7b5027b54f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3911b51f30>]}
[0m12:33:14.762760 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 1[0m in 5.30s]
[0m12:33:14.768301 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m12:33:14.779795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:14.784889 [debug] [MainThread]: Connection 'model.dbtairbnb.fct_reviews' was properly closed.
[0m12:33:14.788863 [info ] [MainThread]: 
[0m12:33:14.792118 [info ] [MainThread]: Finished running 5 view models, 1 incremental model in 0 hours 0 minutes and 12.56 seconds (12.56s).
[0m12:33:14.799069 [debug] [MainThread]: Command end result
[0m12:33:14.815062 [info ] [MainThread]: 
[0m12:33:14.815806 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:33:14.816366 [info ] [MainThread]: 
[0m12:33:14.817039 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:33:14.818725 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.377145, "process_user_time": 4.248948, "process_kernel_time": 0.807815, "process_mem_max_rss": "196792", "process_out_blocks": "1888", "process_in_blocks": "0"}
[0m12:33:14.820314 [debug] [MainThread]: Command `dbt run` succeeded at 12:33:14.819881 after 13.38 seconds
[0m12:33:14.821300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a39411a29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3911b1b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3911b53430>]}
[0m12:33:14.822335 [debug] [MainThread]: Flushing usage events
[0m12:35:23.451918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdfcfb69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdfb2c23b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdfb2c2350>]}


============================== 12:35:23.454332 | 896dec84-57e6-461c-90b4-7ae9609ebd91 ==============================
[0m12:35:23.454332 [info ] [MainThread]: Running with dbt=1.7.14
[0m12:35:23.455119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'debug': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:35:24.057978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '896dec84-57e6-461c-90b4-7ae9609ebd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdfb2c24a0>]}
[0m12:35:24.114465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '896dec84-57e6-461c-90b4-7ae9609ebd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdd41e6440>]}
[0m12:35:24.115300 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:35:24.122298 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m12:35:24.152410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:24.152991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:24.158420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '896dec84-57e6-461c-90b4-7ae9609ebd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdcfdd0b20>]}
[0m12:35:24.166411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '896dec84-57e6-461c-90b4-7ae9609ebd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdcfda2170>]}
[0m12:35:24.167027 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:35:24.167551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '896dec84-57e6-461c-90b4-7ae9609ebd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdcfda2ad0>]}
[0m12:35:24.169186 [info ] [MainThread]: 
[0m12:35:24.170070 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:35:24.171470 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:35:24.184014 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:35:24.184597 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:35:24.185304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:24.995995 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:35:25.002450 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:35:25.101053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:35:25.136938 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:35:25.138547 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:35:25.139713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:26.204219 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:35:26.211222 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:35:26.351256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '896dec84-57e6-461c-90b4-7ae9609ebd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdcfdfe8c0>]}
[0m12:35:26.355355 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:26.359253 [info ] [MainThread]: 
[0m12:35:26.368092 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m12:35:26.369785 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.src_hosts ...................................... [RUN]
[0m12:35:26.370614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m12:35:26.371191 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m12:35:26.378223 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m12:35:26.379040 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 12:35:26.371525 => 12:35:26.378770
[0m12:35:26.379602 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m12:35:26.413242 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m12:35:26.414788 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m12:35:26.415846 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m12:35:26.416996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:27.740467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:35:27.794970 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 12:35:26.379935 => 12:35:27.794624
[0m12:35:27.795701 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m12:35:27.913513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896dec84-57e6-461c-90b4-7ae9609ebd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdcf3638e0>]}
[0m12:35:27.916817 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.54s]
[0m12:35:27.920352 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m12:35:27.923056 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m12:35:27.927771 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m12:35:27.933775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m12:35:27.937138 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m12:35:27.947144 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m12:35:27.949696 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 12:35:27.939010 => 12:35:27.948766
[0m12:35:27.951321 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m12:35:27.959300 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m12:35:27.960943 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m12:35:27.961838 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m12:35:27.962748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:28.662465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:35:28.677993 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 12:35:27.952325 => 12:35:28.676745
[0m12:35:28.680518 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m12:35:28.806239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896dec84-57e6-461c-90b4-7ae9609ebd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdcf3e7970>]}
[0m12:35:28.809558 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.87s]
[0m12:35:28.813194 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m12:35:28.815894 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m12:35:28.819213 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.src_reviews .................................... [RUN]
[0m12:35:28.823273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m12:35:28.825851 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m12:35:28.833945 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m12:35:28.836513 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 12:35:28.827593 => 12:35:28.835583
[0m12:35:28.837982 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m12:35:28.845087 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m12:35:28.846991 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m12:35:28.848043 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m12:35:28.849013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:29.619493 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:35:29.634300 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 12:35:28.838978 => 12:35:29.633021
[0m12:35:29.636861 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m12:35:29.772906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896dec84-57e6-461c-90b4-7ae9609ebd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdcda29630>]}
[0m12:35:29.776220 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.95s]
[0m12:35:29.779622 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m12:35:29.782335 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m12:35:29.785963 [info ] [Thread-1 (]: 4 of 6 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:35:29.789885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m12:35:29.792695 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m12:35:29.803816 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:35:29.805837 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 12:35:29.794493 => 12:35:29.805098
[0m12:35:29.807036 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m12:35:29.815956 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m12:35:29.817458 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m12:35:29.818269 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:35:29.819056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:30.380207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:35:30.394533 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 12:35:29.807733 => 12:35:30.393160
[0m12:35:30.397195 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m12:35:30.509167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896dec84-57e6-461c-90b4-7ae9609ebd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdcda77a90>]}
[0m12:35:30.512473 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.72s]
[0m12:35:30.515937 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m12:35:30.518797 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m12:35:30.522706 [info ] [Thread-1 (]: 5 of 6 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:35:30.528613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m12:35:30.532684 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m12:35:30.544728 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:35:30.547205 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 12:35:30.534679 => 12:35:30.546315
[0m12:35:30.548948 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m12:35:30.558368 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m12:35:30.559911 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m12:35:30.560865 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m12:35:30.562204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:31.430506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:35:31.447588 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 12:35:30.549909 => 12:35:31.445701
[0m12:35:31.450288 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m12:35:31.596346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896dec84-57e6-461c-90b4-7ae9609ebd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdcda643d0>]}
[0m12:35:31.599659 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.07s]
[0m12:35:31.603439 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m12:35:31.606167 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m12:35:31.610248 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m12:35:31.614021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m12:35:31.616558 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m12:35:31.637054 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m12:35:31.638488 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 12:35:31.618395 => 12:35:31.638008
[0m12:35:31.639384 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m12:35:31.674175 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:35:31.674848 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    

with src_reviews as (select * from AIRBNB.dev.src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m12:35:31.675440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:32.364265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:35:32.391883 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:35:32.393303 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m12:35:32.512200 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:35:32.523062 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:35:32.524187 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m12:35:32.630653 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:35:32.654519 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:35:32.655224 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m12:35:32.758570 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:35:32.768172 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:35:32.769463 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m12:35:32.849305 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:35:32.868267 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:35:32.890132 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m12:35:32.891293 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:35:32.892105 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m12:35:33.023821 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:35:33.024505 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:35:33.025095 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m12:35:33.884187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:35:33.887377 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:35:33.890217 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
COMMIT
[0m12:35:34.497918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:35:34.531925 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m12:35:34.542252 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m12:35:34.543059 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m12:35:34.664732 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:35:34.678488 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 12:35:31.639887 => 12:35:34.677258
[0m12:35:34.681005 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m12:35:34.830441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896dec84-57e6-461c-90b4-7ae9609ebd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdcdafb4c0>]}
[0m12:35:34.833811 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 1[0m in 3.22s]
[0m12:35:34.837309 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m12:35:34.844075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:34.846359 [debug] [MainThread]: Connection 'model.dbtairbnb.fct_reviews' was properly closed.
[0m12:35:34.848715 [info ] [MainThread]: 
[0m12:35:34.851431 [info ] [MainThread]: Finished running 5 view models, 1 incremental model in 0 hours 0 minutes and 10.68 seconds (10.68s).
[0m12:35:34.858339 [debug] [MainThread]: Command end result
[0m12:35:34.881590 [info ] [MainThread]: 
[0m12:35:34.882804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:34.884409 [info ] [MainThread]: 
[0m12:35:34.885769 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:35:34.887746 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.476583, "process_user_time": 4.451517, "process_kernel_time": 0.867126, "process_mem_max_rss": "196628", "process_out_blocks": "1904", "process_in_blocks": "0"}
[0m12:35:34.888845 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:34.888580 after 11.48 seconds
[0m12:35:34.889605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdfcfb69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdfb2c24a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cdcdae6140>]}
[0m12:35:34.890382 [debug] [MainThread]: Flushing usage events
[0m13:38:35.280819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f2e1b29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f2c4be410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f2c4be3b0>]}


============================== 13:38:35.283226 | 1925ee2d-c19b-480f-83ab-757a08156dbe ==============================
[0m13:38:35.283226 [info ] [MainThread]: Running with dbt=1.7.14
[0m13:38:35.283932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'fail_fast': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:38:35.910095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1925ee2d-c19b-480f-83ab-757a08156dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f2c4be500>]}
[0m13:38:35.968943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1925ee2d-c19b-480f-83ab-757a08156dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f05329ff0>]}
[0m13:38:35.969794 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:38:35.976526 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m13:38:36.004289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:38:36.004843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:38:36.010211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1925ee2d-c19b-480f-83ab-757a08156dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f04fb10c0>]}
[0m13:38:36.018192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1925ee2d-c19b-480f-83ab-757a08156dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f04f822c0>]}
[0m13:38:36.018810 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:38:36.019357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1925ee2d-c19b-480f-83ab-757a08156dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f04f82fb0>]}
[0m13:38:36.021010 [info ] [MainThread]: 
[0m13:38:36.021910 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:38:36.023380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:38:36.035799 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:38:36.036374 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:38:36.036867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:36.786036 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:38:36.791540 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:38:36.883541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m13:38:36.910368 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m13:38:36.911524 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m13:38:36.912541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:37.560070 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:38:37.567445 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m13:38:37.701430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1925ee2d-c19b-480f-83ab-757a08156dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f043d3490>]}
[0m13:38:37.705299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:38:37.707702 [info ] [MainThread]: 
[0m13:38:37.715679 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m13:38:37.718833 [info ] [Thread-1 (]: 1 of 7 START sql view model dev.src_hosts ...................................... [RUN]
[0m13:38:37.722402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m13:38:37.725121 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m13:38:37.754075 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m13:38:37.755976 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 13:38:37.726952 => 13:38:37.755288
[0m13:38:37.758040 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m13:38:37.790968 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m13:38:37.791995 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m13:38:37.792683 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m13:38:37.793253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:38.652074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:38.705847 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 13:38:37.759146 => 13:38:38.705546
[0m13:38:38.706449 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m13:38:38.882390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1925ee2d-c19b-480f-83ab-757a08156dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f043dbd60>]}
[0m13:38:38.886405 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.16s]
[0m13:38:38.889883 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m13:38:38.893056 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m13:38:38.896632 [info ] [Thread-1 (]: 2 of 7 START sql view model dev.src_listings ................................... [RUN]
[0m13:38:38.900337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m13:38:38.902826 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m13:38:38.912516 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m13:38:38.914496 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 13:38:38.904518 => 13:38:38.913781
[0m13:38:38.915695 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m13:38:38.923418 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m13:38:38.925525 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m13:38:38.926351 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m13:38:38.927171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:39.875441 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:39.882422 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 13:38:38.916375 => 13:38:39.882125
[0m13:38:39.883045 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m13:38:39.994763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1925ee2d-c19b-480f-83ab-757a08156dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f04526230>]}
[0m13:38:39.998050 [info ] [Thread-1 (]: 2 of 7 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.10s]
[0m13:38:40.001418 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m13:38:40.004081 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m13:38:40.007702 [info ] [Thread-1 (]: 3 of 7 START sql view model dev.src_reviews .................................... [RUN]
[0m13:38:40.011377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m13:38:40.013854 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m13:38:40.022543 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m13:38:40.025405 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 13:38:40.015555 => 13:38:40.024413
[0m13:38:40.026767 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m13:38:40.034755 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m13:38:40.036702 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m13:38:40.037940 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m13:38:40.038813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:40.797758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:40.812648 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 13:38:40.027606 => 13:38:40.811424
[0m13:38:40.815170 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m13:38:40.896457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1925ee2d-c19b-480f-83ab-757a08156dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f044179a0>]}
[0m13:38:40.899784 [info ] [Thread-1 (]: 3 of 7 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.89s]
[0m13:38:40.903278 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m13:38:40.906388 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m13:38:40.909653 [info ] [Thread-1 (]: 4 of 7 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m13:38:40.913661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m13:38:40.916190 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m13:38:40.931088 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:38:40.934634 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 13:38:40.917978 => 13:38:40.933303
[0m13:38:40.937084 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m13:38:40.950176 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:38:40.952741 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m13:38:40.954077 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m13:38:40.954971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:42.026704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:42.041603 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 13:38:40.938333 => 13:38:42.040355
[0m13:38:42.044131 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m13:38:42.171182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1925ee2d-c19b-480f-83ab-757a08156dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f044583d0>]}
[0m13:38:42.174496 [info ] [Thread-1 (]: 4 of 7 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.26s]
[0m13:38:42.178160 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m13:38:42.180812 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m13:38:42.184476 [info ] [Thread-1 (]: 5 of 7 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m13:38:42.188860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m13:38:42.192332 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m13:38:42.201916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:38:42.203933 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 13:38:42.194717 => 13:38:42.203206
[0m13:38:42.205103 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m13:38:42.212090 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:38:42.214003 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m13:38:42.214859 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m13:38:42.215633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:42.948367 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:42.964369 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 13:38:42.205823 => 13:38:42.963035
[0m13:38:42.966965 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m13:38:43.052544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1925ee2d-c19b-480f-83ab-757a08156dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f043f78b0>]}
[0m13:38:43.055935 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.87s]
[0m13:38:43.059956 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m13:38:43.062703 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_w_hosts
[0m13:38:43.065960 [info ] [Thread-1 (]: 6 of 7 START sql view model dev.dim_listings_w_hosts ........................... [RUN]
[0m13:38:43.069903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.dim_listings_w_hosts)
[0m13:38:43.072512 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_w_hosts
[0m13:38:43.082311 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:38:43.084971 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (compile): 13:38:43.073949 => 13:38:43.084007
[0m13:38:43.086873 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_w_hosts
[0m13:38:43.097178 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:38:43.100235 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_w_hosts"
[0m13:38:43.101096 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_w_hosts"} */
create or replace   view AIRBNB.dev.dim_listings_w_hosts
  
   as (
    with
    listings as (select * from AIRBNB.dev.src_listings),
    hosts as (select * from AIRBNB.dev.src_hosts)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at

from listings l
left join hosts h on h.host_id = l.host_id
  );
[0m13:38:43.102100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:43.875515 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b46a06-0000-4377-0000-000052fd49d5
[0m13:38:43.878129 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 4
invalid identifier 'L.PRICE'
[0m13:38:43.881473 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (execute): 13:38:43.088094 => 13:38:43.880212
[0m13:38:43.884015 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: Close
[0m13:38:43.970312 [debug] [Thread-1 (]: Database Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'L.PRICE'
  compiled Code at target/run/dbtairbnb/models/dim/dim_listings_w_hosts.sql
[0m13:38:43.972415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1925ee2d-c19b-480f-83ab-757a08156dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f04416c80>]}
[0m13:38:43.975034 [error] [Thread-1 (]: 6 of 7 ERROR creating sql view model dev.dim_listings_w_hosts .................. [[31mERROR[0m in 0.90s]
[0m13:38:43.977546 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_w_hosts
[0m13:38:43.979489 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m13:38:43.983139 [info ] [Thread-1 (]: 7 of 7 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:38:43.986016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_w_hosts, now model.dbtairbnb.fct_reviews)
[0m13:38:43.987854 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m13:38:44.010699 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m13:38:44.011898 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 13:38:43.989105 => 13:38:44.011508
[0m13:38:44.012619 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m13:38:44.048580 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:38:44.049230 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    

with src_reviews as (select * from AIRBNB.dev.src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m13:38:44.049789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:45.098260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:45.128494 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:38:45.129913 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:38:45.289906 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:38:45.298542 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:38:45.299843 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m13:38:45.390489 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:38:45.403734 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:38:45.404390 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:38:45.503496 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:38:45.507767 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:38:45.508472 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:38:45.594487 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:38:45.630001 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:38:45.652276 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m13:38:45.653450 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:38:45.654103 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:38:46.019805 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:38:46.022462 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:38:46.024948 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m13:38:46.940980 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m13:38:46.943329 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:38:46.945543 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
COMMIT
[0m13:38:47.248153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:38:47.282029 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:38:47.294387 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:38:47.295382 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m13:38:47.553037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:38:47.558789 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 13:38:44.013065 => 13:38:47.558254
[0m13:38:47.559778 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m13:38:47.685023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1925ee2d-c19b-480f-83ab-757a08156dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f0446e890>]}
[0m13:38:47.686130 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 3.70s]
[0m13:38:47.687467 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m13:38:47.689917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:47.690927 [debug] [MainThread]: Connection 'model.dbtairbnb.fct_reviews' was properly closed.
[0m13:38:47.691994 [info ] [MainThread]: 
[0m13:38:47.693046 [info ] [MainThread]: Finished running 6 view models, 1 incremental model in 0 hours 0 minutes and 11.67 seconds (11.67s).
[0m13:38:47.696058 [debug] [MainThread]: Command end result
[0m13:38:47.705334 [info ] [MainThread]: 
[0m13:38:47.706066 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:38:47.706719 [info ] [MainThread]: 
[0m13:38:47.707264 [error] [MainThread]:   Database Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'L.PRICE'
  compiled Code at target/run/dbtairbnb/models/dim/dim_listings_w_hosts.sql
[0m13:38:47.707827 [info ] [MainThread]: 
[0m13:38:47.708395 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m13:38:47.709613 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.469726, "process_user_time": 4.581811, "process_kernel_time": 0.807614, "process_mem_max_rss": "198244", "process_out_blocks": "1936", "command_success": false, "process_in_blocks": "0"}
[0m13:38:47.710900 [debug] [MainThread]: Command `dbt run` failed at 13:38:47.710625 after 12.47 seconds
[0m13:38:47.711944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f2e1b29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f2c4be500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4f044581f0>]}
[0m13:38:47.712769 [debug] [MainThread]: Flushing usage events
[0m13:40:07.930889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735e44ae9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735e27ba440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735e27ba3e0>]}


============================== 13:40:07.933936 | 244d7ec2-6fc3-4380-883f-a0d1bef6c86c ==============================
[0m13:40:07.933936 [info ] [MainThread]: Running with dbt=1.7.14
[0m13:40:07.934717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:40:08.550318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '244d7ec2-6fc3-4380-883f-a0d1bef6c86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735e27ba530>]}
[0m13:40:08.608235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '244d7ec2-6fc3-4380-883f-a0d1bef6c86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b75cb580>]}
[0m13:40:08.609055 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:40:08.615769 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m13:40:08.643855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:08.644410 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:08.649849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '244d7ec2-6fc3-4380-883f-a0d1bef6c86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b724d0f0>]}
[0m13:40:08.658334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '244d7ec2-6fc3-4380-883f-a0d1bef6c86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b721e2f0>]}
[0m13:40:08.659090 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:40:08.659634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '244d7ec2-6fc3-4380-883f-a0d1bef6c86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b721efe0>]}
[0m13:40:08.661363 [info ] [MainThread]: 
[0m13:40:08.662279 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:40:08.663767 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:40:08.676642 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:40:08.677306 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:40:08.677936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:10.000455 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:40:10.007050 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:40:10.167839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m13:40:10.205156 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m13:40:10.206498 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m13:40:10.207676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:11.116966 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:40:11.124695 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m13:40:11.226876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '244d7ec2-6fc3-4380-883f-a0d1bef6c86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b7082e00>]}
[0m13:40:11.228413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:11.229362 [info ] [MainThread]: 
[0m13:40:11.232341 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m13:40:11.233242 [info ] [Thread-1 (]: 1 of 7 START sql view model dev.src_hosts ...................................... [RUN]
[0m13:40:11.234293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m13:40:11.234961 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m13:40:11.243369 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m13:40:11.244434 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 13:40:11.235388 => 13:40:11.244065
[0m13:40:11.245131 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_hosts
[0m13:40:11.274056 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_hosts"
[0m13:40:11.275085 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_hosts"
[0m13:40:11.275731 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_hosts"} */
create or replace   view AIRBNB.dev.src_hosts
  
   as (
    with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
  );
[0m13:40:11.276312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:12.038239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:40:12.094526 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (execute): 13:40:11.245577 => 13:40:12.094177
[0m13:40:12.095255 [debug] [Thread-1 (]: On model.dbtairbnb.src_hosts: Close
[0m13:40:12.211430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '244d7ec2-6fc3-4380-883f-a0d1bef6c86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b6873d90>]}
[0m13:40:12.213660 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 0.98s]
[0m13:40:12.215891 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m13:40:12.219052 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m13:40:12.222257 [info ] [Thread-1 (]: 2 of 7 START sql view model dev.src_listings ................................... [RUN]
[0m13:40:12.226809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m13:40:12.229806 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m13:40:12.242747 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m13:40:12.245866 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 13:40:12.231660 => 13:40:12.244643
[0m13:40:12.247908 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_listings
[0m13:40:12.256767 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_listings"
[0m13:40:12.258268 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_listings"
[0m13:40:12.259260 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_listings"} */
create or replace   view AIRBNB.dev.src_listings
  
   as (
    with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
  );
[0m13:40:12.260067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:12.959978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:40:12.974272 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (execute): 13:40:12.249185 => 13:40:12.972829
[0m13:40:12.976737 [debug] [Thread-1 (]: On model.dbtairbnb.src_listings: Close
[0m13:40:13.070770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '244d7ec2-6fc3-4380-883f-a0d1bef6c86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b67c2230>]}
[0m13:40:13.074314 [info ] [Thread-1 (]: 2 of 7 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 0.84s]
[0m13:40:13.077745 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m13:40:13.080372 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m13:40:13.083792 [info ] [Thread-1 (]: 3 of 7 START sql view model dev.src_reviews .................................... [RUN]
[0m13:40:13.087683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m13:40:13.090490 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m13:40:13.100714 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m13:40:13.105187 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 13:40:13.092807 => 13:40:13.103105
[0m13:40:13.108606 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.src_reviews
[0m13:40:13.122818 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.src_reviews"
[0m13:40:13.125872 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.src_reviews"
[0m13:40:13.127225 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.src_reviews"} */
create or replace   view AIRBNB.dev.src_reviews
  
   as (
    with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
  );
[0m13:40:13.128322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:13.882667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:40:13.900213 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (execute): 13:40:13.110267 => 13:40:13.898065
[0m13:40:13.904856 [debug] [Thread-1 (]: On model.dbtairbnb.src_reviews: Close
[0m13:40:14.029195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '244d7ec2-6fc3-4380-883f-a0d1bef6c86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b4eafa90>]}
[0m13:40:14.032528 [info ] [Thread-1 (]: 3 of 7 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 0.94s]
[0m13:40:14.035977 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m13:40:14.038701 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m13:40:14.042539 [info ] [Thread-1 (]: 4 of 7 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m13:40:14.046576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m13:40:14.047914 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m13:40:14.052929 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:40:14.054169 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 13:40:14.048407 => 13:40:14.053730
[0m13:40:14.054744 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m13:40:14.059768 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:40:14.060834 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m13:40:14.061379 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (select * from AIRBNB.dev.src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m13:40:14.062010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:14.805345 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:40:14.820459 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 13:40:14.055087 => 13:40:14.819220
[0m13:40:14.823103 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m13:40:14.970731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '244d7ec2-6fc3-4380-883f-a0d1bef6c86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b67e7f40>]}
[0m13:40:14.974064 [info ] [Thread-1 (]: 4 of 7 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.93s]
[0m13:40:14.977459 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m13:40:14.980505 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m13:40:14.983505 [info ] [Thread-1 (]: 5 of 7 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m13:40:14.987435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m13:40:14.990259 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m13:40:15.001032 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:40:15.003101 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 13:40:14.992401 => 13:40:15.002403
[0m13:40:15.004424 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m13:40:15.011745 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:40:15.013685 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m13:40:15.014664 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    with src_listings as (select * from AIRBNB.dev.src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m13:40:15.015529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:15.726515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:40:15.731690 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 13:40:15.005279 => 13:40:15.731401
[0m13:40:15.732285 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m13:40:15.818439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '244d7ec2-6fc3-4380-883f-a0d1bef6c86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b4f101f0>]}
[0m13:40:15.821801 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.83s]
[0m13:40:15.825489 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m13:40:15.829035 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m13:40:15.832921 [info ] [Thread-1 (]: 6 of 7 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:40:15.836238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m13:40:15.838040 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m13:40:15.861382 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m13:40:15.862978 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 13:40:15.839177 => 13:40:15.862423
[0m13:40:15.864111 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m13:40:15.907467 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:40:15.908239 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    

with src_reviews as (select * from AIRBNB.dev.src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m13:40:15.908820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:16.702369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:40:16.732855 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:40:16.734289 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:40:16.851112 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:40:16.856486 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:40:16.857307 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m13:40:16.958823 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:40:17.000832 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:40:17.001816 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:40:17.092497 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:40:17.100165 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:40:17.101336 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:40:17.208043 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:40:17.241258 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:40:17.261190 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m13:40:17.262296 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:40:17.262912 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:40:17.532622 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:40:17.534126 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:40:17.535478 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m13:40:17.778884 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m13:40:17.781791 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:40:17.784264 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
COMMIT
[0m13:40:18.183314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:40:18.219198 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:40:18.230937 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:40:18.231728 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m13:40:18.367528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:40:18.370565 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 13:40:15.864600 => 13:40:18.370291
[0m13:40:18.371128 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m13:40:18.491113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '244d7ec2-6fc3-4380-883f-a0d1bef6c86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b4d89bd0>]}
[0m13:40:18.494250 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.66s]
[0m13:40:18.497143 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m13:40:18.499461 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_w_hosts
[0m13:40:18.502240 [info ] [Thread-1 (]: 7 of 7 START sql view model dev.dim_listings_w_hosts ........................... [RUN]
[0m13:40:18.505575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.fct_reviews, now model.dbtairbnb.dim_listings_w_hosts)
[0m13:40:18.507901 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_w_hosts
[0m13:40:18.521774 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:40:18.524390 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (compile): 13:40:18.509306 => 13:40:18.523404
[0m13:40:18.525850 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_w_hosts
[0m13:40:18.534565 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:40:18.537158 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_w_hosts"
[0m13:40:18.538237 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_w_hosts"} */
create or replace   view AIRBNB.dev.dim_listings_w_hosts
  
   as (
    with
    listings as (select * from AIRBNB.dev.dim_listings_cleansed),
    hosts as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at

from listings l
left join hosts h on h.host_id = l.host_id
  );
[0m13:40:18.539084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:19.491723 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:40:19.494835 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (execute): 13:40:18.526643 => 13:40:19.494565
[0m13:40:19.495384 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: Close
[0m13:40:19.643063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '244d7ec2-6fc3-4380-883f-a0d1bef6c86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b4f61840>]}
[0m13:40:19.647111 [info ] [Thread-1 (]: 7 of 7 OK created sql view model dev.dim_listings_w_hosts ...................... [[32mSUCCESS 1[0m in 1.14s]
[0m13:40:19.651334 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_w_hosts
[0m13:40:19.660351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:19.662371 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_w_hosts' was properly closed.
[0m13:40:19.664127 [info ] [MainThread]: 
[0m13:40:19.665844 [info ] [MainThread]: Finished running 6 view models, 1 incremental model in 0 hours 0 minutes and 11.00 seconds (11.00s).
[0m13:40:19.670768 [debug] [MainThread]: Command end result
[0m13:40:19.684447 [info ] [MainThread]: 
[0m13:40:19.685863 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:19.686654 [info ] [MainThread]: 
[0m13:40:19.687363 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:40:19.688543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.798644, "process_user_time": 4.598811, "process_kernel_time": 0.819075, "process_mem_max_rss": "197048", "process_out_blocks": "1928", "process_in_blocks": "0"}
[0m13:40:19.689399 [debug] [MainThread]: Command `dbt run` succeeded at 13:40:19.689168 after 11.80 seconds
[0m13:40:19.690512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735e44ae9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b67e7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735b4d88430>]}
[0m13:40:19.691799 [debug] [MainThread]: Flushing usage events
[0m13:42:16.762062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd86c77a9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd86ac86410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd86ac863b0>]}


============================== 13:42:16.764414 | 5db59e64-07e9-4689-ac35-7f216c25027f ==============================
[0m13:42:16.764414 [info ] [MainThread]: Running with dbt=1.7.14
[0m13:42:16.765049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:42:17.388290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5db59e64-07e9-4689-ac35-7f216c25027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd86ac86500>]}
[0m13:42:17.443840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5db59e64-07e9-4689-ac35-7f216c25027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd83f797430>]}
[0m13:42:17.444619 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:42:17.451135 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m13:42:17.479604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:42:17.480138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:42:17.486161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5db59e64-07e9-4689-ac35-7f216c25027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd83f4950c0>]}
[0m13:42:17.495107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5db59e64-07e9-4689-ac35-7f216c25027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd83f4662c0>]}
[0m13:42:17.495717 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:42:17.496221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5db59e64-07e9-4689-ac35-7f216c25027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd83f466fb0>]}
[0m13:42:17.497920 [info ] [MainThread]: 
[0m13:42:17.498741 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:42:17.500048 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:42:17.513542 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:42:17.514191 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:42:17.514696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:18.422259 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:42:18.427217 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:42:18.622867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m13:42:18.657962 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m13:42:18.660168 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m13:42:18.661390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:19.531329 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:42:19.538294 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m13:42:19.630620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5db59e64-07e9-4689-ac35-7f216c25027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd83f3b8520>]}
[0m13:42:19.634498 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:42:19.636814 [info ] [MainThread]: 
[0m13:42:19.644907 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m13:42:19.648695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m13:42:19.651205 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m13:42:19.676137 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m13:42:19.677739 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 13:42:19.652794 => 13:42:19.677166
[0m13:42:19.679589 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m13:42:19.680568 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m13:42:19.682030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m13:42:19.682900 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m13:42:19.685631 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m13:42:19.686732 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 13:42:19.683463 => 13:42:19.686348
[0m13:42:19.688018 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m13:42:19.688787 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m13:42:19.689864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m13:42:19.690520 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m13:42:19.692987 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m13:42:19.694095 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 13:42:19.690939 => 13:42:19.693761
[0m13:42:19.695194 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m13:42:19.695855 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m13:42:19.696789 [info ] [Thread-1 (]: 1 of 4 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m13:42:19.697799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m13:42:19.698430 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m13:42:19.703008 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:42:19.703804 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 13:42:19.698790 => 13:42:19.703527
[0m13:42:19.704359 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m13:42:19.721647 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type view
[0m13:42:19.732181 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED"
[0m13:42:19.740546 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m13:42:19.741156 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m13:42:19.741745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:20.453270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:42:20.498044 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:42:20.500111 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m13:42:20.501036 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.dev.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts as (select * from __dbt__cte__src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
        );
[0m13:42:21.770849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:42:21.815407 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 13:42:19.704704 => 13:42:21.815061
[0m13:42:21.816114 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m13:42:21.951885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db59e64-07e9-4689-ac35-7f216c25027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd83f3a3eb0>]}
[0m13:42:21.955544 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.25s]
[0m13:42:21.958952 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m13:42:21.961598 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m13:42:21.965039 [info ] [Thread-1 (]: 2 of 4 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m13:42:21.970729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m13:42:21.974876 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m13:42:21.996183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:42:21.998080 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 13:42:21.977289 => 13:42:21.997445
[0m13:42:21.999235 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m13:42:22.003349 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type view
[0m13:42:22.010119 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED"
[0m13:42:22.012313 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m13:42:22.012989 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m13:42:22.013589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:22.603047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:42:22.610390 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:42:22.616889 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m13:42:22.619471 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
), src_listings as (select * from __dbt__cte__src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
        );
[0m13:42:23.525989 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:42:23.540507 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 13:42:21.999951 => 13:42:23.539306
[0m13:42:23.542971 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m13:42:23.639778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db59e64-07e9-4689-ac35-7f216c25027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd83eabd300>]}
[0m13:42:23.643116 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.67s]
[0m13:42:23.646731 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m13:42:23.649418 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m13:42:23.653186 [info ] [Thread-1 (]: 3 of 4 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:42:23.659389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m13:42:23.663092 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m13:42:23.689896 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m13:42:23.691563 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 13:42:23.664924 => 13:42:23.690958
[0m13:42:23.692567 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m13:42:23.731629 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:42:23.732275 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m13:42:23.732827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:24.754751 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:42:24.788984 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:42:24.790580 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:42:24.886571 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:42:24.905727 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:42:24.908291 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m13:42:24.983153 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:42:25.026227 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:42:25.027289 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:42:25.110091 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:42:25.120055 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:42:25.121693 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:42:25.200514 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:42:25.217385 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:42:25.238335 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m13:42:25.239325 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:42:25.239852 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:42:25.361399 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:42:25.364307 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:42:25.366880 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m13:42:25.675259 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m13:42:25.678178 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:42:25.680959 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
COMMIT
[0m13:42:25.925038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:42:25.940945 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:42:25.946595 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:42:25.948414 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m13:42:26.126502 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:42:26.142525 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 13:42:23.693187 => 13:42:26.141484
[0m13:42:26.144715 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m13:42:26.233990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db59e64-07e9-4689-ac35-7f216c25027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd83eab4310>]}
[0m13:42:26.238503 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.58s]
[0m13:42:26.241996 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m13:42:26.244989 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_w_hosts
[0m13:42:26.248177 [info ] [Thread-1 (]: 4 of 4 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m13:42:26.251647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.fct_reviews, now model.dbtairbnb.dim_listings_w_hosts)
[0m13:42:26.253522 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_w_hosts
[0m13:42:26.261527 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:42:26.263343 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (compile): 13:42:26.254686 => 13:42:26.262560
[0m13:42:26.264973 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_w_hosts
[0m13:42:26.273445 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" because it is of type view
[0m13:42:26.278262 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS"
[0m13:42:26.280048 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_w_hosts"
[0m13:42:26.280750 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_w_hosts"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" cascade
[0m13:42:26.281373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:27.211289 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:42:27.218630 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:42:27.224114 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_w_hosts"
[0m13:42:27.226819 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    listings as (select * from AIRBNB.dev.dim_listings_cleansed),
    hosts as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at

from listings l
left join hosts h on h.host_id = l.host_id
        );
[0m13:42:28.441797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:42:28.454062 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (execute): 13:42:26.266001 => 13:42:28.452982
[0m13:42:28.455463 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: Close
[0m13:42:28.539382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db59e64-07e9-4689-ac35-7f216c25027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd83d007ee0>]}
[0m13:42:28.540264 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 2.29s]
[0m13:42:28.541083 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_w_hosts
[0m13:42:28.542743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:28.543256 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_w_hosts' was properly closed.
[0m13:42:28.543777 [info ] [MainThread]: 
[0m13:42:28.544298 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 11.05 seconds (11.05s).
[0m13:42:28.545489 [debug] [MainThread]: Command end result
[0m13:42:28.553165 [info ] [MainThread]: 
[0m13:42:28.553945 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:42:28.554530 [info ] [MainThread]: 
[0m13:42:28.555080 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:42:28.556144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.83466, "process_user_time": 4.253747, "process_kernel_time": 0.803574, "process_mem_max_rss": "197312", "process_out_blocks": "1912", "process_in_blocks": "0"}
[0m13:42:28.557033 [debug] [MainThread]: Command `dbt run` succeeded at 13:42:28.556841 after 11.84 seconds
[0m13:42:28.557744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd86c77a9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd83d007ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd83f7238b0>]}
[0m13:42:28.558476 [debug] [MainThread]: Flushing usage events
[0m13:43:37.783949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74682a9b69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746828cc63e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746828cc6380>]}


============================== 13:43:37.786266 | 2ffd2fc9-d296-45c1-9a2c-f54778055fc2 ==============================
[0m13:43:37.786266 [info ] [MainThread]: Running with dbt=1.7.14
[0m13:43:37.786870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:43:38.408353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ffd2fc9-d296-45c1-9a2c-f54778055fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746828cc64d0>]}
[0m13:43:38.463908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ffd2fc9-d296-45c1-9a2c-f54778055fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7467fd8fce20>]}
[0m13:43:38.464709 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:43:38.471330 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m13:43:38.499495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:38.500139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:38.505398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ffd2fc9-d296-45c1-9a2c-f54778055fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7467fd7b9090>]}
[0m13:43:38.513723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ffd2fc9-d296-45c1-9a2c-f54778055fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7467fd78a350>]}
[0m13:43:38.514321 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:43:38.514890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ffd2fc9-d296-45c1-9a2c-f54778055fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7467fd78b040>]}
[0m13:43:38.516539 [info ] [MainThread]: 
[0m13:43:38.517337 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:43:38.518686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:43:38.533407 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:43:38.534032 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:43:38.534503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:39.471227 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:43:39.477760 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:43:39.597806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m13:43:39.630947 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m13:43:39.632731 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m13:43:39.634119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:40.146216 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:43:40.153178 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m13:43:40.273680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ffd2fc9-d296-45c1-9a2c-f54778055fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746828cc6320>]}
[0m13:43:40.277765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:40.280106 [info ] [MainThread]: 
[0m13:43:40.288084 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m13:43:40.291882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m13:43:40.294424 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m13:43:40.312984 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m13:43:40.314498 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 13:43:40.295984 => 13:43:40.313966
[0m13:43:40.316693 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m13:43:40.317855 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m13:43:40.319255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m13:43:40.320054 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m13:43:40.322999 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m13:43:40.324022 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 13:43:40.320549 => 13:43:40.323668
[0m13:43:40.325763 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m13:43:40.326557 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m13:43:40.327637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m13:43:40.328319 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m13:43:40.330607 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m13:43:40.331476 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 13:43:40.328695 => 13:43:40.331133
[0m13:43:40.332554 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m13:43:40.333362 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m13:43:40.334245 [info ] [Thread-1 (]: 1 of 4 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m13:43:40.335109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m13:43:40.335697 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m13:43:40.340946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:43:40.341878 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 13:43:40.336069 => 13:43:40.341555
[0m13:43:40.342561 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m13:43:40.372043 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:43:40.373597 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m13:43:40.374162 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.dev.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts as (select * from __dbt__cte__src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
        );
[0m13:43:40.374726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:42.169809 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:43:42.206434 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 13:43:40.342907 => 13:43:42.206041
[0m13:43:42.207255 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m13:43:42.331988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffd2fc9-d296-45c1-9a2c-f54778055fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7467fd78b3a0>]}
[0m13:43:42.336612 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.00s]
[0m13:43:42.341541 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m13:43:42.344540 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m13:43:42.347682 [info ] [Thread-1 (]: 2 of 4 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m13:43:42.351301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m13:43:42.353978 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m13:43:42.376333 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:43:42.378613 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 13:43:42.355968 => 13:43:42.377907
[0m13:43:42.380156 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m13:43:42.387560 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:43:42.390281 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m13:43:42.391331 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace transient table AIRBNB.dev.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
), src_listings as (select * from __dbt__cte__src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
        );
[0m13:43:42.392420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:43.760294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:43.774447 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 13:43:42.381228 => 13:43:43.773194
[0m13:43:43.776992 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m13:43:43.923882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffd2fc9-d296-45c1-9a2c-f54778055fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7467fcd4b7c0>]}
[0m13:43:43.927244 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.57s]
[0m13:43:43.930859 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m13:43:43.933691 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m13:43:43.937319 [info ] [Thread-1 (]: 3 of 4 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:43:43.941704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m13:43:43.944397 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m13:43:43.972047 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m13:43:43.973244 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 13:43:43.946223 => 13:43:43.972843
[0m13:43:43.974049 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m13:43:44.013721 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:43:44.014372 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m13:43:44.014939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:44.907848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:44.937331 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:43:44.938735 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:43:45.085921 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:43:45.097298 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:43:45.099102 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m13:43:45.202497 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:43:45.244751 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:43:45.245814 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:43:45.342559 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:43:45.349800 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:43:45.350956 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:43:45.447567 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:43:45.478104 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:43:45.500017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m13:43:45.501142 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:43:45.501770 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:43:45.854524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:43:45.855621 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:43:45.856631 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m13:43:46.164264 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m13:43:46.167038 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:43:46.169447 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
COMMIT
[0m13:43:46.469906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:43:46.481011 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:43:46.489035 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:43:46.489836 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m13:43:46.608723 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:43:46.622569 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 13:43:43.974717 => 13:43:46.621289
[0m13:43:46.625128 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m13:43:46.746116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffd2fc9-d296-45c1-9a2c-f54778055fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7467fcc56a40>]}
[0m13:43:46.749374 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.81s]
[0m13:43:46.753023 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m13:43:46.756666 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_w_hosts
[0m13:43:46.760315 [info ] [Thread-1 (]: 4 of 4 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m13:43:46.764014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.fct_reviews, now model.dbtairbnb.dim_listings_w_hosts)
[0m13:43:46.766566 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_w_hosts
[0m13:43:46.775978 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:43:46.778023 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (compile): 13:43:46.768103 => 13:43:46.777407
[0m13:43:46.779088 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_w_hosts
[0m13:43:46.786564 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:43:46.788440 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_w_hosts"
[0m13:43:46.789234 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    listings as (select * from AIRBNB.dev.dim_listings_cleansed),
    hosts as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at

from listings l
left join hosts h on h.host_id = l.host_id
        );
[0m13:43:46.790061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:48.131273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:48.145047 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (execute): 13:43:46.779770 => 13:43:48.143853
[0m13:43:48.147515 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: Close
[0m13:43:48.227384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffd2fc9-d296-45c1-9a2c-f54778055fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7467fccedb40>]}
[0m13:43:48.230770 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.46s]
[0m13:43:48.234454 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_w_hosts
[0m13:43:48.240982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:48.243261 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_w_hosts' was properly closed.
[0m13:43:48.245602 [info ] [MainThread]: 
[0m13:43:48.248019 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 9.73 seconds (9.73s).
[0m13:43:48.253794 [debug] [MainThread]: Command end result
[0m13:43:48.279814 [info ] [MainThread]: 
[0m13:43:48.281061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:48.282134 [info ] [MainThread]: 
[0m13:43:48.283668 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:43:48.285642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.543055, "process_user_time": 4.320038, "process_kernel_time": 0.744559, "process_mem_max_rss": "196676", "process_out_blocks": "1904", "process_in_blocks": "0"}
[0m13:43:48.286827 [debug] [MainThread]: Command `dbt run` succeeded at 13:43:48.286518 after 10.54 seconds
[0m13:43:48.287655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74682a9b69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7467fccda7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7467fcc56a40>]}
[0m13:43:48.288423 [debug] [MainThread]: Flushing usage events
[0m13:45:02.601215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cbaea69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cb91b63e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cb91b6380>]}


============================== 13:45:02.603662 | 7b7d5a62-655c-481d-831d-e5a4549b87d3 ==============================
[0m13:45:02.603662 [info ] [MainThread]: Running with dbt=1.7.14
[0m13:45:02.604411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:45:03.259050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b7d5a62-655c-481d-831d-e5a4549b87d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cb91b64d0>]}
[0m13:45:03.318813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b7d5a62-655c-481d-831d-e5a4549b87d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c8ddf8e20>]}
[0m13:45:03.319651 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:45:03.326762 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m13:45:03.357038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:45:03.357610 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:45:03.363352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b7d5a62-655c-481d-831d-e5a4549b87d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c8dcb5090>]}
[0m13:45:03.372312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b7d5a62-655c-481d-831d-e5a4549b87d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c8dc86350>]}
[0m13:45:03.373393 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:45:03.373986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b7d5a62-655c-481d-831d-e5a4549b87d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c8dc87040>]}
[0m13:45:03.375724 [info ] [MainThread]: 
[0m13:45:03.376590 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:45:03.377988 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:45:03.394840 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:45:03.395672 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:45:03.396441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:04.327370 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:45:04.335053 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:45:04.475194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m13:45:04.486442 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m13:45:04.487141 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m13:45:04.487670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:05.422975 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:45:05.426786 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m13:45:05.560210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b7d5a62-655c-481d-831d-e5a4549b87d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c8daeb340>]}
[0m13:45:05.563768 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:45:05.565903 [info ] [MainThread]: 
[0m13:45:05.572848 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m13:45:05.575956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m13:45:05.578208 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m13:45:05.599027 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m13:45:05.601018 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 13:45:05.579630 => 13:45:05.600048
[0m13:45:05.603172 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m13:45:05.604106 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m13:45:05.605523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m13:45:05.606347 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m13:45:05.608920 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m13:45:05.609970 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 13:45:05.606864 => 13:45:05.609606
[0m13:45:05.611432 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m13:45:05.612478 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m13:45:05.613904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m13:45:05.615065 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m13:45:05.618440 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m13:45:05.619323 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 13:45:05.615712 => 13:45:05.619028
[0m13:45:05.620326 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m13:45:05.620925 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m13:45:05.621562 [info ] [Thread-1 (]: 1 of 4 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m13:45:05.622497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m13:45:05.623035 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m13:45:05.628698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:45:05.629693 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 13:45:05.623574 => 13:45:05.629285
[0m13:45:05.630561 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m13:45:05.656679 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type table
[0m13:45:05.664659 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED"
[0m13:45:05.672040 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m13:45:05.672651 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m13:45:05.673180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:06.104083 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:45:06.115235 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:45:06.116487 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m13:45:06.117055 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts as (select * from __dbt__cte__src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m13:45:06.454418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:45:06.488530 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 13:45:05.631107 => 13:45:06.488096
[0m13:45:06.489456 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m13:45:06.656017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b7d5a62-655c-481d-831d-e5a4549b87d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c8dbb7310>]}
[0m13:45:06.659853 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.03s]
[0m13:45:06.663473 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m13:45:06.666246 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m13:45:06.669748 [info ] [Thread-1 (]: 2 of 4 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m13:45:06.673714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m13:45:06.676271 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m13:45:06.693649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:45:06.695402 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 13:45:06.678247 => 13:45:06.694782
[0m13:45:06.696646 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m13:45:06.704130 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type table
[0m13:45:06.709867 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED"
[0m13:45:06.711707 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m13:45:06.712371 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m13:45:06.713052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:07.554187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:07.557850 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:45:07.560197 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m13:45:07.562335 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
), src_listings as (select * from __dbt__cte__src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m13:45:07.886927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:45:07.893094 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 13:45:06.698061 => 13:45:07.892556
[0m13:45:07.894053 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m13:45:08.007807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b7d5a62-655c-481d-831d-e5a4549b87d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c8d2cf4c0>]}
[0m13:45:08.010900 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.34s]
[0m13:45:08.014146 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m13:45:08.016556 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m13:45:08.020021 [info ] [Thread-1 (]: 3 of 4 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:45:08.025738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m13:45:08.029844 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m13:45:08.055244 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m13:45:08.056818 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 13:45:08.031603 => 13:45:08.056272
[0m13:45:08.057903 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m13:45:08.094792 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:45:08.095697 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m13:45:08.096400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:08.856830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:08.888192 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:45:08.889628 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:45:09.085864 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:45:09.102477 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:45:09.105038 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m13:45:09.211888 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:45:09.240681 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:45:09.241480 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:45:09.347648 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:45:09.364613 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:45:09.367228 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:45:09.471296 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:45:09.505245 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:45:09.526780 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m13:45:09.527941 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:45:09.528549 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:45:09.725922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:45:09.728674 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:45:09.731336 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m13:45:10.076379 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m13:45:10.078633 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:45:10.080949 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
COMMIT
[0m13:45:10.325871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:45:10.343031 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:45:10.350074 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:45:10.351076 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m13:45:10.510794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:45:10.514761 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 13:45:08.058605 => 13:45:10.514403
[0m13:45:10.515495 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m13:45:10.705906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b7d5a62-655c-481d-831d-e5a4549b87d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c8dbd3e80>]}
[0m13:45:10.708365 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.68s]
[0m13:45:10.710681 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m13:45:10.712452 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_w_hosts
[0m13:45:10.714409 [info ] [Thread-1 (]: 4 of 4 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m13:45:10.716403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.fct_reviews, now model.dbtairbnb.dim_listings_w_hosts)
[0m13:45:10.717823 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_w_hosts
[0m13:45:10.725743 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:45:10.726832 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (compile): 13:45:10.718853 => 13:45:10.726475
[0m13:45:10.727561 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_w_hosts
[0m13:45:10.757432 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:45:10.758895 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_w_hosts"
[0m13:45:10.759442 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    listings as (select * from AIRBNB.dev.dim_listings_cleansed),
    hosts as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at

from listings l
left join hosts h on h.host_id = l.host_id
        );
[0m13:45:10.760153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:12.490319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:45:12.515222 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (execute): 13:45:10.727985 => 13:45:12.513663
[0m13:45:12.518156 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: Close
[0m13:45:12.647806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b7d5a62-655c-481d-831d-e5a4549b87d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c7f74c0d0>]}
[0m13:45:12.651405 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.93s]
[0m13:45:12.655054 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_w_hosts
[0m13:45:12.661766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:12.664113 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_w_hosts' was properly closed.
[0m13:45:12.666652 [info ] [MainThread]: 
[0m13:45:12.669109 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 9.29 seconds (9.29s).
[0m13:45:12.675440 [debug] [MainThread]: Command end result
[0m13:45:12.699054 [info ] [MainThread]: 
[0m13:45:12.700104 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:45:12.700957 [info ] [MainThread]: 
[0m13:45:12.701782 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:45:12.703123 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.143495, "process_user_time": 4.047007, "process_kernel_time": 0.886905, "process_mem_max_rss": "197164", "process_out_blocks": "1904", "process_in_blocks": "0"}
[0m13:45:12.704179 [debug] [MainThread]: Command `dbt run` succeeded at 13:45:12.703895 after 10.14 seconds
[0m13:45:12.704962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cbaea69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c8c17bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c8dfbee00>]}
[0m13:45:12.705758 [debug] [MainThread]: Flushing usage events
[0m13:52:45.072473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74926ddae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74926c0be380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74926c0be320>]}


============================== 13:52:45.075138 | 54d4e43c-53c4-40bd-86c7-78708610f628 ==============================
[0m13:52:45.075138 [info ] [MainThread]: Running with dbt=1.7.14
[0m13:52:45.075768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:52:45.684949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54d4e43c-53c4-40bd-86c7-78708610f628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74926c0be470>]}
[0m13:52:45.741503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54d4e43c-53c4-40bd-86c7-78708610f628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74926c0bdcf0>]}
[0m13:52:45.742302 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:52:45.748999 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m13:52:45.778380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:52:45.779056 [debug] [MainThread]: Partial parsing: added file: dbtairbnb://seeds/seed_full_moon_dates.csv
[0m13:52:45.929458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54d4e43c-53c4-40bd-86c7-78708610f628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749244abd720>]}
[0m13:52:45.938679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54d4e43c-53c4-40bd-86c7-78708610f628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749244b6b430>]}
[0m13:52:45.939339 [info ] [MainThread]: Found 7 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:52:45.939932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54d4e43c-53c4-40bd-86c7-78708610f628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749244bb3970>]}
[0m13:52:45.941465 [info ] [MainThread]: 
[0m13:52:45.942437 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:52:45.943635 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:52:45.956878 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:52:45.957440 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:52:45.957970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:46.893691 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:52:46.900209 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:52:47.054059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m13:52:47.088964 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m13:52:47.090310 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m13:52:47.091521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:47.772996 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:52:47.779957 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m13:52:47.931659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54d4e43c-53c4-40bd-86c7-78708610f628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749244b865f0>]}
[0m13:52:47.935582 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:47.938403 [info ] [MainThread]: 
[0m13:52:47.946914 [debug] [Thread-1 (]: Began running node seed.dbtairbnb.seed_full_moon_dates
[0m13:52:47.949824 [info ] [Thread-1 (]: 1 of 1 START seed file dev.seed_full_moon_dates ................................ [RUN]
[0m13:52:47.953398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now seed.dbtairbnb.seed_full_moon_dates)
[0m13:52:47.956307 [debug] [Thread-1 (]: Began compiling node seed.dbtairbnb.seed_full_moon_dates
[0m13:52:47.959248 [debug] [Thread-1 (]: Timing info for seed.dbtairbnb.seed_full_moon_dates (compile): 13:52:47.957917 => 13:52:47.957926
[0m13:52:47.961915 [debug] [Thread-1 (]: Began executing node seed.dbtairbnb.seed_full_moon_dates
[0m13:52:48.030482 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtairbnb.seed_full_moon_dates"
[0m13:52:48.031107 [debug] [Thread-1 (]: On seed.dbtairbnb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "seed.dbtairbnb.seed_full_moon_dates"} */
create table AIRBNB.dev.seed_full_moon_dates (full_moon_date date)
[0m13:52:48.031627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:49.000856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:49.047200 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtairbnb.seed_full_moon_dates"
[0m13:52:49.048036 [debug] [Thread-1 (]: On seed.dbtairbnb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "seed.dbtairbnb.seed_full_moon_dates"} */
BEGIN
[0m13:52:49.165789 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:52:49.175358 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtairbnb.seed_full_moon_dates"
[0m13:52:49.177957 [debug] [Thread-1 (]: On seed.dbtairbnb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "seed.dbtairbnb.seed_full_moon_dates"} */
insert into AIRBNB.dev.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),...
[0m13:52:49.923070 [debug] [Thread-1 (]: SQL status: SUCCESS 272 in 1.0 seconds
[0m13:52:49.926287 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtairbnb.seed_full_moon_dates"
[0m13:52:49.928895 [debug] [Thread-1 (]: On seed.dbtairbnb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "seed.dbtairbnb.seed_full_moon_dates"} */
COMMIT
[0m13:52:50.536971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:50.562419 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtairbnb.seed_full_moon_dates"
[0m13:52:50.597869 [debug] [Thread-1 (]: Timing info for seed.dbtairbnb.seed_full_moon_dates (execute): 13:52:47.963704 => 13:52:50.597558
[0m13:52:50.598513 [debug] [Thread-1 (]: On seed.dbtairbnb.seed_full_moon_dates: Close
[0m13:52:50.731502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54d4e43c-53c4-40bd-86c7-78708610f628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749244aa2c80>]}
[0m13:52:50.734796 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 2.78s]
[0m13:52:50.738732 [debug] [Thread-1 (]: Finished running node seed.dbtairbnb.seed_full_moon_dates
[0m13:52:50.745622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:50.748000 [debug] [MainThread]: Connection 'seed.dbtairbnb.seed_full_moon_dates' was properly closed.
[0m13:52:50.750402 [info ] [MainThread]: 
[0m13:52:50.753248 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m13:52:50.757335 [debug] [MainThread]: Command end result
[0m13:52:50.778279 [info ] [MainThread]: 
[0m13:52:50.779290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:50.780343 [info ] [MainThread]: 
[0m13:52:50.781429 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:52:50.783135 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 5.7542605, "process_user_time": 3.731412, "process_kernel_time": 0.824754, "process_mem_max_rss": "197556", "process_out_blocks": "2640", "process_in_blocks": "0"}
[0m13:52:50.784457 [debug] [MainThread]: Command `dbt seed` succeeded at 13:52:50.784033 after 5.76 seconds
[0m13:52:50.785651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74926ddae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74926c0be470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749244a68880>]}
[0m13:52:50.787036 [debug] [MainThread]: Flushing usage events
[0m13:58:27.722172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dab0a8aa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dab08bba380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dab08bba320>]}


============================== 13:58:27.724683 | 1594455e-18ca-417d-8a67-477e835a0ba7 ==============================
[0m13:58:27.724683 [info ] [MainThread]: Running with dbt=1.7.14
[0m13:58:27.725288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:58:28.359160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1594455e-18ca-417d-8a67-477e835a0ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dab08bba470>]}
[0m13:58:28.417365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1594455e-18ca-417d-8a67-477e835a0ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dab08bb9cf0>]}
[0m13:58:28.418312 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:58:28.425296 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m13:58:28.457866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:58:28.458493 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:58:28.464193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1594455e-18ca-417d-8a67-477e835a0ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daae1659cc0>]}
[0m13:58:28.473714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1594455e-18ca-417d-8a67-477e835a0ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daae1627580>]}
[0m13:58:28.474345 [info ] [MainThread]: Found 8 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:58:28.474857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1594455e-18ca-417d-8a67-477e835a0ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daae1630190>]}
[0m13:58:28.476565 [info ] [MainThread]: 
[0m13:58:28.477386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:58:28.478836 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:58:28.492283 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:58:28.492857 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:58:28.493334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:29.692593 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:58:29.699480 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:58:29.799625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m13:58:29.832828 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m13:58:29.833863 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m13:58:29.834716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:30.918058 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:58:30.923124 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m13:58:31.069865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1594455e-18ca-417d-8a67-477e835a0ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daae1630160>]}
[0m13:58:31.072922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:58:31.074600 [info ] [MainThread]: 
[0m13:58:31.080724 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m13:58:31.083525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m13:58:31.085338 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m13:58:31.109127 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m13:58:31.110912 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 13:58:31.086534 => 13:58:31.110327
[0m13:58:31.113333 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m13:58:31.114635 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m13:58:31.116944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m13:58:31.119174 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m13:58:31.124300 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m13:58:31.125787 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 13:58:31.120071 => 13:58:31.125350
[0m13:58:31.127577 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m13:58:31.128354 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m13:58:31.130352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m13:58:31.131199 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m13:58:31.134181 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m13:58:31.135093 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 13:58:31.131603 => 13:58:31.134782
[0m13:58:31.136133 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m13:58:31.136724 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m13:58:31.137603 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m13:58:31.138565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m13:58:31.139120 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m13:58:31.146481 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:58:31.147889 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 13:58:31.139470 => 13:58:31.147379
[0m13:58:31.148886 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m13:58:31.178798 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:58:31.180133 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m13:58:31.180790 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts as (select * from __dbt__cte__src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m13:58:31.181404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:32.275924 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:58:32.346703 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 13:58:31.149587 => 13:58:32.346152
[0m13:58:32.347811 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m13:58:32.477051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1594455e-18ca-417d-8a67-477e835a0ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daae156dab0>]}
[0m13:58:32.480710 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.34s]
[0m13:58:32.484237 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m13:58:32.486981 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m13:58:32.490334 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m13:58:32.493338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m13:58:32.495388 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m13:58:32.507638 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:58:32.509390 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 13:58:32.496268 => 13:58:32.508836
[0m13:58:32.510902 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m13:58:32.520567 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:58:32.523595 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m13:58:32.524812 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
), src_listings as (select * from __dbt__cte__src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m13:58:32.525988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:33.335748 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:58:33.350674 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 13:58:32.511900 => 13:58:33.349396
[0m13:58:33.353206 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m13:58:33.501620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1594455e-18ca-417d-8a67-477e835a0ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daae156ca30>]}
[0m13:58:33.504965 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.01s]
[0m13:58:33.508367 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m13:58:33.511075 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m13:58:33.514423 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:58:33.518575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m13:58:33.521387 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m13:58:33.546502 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m13:58:33.547812 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 13:58:33.523484 => 13:58:33.547354
[0m13:58:33.548779 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m13:58:33.598974 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:58:33.600458 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m13:58:33.601484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:34.296667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:58:34.328894 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:58:34.330341 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:58:34.414956 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:58:34.431526 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:58:34.434079 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m13:58:34.532135 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:58:34.566265 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:58:34.566905 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:58:34.651759 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:58:34.667102 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:58:34.670889 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:58:34.749357 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:58:34.786830 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:58:34.807690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m13:58:34.808776 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:58:34.809384 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:58:35.218518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:58:35.221336 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:58:35.224006 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m13:58:35.831503 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m13:58:35.833080 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:58:35.834457 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
COMMIT
[0m13:58:36.141129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:58:36.174916 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:58:36.186288 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:58:36.187186 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m13:58:36.288885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:58:36.302999 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 13:58:33.549347 => 13:58:36.301665
[0m13:58:36.305756 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m13:58:36.403386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1594455e-18ca-417d-8a67-477e835a0ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daae1492830>]}
[0m13:58:36.406717 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.89s]
[0m13:58:36.410315 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m13:58:36.412996 [debug] [Thread-1 (]: Began running node model.dbtairbnb.mart_fullmoon_reviews
[0m13:58:36.416231 [info ] [Thread-1 (]: 4 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m13:58:36.420071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.fct_reviews, now model.dbtairbnb.mart_fullmoon_reviews)
[0m13:58:36.422828 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.mart_fullmoon_reviews
[0m13:58:36.442934 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m13:58:36.444596 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (compile): 13:58:36.424774 => 13:58:36.444026
[0m13:58:36.445564 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.mart_fullmoon_reviews
[0m13:58:36.477178 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m13:58:36.478883 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.mart_fullmoon_reviews"
[0m13:58:36.479922 [debug] [Thread-1 (]: On model.dbtairbnb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.dev.mart_fullmoon_reviews
         as
        (

with
     __dbt__cte__src_reviews as (
with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), fct_reviews as (select * from __dbt__cte__src_reviews),
    full_moon_dates(select * from AIRBNB.dev.seed_full_moon_dates)
select
    r.*,
    case
        when fm.full_moon_dates is null then 'not full moon' else 'full moon'
    end as is_full_moon
from fct_reviews r
left join
    full_moon_dates fm on to_date(r.review_date) = dateadd(day, 1, fm.full_moon_dates)
        );
[0m13:58:36.481200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:36.872968 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b46a1a-0000-437b-0000-000052fd5c71
[0m13:58:36.874573 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 20 unexpected 'select'.
syntax error line 24 at position 26 unexpected 'to_date'.
[0m13:58:36.876200 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (execute): 13:58:36.446161 => 13:58:36.875657
[0m13:58:36.877258 [debug] [Thread-1 (]: On model.dbtairbnb.mart_fullmoon_reviews: Close
[0m13:58:36.960559 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 20 unexpected 'select'.
  syntax error line 24 at position 26 unexpected 'to_date'.
  compiled Code at target/run/dbtairbnb/models/mart/mart_fullmoon_reviews.sql
[0m13:58:36.962365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1594455e-18ca-417d-8a67-477e835a0ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daae1553910>]}
[0m13:58:36.964335 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model dev.mart_fullmoon_reviews ................ [[31mERROR[0m in 0.54s]
[0m13:58:36.966477 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.mart_fullmoon_reviews
[0m13:58:36.968197 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_w_hosts
[0m13:58:36.971477 [info ] [Thread-1 (]: 5 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m13:58:36.973740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.mart_fullmoon_reviews, now model.dbtairbnb.dim_listings_w_hosts)
[0m13:58:36.975276 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_w_hosts
[0m13:58:36.983971 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:58:36.986262 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (compile): 13:58:36.976318 => 13:58:36.985354
[0m13:58:36.988429 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_w_hosts
[0m13:58:36.998880 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:58:37.001069 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_w_hosts"
[0m13:58:37.002196 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    listings as (select * from AIRBNB.dev.dim_listings_cleansed),
    hosts as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at

from listings l
left join hosts h on h.host_id = l.host_id
        );
[0m13:58:37.003281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:38.828633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:58:38.833771 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (execute): 13:58:36.990147 => 13:58:38.833193
[0m13:58:38.834623 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: Close
[0m13:58:38.955301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1594455e-18ca-417d-8a67-477e835a0ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daae0aa3220>]}
[0m13:58:38.957560 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.98s]
[0m13:58:38.959402 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_w_hosts
[0m13:58:38.963047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:38.964277 [debug] [MainThread]: Connection 'model.dbtairbnb.dim_listings_w_hosts' was properly closed.
[0m13:58:38.965746 [info ] [MainThread]: 
[0m13:58:38.967140 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 10.49 seconds (10.49s).
[0m13:58:38.970568 [debug] [MainThread]: Command end result
[0m13:58:38.988150 [info ] [MainThread]: 
[0m13:58:38.989239 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:58:38.990257 [info ] [MainThread]: 
[0m13:58:38.991385 [error] [MainThread]:   Database Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 20 unexpected 'select'.
  syntax error line 24 at position 26 unexpected 'to_date'.
  compiled Code at target/run/dbtairbnb/models/mart/mart_fullmoon_reviews.sql
[0m13:58:38.992203 [info ] [MainThread]: 
[0m13:58:38.992982 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:58:38.994560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.313004, "process_user_time": 4.296307, "process_kernel_time": 0.768347, "process_mem_max_rss": "197628", "process_out_blocks": "1960", "command_success": false, "process_in_blocks": "0"}
[0m13:58:38.996179 [debug] [MainThread]: Command `dbt run` failed at 13:58:38.995681 after 11.31 seconds
[0m13:58:38.997289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dab0a8aa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daae1492410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daae16300a0>]}
[0m13:58:38.998227 [debug] [MainThread]: Flushing usage events
[0m13:59:50.953897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf68eaa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf671ba3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf671ba380>]}


============================== 13:59:50.956234 | 2a98abbd-d76a-4f5f-8924-6cd7d88d07b6 ==============================
[0m13:59:50.956234 [info ] [MainThread]: Running with dbt=1.7.14
[0m13:59:50.956954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:59:51.559496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a98abbd-d76a-4f5f-8924-6cd7d88d07b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf671ba4d0>]}
[0m13:59:51.616045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a98abbd-d76a-4f5f-8924-6cd7d88d07b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf3bd94e20>]}
[0m13:59:51.616845 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:59:51.624499 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m13:59:51.653021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:51.653768 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:51.659585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a98abbd-d76a-4f5f-8924-6cd7d88d07b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf3bc59d20>]}
[0m13:59:51.667745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a98abbd-d76a-4f5f-8924-6cd7d88d07b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf3be18670>]}
[0m13:59:51.668340 [info ] [MainThread]: Found 8 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:59:51.668916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a98abbd-d76a-4f5f-8924-6cd7d88d07b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf3bc30160>]}
[0m13:59:51.670697 [info ] [MainThread]: 
[0m13:59:51.671525 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:59:51.672855 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:59:51.687175 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:59:51.688165 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:59:51.689243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:52.502187 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:59:52.508521 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:59:52.657363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m13:59:52.666313 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m13:59:52.666942 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m13:59:52.667460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:53.401981 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:59:53.405622 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m13:59:53.539596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a98abbd-d76a-4f5f-8924-6cd7d88d07b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf40408f40>]}
[0m13:59:53.543856 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:53.545549 [info ] [MainThread]: 
[0m13:59:53.550472 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m13:59:53.552346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m13:59:53.554400 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m13:59:53.565893 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m13:59:53.567030 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 13:59:53.555103 => 13:59:53.566638
[0m13:59:53.568336 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m13:59:53.569045 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m13:59:53.570905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m13:59:53.571686 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m13:59:53.574300 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m13:59:53.575282 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 13:59:53.572180 => 13:59:53.574970
[0m13:59:53.576439 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m13:59:53.577180 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m13:59:53.578022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m13:59:53.578549 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m13:59:53.580508 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m13:59:53.581355 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 13:59:53.578886 => 13:59:53.581087
[0m13:59:53.582332 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m13:59:53.582901 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m13:59:53.583501 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m13:59:53.584409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m13:59:53.584937 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m13:59:53.590171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:59:53.591055 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 13:59:53.585273 => 13:59:53.590758
[0m13:59:53.591738 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m13:59:53.618375 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m13:59:53.619621 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m13:59:53.620206 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts as (select * from __dbt__cte__src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m13:59:53.620755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.435416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:59:54.480909 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 13:59:53.592085 => 13:59:54.480558
[0m13:59:54.481615 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m13:59:54.638574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a98abbd-d76a-4f5f-8924-6cd7d88d07b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf3b0a2860>]}
[0m13:59:54.641907 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.05s]
[0m13:59:54.645312 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m13:59:54.648016 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m13:59:54.651322 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m13:59:54.655679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m13:59:54.658700 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m13:59:54.675067 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:59:54.676983 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 13:59:54.659907 => 13:59:54.676158
[0m13:59:54.678439 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m13:59:54.687252 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m13:59:54.690073 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m13:59:54.691463 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
), src_listings as (select * from __dbt__cte__src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m13:59:54.692726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:55.704885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:59:55.709795 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 13:59:54.679289 => 13:59:55.709513
[0m13:59:55.710364 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m13:59:55.838569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a98abbd-d76a-4f5f-8924-6cd7d88d07b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf3bb6ec20>]}
[0m13:59:55.841958 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.18s]
[0m13:59:55.845416 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m13:59:55.848136 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m13:59:55.851747 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:59:55.856714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m13:59:55.860466 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m13:59:55.887085 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m13:59:55.888463 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 13:59:55.862148 => 13:59:55.887890
[0m13:59:55.889170 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m13:59:55.933731 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:59:55.934844 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m13:59:55.935919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:56.881671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:59:56.912359 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:59:56.913770 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:59:57.037974 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:59:57.057277 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:59:57.059891 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m13:59:57.157259 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:59:57.201369 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:59:57.202375 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:59:57.322813 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:59:57.328116 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:59:57.329268 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:59:57.478369 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:59:57.513599 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:59:57.534868 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m13:59:57.536017 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:59:57.536761 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:59:57.854334 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:59:57.856458 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:59:57.858433 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m13:59:58.160725 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m13:59:58.162288 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:59:58.163741 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
COMMIT
[0m13:59:58.348412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:59:58.361021 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m13:59:58.368153 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m13:59:58.369066 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m13:59:58.519535 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:59:58.523614 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 13:59:55.889625 => 13:59:58.523198
[0m13:59:58.524258 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m13:59:58.647585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a98abbd-d76a-4f5f-8924-6cd7d88d07b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf3b1df0d0>]}
[0m13:59:58.652134 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.79s]
[0m13:59:58.656600 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m13:59:58.662074 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_w_hosts
[0m13:59:58.667607 [info ] [Thread-1 (]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m13:59:58.673814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.fct_reviews, now model.dbtairbnb.dim_listings_w_hosts)
[0m13:59:58.676712 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_w_hosts
[0m13:59:58.693818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:59:58.697742 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (compile): 13:59:58.678730 => 13:59:58.696231
[0m13:59:58.701640 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_w_hosts
[0m13:59:58.757299 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_w_hosts"
[0m13:59:58.759383 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_w_hosts"
[0m13:59:58.760543 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    listings as (select * from AIRBNB.dev.dim_listings_cleansed),
    hosts as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at

from listings l
left join hosts h on h.host_id = l.host_id
        );
[0m13:59:58.761875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:00.620110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:00:00.634753 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (execute): 13:59:58.703681 => 14:00:00.633452
[0m14:00:00.637356 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: Close
[0m14:00:00.762102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a98abbd-d76a-4f5f-8924-6cd7d88d07b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf3b0face0>]}
[0m14:00:00.765538 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 2.09s]
[0m14:00:00.769396 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_w_hosts
[0m14:00:00.773993 [debug] [Thread-1 (]: Began running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:00:00.779290 [info ] [Thread-1 (]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m14:00:00.785065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_w_hosts, now model.dbtairbnb.mart_fullmoon_reviews)
[0m14:00:00.789007 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.mart_fullmoon_reviews
[0m14:00:00.797767 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:00:00.799208 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (compile): 14:00:00.790542 => 14:00:00.798702
[0m14:00:00.800237 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.mart_fullmoon_reviews
[0m14:00:00.807432 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:00:00.809036 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:00:00.809841 [debug] [Thread-1 (]: On model.dbtairbnb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.dev.mart_fullmoon_reviews
         as
        (

with
    fct_reviews as (select * from AIRBNB.dev.fct_reviews),
    full_moon_dates(select * from AIRBNB.dev.seed_full_moon_dates)
select
    r.*,
    case
        when fm.full_moon_dates is null then 'not full moon' else 'full moon'
    end as is_full_moon
from fct_reviews r
left join
    full_moon_dates fm on to_date(r.review_date) = dateadd(day, 1, fm.full_moon_dates)
        );
[0m14:00:00.810593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:01.338038 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b46a1c-0000-4377-0000-000052fd4cf1
[0m14:00:01.339543 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 20 unexpected 'select'.
syntax error line 15 at position 26 unexpected 'to_date'.
[0m14:00:01.341426 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (execute): 14:00:00.801062 => 14:00:01.340718
[0m14:00:01.342837 [debug] [Thread-1 (]: On model.dbtairbnb.mart_fullmoon_reviews: Close
[0m14:00:01.432220 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 20 unexpected 'select'.
  syntax error line 15 at position 26 unexpected 'to_date'.
  compiled Code at target/run/dbtairbnb/models/mart/mart_fullmoon_reviews.sql
[0m14:00:01.435040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a98abbd-d76a-4f5f-8924-6cd7d88d07b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf397871c0>]}
[0m14:00:01.438222 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model dev.mart_fullmoon_reviews ................ [[31mERROR[0m in 0.65s]
[0m14:00:01.441626 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:00:01.450341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:01.452727 [debug] [MainThread]: Connection 'model.dbtairbnb.mart_fullmoon_reviews' was properly closed.
[0m14:00:01.455086 [info ] [MainThread]: 
[0m14:00:01.457754 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 9.78 seconds (9.78s).
[0m14:00:01.462701 [debug] [MainThread]: Command end result
[0m14:00:01.480774 [info ] [MainThread]: 
[0m14:00:01.481679 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:00:01.482425 [info ] [MainThread]: 
[0m14:00:01.483441 [error] [MainThread]:   Database Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 20 unexpected 'select'.
  syntax error line 15 at position 26 unexpected 'to_date'.
  compiled Code at target/run/dbtairbnb/models/mart/mart_fullmoon_reviews.sql
[0m14:00:01.484571 [info ] [MainThread]: 
[0m14:00:01.485609 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:00:01.487391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.573573, "process_user_time": 4.252844, "process_kernel_time": 0.883344, "process_mem_max_rss": "197680", "process_out_blocks": "1960", "command_success": false, "process_in_blocks": "0"}
[0m14:00:01.488886 [debug] [MainThread]: Command `dbt run` failed at 14:00:01.488487 after 10.58 seconds
[0m14:00:01.490004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf68eaa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf3bf5ae00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf3bc59d20>]}
[0m14:00:01.491130 [debug] [MainThread]: Flushing usage events
[0m14:00:50.267262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe75dba9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe740ca380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe740ca320>]}


============================== 14:00:50.269632 | b0892ccd-6380-4c82-a608-f0752d69e951 ==============================
[0m14:00:50.269632 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:00:50.270241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:00:50.876782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0892ccd-6380-4c82-a608-f0752d69e951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe740ca470>]}
[0m14:00:50.934504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0892ccd-6380-4c82-a608-f0752d69e951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe740c9cf0>]}
[0m14:00:50.935303 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:00:50.941853 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:00:50.969905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:00:50.970441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:00:50.976220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0892ccd-6380-4c82-a608-f0752d69e951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe4cbcdcc0>]}
[0m14:00:50.984505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0892ccd-6380-4c82-a608-f0752d69e951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe4cb97580>]}
[0m14:00:50.985107 [info ] [MainThread]: Found 8 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:00:50.985895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0892ccd-6380-4c82-a608-f0752d69e951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe4cba4190>]}
[0m14:00:50.987512 [info ] [MainThread]: 
[0m14:00:50.988311 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:00:50.989681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m14:00:51.004647 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m14:00:51.005611 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m14:00:51.006083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:52.019065 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:00:52.025920 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:00:52.124755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m14:00:52.157925 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:00:52.159234 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:00:52.160392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:53.152747 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:00:53.159775 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:00:53.321447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0892ccd-6380-4c82-a608-f0752d69e951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe4cba4160>]}
[0m14:00:53.325343 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:00:53.328020 [info ] [MainThread]: 
[0m14:00:53.336738 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m14:00:53.340276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m14:00:53.341220 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m14:00:53.349654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m14:00:53.350465 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 14:00:53.341619 => 14:00:53.350193
[0m14:00:53.351415 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m14:00:53.351977 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m14:00:53.352701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m14:00:53.353229 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m14:00:53.355071 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m14:00:53.355986 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 14:00:53.353633 => 14:00:53.355709
[0m14:00:53.356968 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m14:00:53.357539 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m14:00:53.358253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m14:00:53.358767 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m14:00:53.361068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m14:00:53.362044 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 14:00:53.359095 => 14:00:53.361758
[0m14:00:53.363101 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m14:00:53.363670 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m14:00:53.364284 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m14:00:53.365059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m14:00:53.365703 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m14:00:53.370532 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m14:00:53.371335 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 14:00:53.366046 => 14:00:53.371049
[0m14:00:53.371867 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m14:00:53.401933 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m14:00:53.403169 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m14:00:53.403715 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts as (select * from __dbt__cte__src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m14:00:53.404237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:54.070804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:00:54.123854 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 14:00:53.372210 => 14:00:54.123502
[0m14:00:54.124586 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m14:00:54.258733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0892ccd-6380-4c82-a608-f0752d69e951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe4cacbd60>]}
[0m14:00:54.259581 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.89s]
[0m14:00:54.260383 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m14:00:54.261001 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m14:00:54.261695 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m14:00:54.262672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m14:00:54.263242 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m14:00:54.271602 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m14:00:54.272541 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 14:00:54.263604 => 14:00:54.272234
[0m14:00:54.273178 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m14:00:54.278482 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m14:00:54.280493 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m14:00:54.281171 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
), src_listings as (select * from __dbt__cte__src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m14:00:54.281772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:54.972361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:00:54.976686 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 14:00:54.273651 => 14:00:54.976311
[0m14:00:54.977424 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m14:00:55.096637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0892ccd-6380-4c82-a608-f0752d69e951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe47f03f70>]}
[0m14:00:55.099985 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.83s]
[0m14:00:55.103491 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m14:00:55.106357 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m14:00:55.109924 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m14:00:55.113869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m14:00:55.116341 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m14:00:55.154957 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m14:00:55.156326 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 14:00:55.117925 => 14:00:55.155834
[0m14:00:55.157279 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m14:00:55.195396 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:00:55.196111 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m14:00:55.196657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:55.914937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:00:55.926777 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:00:55.927528 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m14:00:56.049855 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:00:56.066266 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:00:56.068526 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m14:00:56.152935 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:00:56.195283 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:00:56.196450 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m14:00:56.296702 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:00:56.312246 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:00:56.314962 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m14:00:56.408631 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:00:56.443121 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:00:56.463559 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m14:00:56.464595 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:00:56.465188 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m14:00:56.595427 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:00:56.597208 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:00:56.598755 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m14:00:57.142882 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:00:57.145229 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:00:57.146283 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
COMMIT
[0m14:00:57.449593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:00:57.483418 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m14:00:57.495803 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:00:57.496714 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m14:00:57.622060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:00:57.634888 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 14:00:55.157958 => 14:00:57.634610
[0m14:00:57.635529 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m14:00:57.766102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0892ccd-6380-4c82-a608-f0752d69e951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe47f03e20>]}
[0m14:00:57.769386 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.65s]
[0m14:00:57.773476 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m14:00:57.776355 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_w_hosts
[0m14:00:57.780152 [info ] [Thread-1 (]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m14:00:57.783848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.fct_reviews, now model.dbtairbnb.dim_listings_w_hosts)
[0m14:00:57.786345 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_w_hosts
[0m14:00:57.798258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_w_hosts"
[0m14:00:57.800218 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (compile): 14:00:57.787935 => 14:00:57.799498
[0m14:00:57.801887 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_w_hosts
[0m14:00:57.829532 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_w_hosts"
[0m14:00:57.831224 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_w_hosts"
[0m14:00:57.831836 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    listings as (select * from AIRBNB.dev.dim_listings_cleansed),
    hosts as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at

from listings l
left join hosts h on h.host_id = l.host_id
        );
[0m14:00:57.832388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:59.605782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:00:59.619905 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (execute): 14:00:57.802613 => 14:00:59.618694
[0m14:00:59.622381 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: Close
[0m14:00:59.744258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0892ccd-6380-4c82-a608-f0752d69e951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe4ca07190>]}
[0m14:00:59.749828 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.96s]
[0m14:00:59.755009 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_w_hosts
[0m14:00:59.758086 [debug] [Thread-1 (]: Began running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:00:59.761638 [info ] [Thread-1 (]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m14:00:59.765403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_w_hosts, now model.dbtairbnb.mart_fullmoon_reviews)
[0m14:00:59.767210 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.mart_fullmoon_reviews
[0m14:00:59.776477 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:00:59.778088 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (compile): 14:00:59.768330 => 14:00:59.777527
[0m14:00:59.779277 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.mart_fullmoon_reviews
[0m14:00:59.786552 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:00:59.788214 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:00:59.789005 [debug] [Thread-1 (]: On model.dbtairbnb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.dev.mart_fullmoon_reviews
         as
        (
with
    fct_reviews as (select * from AIRBNB.dev.fct_reviews),
    full_moon_dates as (select * from AIRBNB.dev.seed_full_moon_dates)
select
    r.*,
    case
        when fm.full_moon_date is null then 'not full moon' else 'full moon'
    end as is_full_moon
from fct_reviews r
left join
    full_moon_dates fm on (to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date))
        );
[0m14:00:59.789779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:04.516447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m14:01:04.529311 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (execute): 14:00:59.779924 => 14:01:04.528070
[0m14:01:04.532297 [debug] [Thread-1 (]: On model.dbtairbnb.mart_fullmoon_reviews: Close
[0m14:01:04.665293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0892ccd-6380-4c82-a608-f0752d69e951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe4c14c3a0>]}
[0m14:01:04.668796 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 4.90s]
[0m14:01:04.672317 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:01:04.679113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:04.681480 [debug] [MainThread]: Connection 'model.dbtairbnb.mart_fullmoon_reviews' was properly closed.
[0m14:01:04.683897 [info ] [MainThread]: 
[0m14:01:04.687026 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 13.70 seconds (13.70s).
[0m14:01:04.695422 [debug] [MainThread]: Command end result
[0m14:01:04.712513 [info ] [MainThread]: 
[0m14:01:04.713562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:01:04.714302 [info ] [MainThread]: 
[0m14:01:04.715029 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:01:04.716280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.488871, "process_user_time": 4.400372, "process_kernel_time": 0.813112, "process_mem_max_rss": "196772", "process_out_blocks": "1952", "process_in_blocks": "0"}
[0m14:01:04.717237 [debug] [MainThread]: Command `dbt run` succeeded at 14:01:04.716979 after 14.49 seconds
[0m14:01:04.718002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe75dba9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe740c9cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe47f18820>]}
[0m14:01:04.718761 [debug] [MainThread]: Flushing usage events
[0m14:01:57.235847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be904aa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be8e7ba410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be8e7ba3b0>]}


============================== 14:01:57.238300 | 77ab4a68-eaf9-424e-88eb-d7a9b3b0fb4f ==============================
[0m14:01:57.238300 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:01:57.238930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'fail_fast': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:01:57.851971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77ab4a68-eaf9-424e-88eb-d7a9b3b0fb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be8e7ba500>]}
[0m14:01:57.908742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77ab4a68-eaf9-424e-88eb-d7a9b3b0fb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be63533430>]}
[0m14:01:57.909554 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:01:57.916178 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:01:57.945212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:01:57.945972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:01:57.951466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77ab4a68-eaf9-424e-88eb-d7a9b3b0fb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be631c1d50>]}
[0m14:01:57.960318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77ab4a68-eaf9-424e-88eb-d7a9b3b0fb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be634ed240>]}
[0m14:01:57.960939 [info ] [MainThread]: Found 8 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:01:57.961525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77ab4a68-eaf9-424e-88eb-d7a9b3b0fb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be634c24a0>]}
[0m14:01:57.963288 [info ] [MainThread]: 
[0m14:01:57.964168 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:01:57.965524 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m14:01:57.978559 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m14:01:57.979141 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m14:01:57.979629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:59.000090 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:01:59.006489 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:01:59.121375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m14:01:59.152338 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:01:59.153660 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:01:59.154876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:59.791732 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:01:59.800396 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:01:59.930231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77ab4a68-eaf9-424e-88eb-d7a9b3b0fb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be634ee560>]}
[0m14:01:59.934720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:01:59.936761 [info ] [MainThread]: 
[0m14:01:59.942837 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m14:01:59.945320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m14:01:59.947210 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m14:01:59.963181 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m14:01:59.964500 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 14:01:59.948585 => 14:01:59.964047
[0m14:01:59.966074 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m14:01:59.967016 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m14:01:59.968192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m14:01:59.969207 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m14:01:59.973126 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m14:01:59.974985 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 14:01:59.969936 => 14:01:59.974451
[0m14:01:59.976361 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m14:01:59.977139 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m14:01:59.978531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m14:01:59.979385 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m14:01:59.983761 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m14:01:59.985522 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 14:01:59.980022 => 14:01:59.984877
[0m14:01:59.987868 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m14:01:59.988814 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m14:01:59.990275 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m14:01:59.991907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m14:01:59.992716 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m14:02:00.001231 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m14:02:00.002798 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 14:01:59.993315 => 14:02:00.002232
[0m14:02:00.003799 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m14:02:00.053941 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m14:02:00.056376 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m14:02:00.057617 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts as (select * from __dbt__cte__src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m14:02:00.058815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:00.817956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:02:00.864884 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 14:02:00.004499 => 14:02:00.864564
[0m14:02:00.865581 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m14:02:00.996855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab4a68-eaf9-424e-88eb-d7a9b3b0fb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be60e0ab00>]}
[0m14:02:00.997963 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.01s]
[0m14:02:00.999023 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m14:02:00.999848 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m14:02:01.000760 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m14:02:01.001866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m14:02:01.002637 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m14:02:01.010759 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m14:02:01.011990 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 14:02:01.003127 => 14:02:01.011566
[0m14:02:01.012802 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m14:02:01.018333 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m14:02:01.020248 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m14:02:01.020993 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
), src_listings as (select * from __dbt__cte__src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m14:02:01.021724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:01.655206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:02:01.670149 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 14:02:01.013309 => 14:02:01.668620
[0m14:02:01.672627 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m14:02:01.770138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab4a68-eaf9-424e-88eb-d7a9b3b0fb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be630d29e0>]}
[0m14:02:01.771766 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.77s]
[0m14:02:01.773241 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m14:02:01.774473 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m14:02:01.775952 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m14:02:01.777357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m14:02:01.778292 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m14:02:01.793096 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m14:02:01.794038 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 14:02:01.778883 => 14:02:01.793721
[0m14:02:01.794644 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m14:02:01.826133 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:02:01.826782 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m14:02:01.827343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:02.574560 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:02:02.592010 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:02:02.593225 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m14:02:02.713124 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:02:02.733409 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:02:02.736124 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m14:02:02.843151 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:02:02.886051 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:02:02.887023 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m14:02:03.029048 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:02:03.046032 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:02:03.050790 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m14:02:03.149389 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:02:03.184238 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:02:03.204805 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m14:02:03.205908 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:02:03.206509 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m14:02:03.497565 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:02:03.500794 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:02:03.503611 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m14:02:03.804327 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:02:03.808531 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:02:03.811047 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
COMMIT
[0m14:02:04.112621 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:02:04.147907 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m14:02:04.159282 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:02:04.160112 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m14:02:04.332674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:02:04.337988 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 14:02:01.795026 => 14:02:04.337499
[0m14:02:04.338958 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m14:02:04.478291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab4a68-eaf9-424e-88eb-d7a9b3b0fb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be627417e0>]}
[0m14:02:04.481985 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.70s]
[0m14:02:04.484733 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m14:02:04.486204 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_w_hosts
[0m14:02:04.488060 [info ] [Thread-1 (]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m14:02:04.489830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.fct_reviews, now model.dbtairbnb.dim_listings_w_hosts)
[0m14:02:04.490898 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_w_hosts
[0m14:02:04.497027 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_w_hosts"
[0m14:02:04.498628 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (compile): 14:02:04.491610 => 14:02:04.498059
[0m14:02:04.499695 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_w_hosts
[0m14:02:04.533452 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_w_hosts"
[0m14:02:04.534988 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_w_hosts"
[0m14:02:04.535629 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    listings as (select * from AIRBNB.dev.dim_listings_cleansed),
    hosts as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at

from listings l
left join hosts h on h.host_id = l.host_id
        );
[0m14:02:04.536238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:06.235264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:02:06.239946 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (execute): 14:02:04.500375 => 14:02:06.239450
[0m14:02:06.241004 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: Close
[0m14:02:06.326876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab4a68-eaf9-424e-88eb-d7a9b3b0fb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be60e79c90>]}
[0m14:02:06.330686 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.84s]
[0m14:02:06.334134 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_w_hosts
[0m14:02:06.337108 [debug] [Thread-1 (]: Began running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:02:06.340390 [info ] [Thread-1 (]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m14:02:06.344802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_w_hosts, now model.dbtairbnb.mart_fullmoon_reviews)
[0m14:02:06.347761 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.mart_fullmoon_reviews
[0m14:02:06.358727 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:02:06.360977 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (compile): 14:02:06.349303 => 14:02:06.360162
[0m14:02:06.362230 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.mart_fullmoon_reviews
[0m14:02:06.370673 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:02:06.372251 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:02:06.373000 [debug] [Thread-1 (]: On model.dbtairbnb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.dev.mart_fullmoon_reviews
         as
        (

with
    fct_reviews as (select * from AIRBNB.dev.fct_reviews),
    full_moon_dates(select * from AIRBNB.dev.seed_full_moon_dates)
select
    r.*,
    case
        when fm.full_moon_dates is null then 'not full moon' else 'full moon'
    end as is_full_moon
from fct_reviews r
left join
    full_moon_dates fm on (to_date(r.review_date) = dateadd(day, 1, fm.full_moon_dates))
        );
[0m14:02:06.373723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:07.017611 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b46a1e-0000-437b-0000-000052fd5cf1
[0m14:02:07.018277 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 20 unexpected 'select'.
syntax error line 15 at position 26 unexpected '('.
[0m14:02:07.019088 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (execute): 14:02:06.363243 => 14:02:07.018804
[0m14:02:07.019690 [debug] [Thread-1 (]: On model.dbtairbnb.mart_fullmoon_reviews: Close
[0m14:02:07.135890 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 20 unexpected 'select'.
  syntax error line 15 at position 26 unexpected '('.
  compiled Code at target/run/dbtairbnb/models/mart/mart_fullmoon_reviews.sql
[0m14:02:07.136750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab4a68-eaf9-424e-88eb-d7a9b3b0fb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be60ceece0>]}
[0m14:02:07.137501 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model dev.mart_fullmoon_reviews ................ [[31mERROR[0m in 0.79s]
[0m14:02:07.138455 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:02:07.140639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:07.141317 [debug] [MainThread]: Connection 'model.dbtairbnb.mart_fullmoon_reviews' was properly closed.
[0m14:02:07.141951 [info ] [MainThread]: 
[0m14:02:07.142512 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 9.18 seconds (9.18s).
[0m14:02:07.144082 [debug] [MainThread]: Command end result
[0m14:02:07.155229 [info ] [MainThread]: 
[0m14:02:07.155954 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:02:07.156624 [info ] [MainThread]: 
[0m14:02:07.157478 [error] [MainThread]:   Database Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 20 unexpected 'select'.
  syntax error line 15 at position 26 unexpected '('.
  compiled Code at target/run/dbtairbnb/models/mart/mart_fullmoon_reviews.sql
[0m14:02:07.158363 [info ] [MainThread]: 
[0m14:02:07.158897 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:02:07.159988 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.965676, "process_user_time": 4.297967, "process_kernel_time": 0.836596, "process_mem_max_rss": "197472", "process_out_blocks": "1944", "command_success": false, "process_in_blocks": "0"}
[0m14:02:07.160803 [debug] [MainThread]: Command `dbt run` failed at 14:02:07.160581 after 9.97 seconds
[0m14:02:07.161340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be904aa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be63380e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be63190040>]}
[0m14:02:07.162024 [debug] [MainThread]: Flushing usage events
[0m14:03:14.643965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7654366b29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7654349da380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7654349da320>]}


============================== 14:03:14.646424 | a402e843-c41e-44fb-96ea-9ddd898d2284 ==============================
[0m14:03:14.646424 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:03:14.647061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/lkeiti/.dbt', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:03:15.280801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a402e843-c41e-44fb-96ea-9ddd898d2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7654349da470>]}
[0m14:03:15.340963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a402e843-c41e-44fb-96ea-9ddd898d2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7654349d9cf0>]}
[0m14:03:15.341841 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:03:15.348523 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:03:15.377133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:03:15.377751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:03:15.383163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a402e843-c41e-44fb-96ea-9ddd898d2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76540d2a9cc0>]}
[0m14:03:15.392670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a402e843-c41e-44fb-96ea-9ddd898d2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76540d473580>]}
[0m14:03:15.393298 [info ] [MainThread]: Found 8 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:03:15.393994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a402e843-c41e-44fb-96ea-9ddd898d2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76540d280190>]}
[0m14:03:15.395674 [info ] [MainThread]: 
[0m14:03:15.396501 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:03:15.397890 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m14:03:15.411058 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m14:03:15.411676 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m14:03:15.412194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:16.407299 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:03:16.413840 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:03:16.605866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m14:03:16.638791 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:03:16.640525 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:03:16.641797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:17.532014 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:03:17.539489 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:03:17.635399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a402e843-c41e-44fb-96ea-9ddd898d2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76540d280160>]}
[0m14:03:17.637818 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:03:17.639399 [info ] [MainThread]: 
[0m14:03:17.643788 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m14:03:17.646400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m14:03:17.648253 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m14:03:17.660561 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m14:03:17.661696 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 14:03:17.649510 => 14:03:17.661308
[0m14:03:17.663022 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m14:03:17.663728 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m14:03:17.664700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m14:03:17.665607 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m14:03:17.667572 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m14:03:17.668386 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 14:03:17.665960 => 14:03:17.668110
[0m14:03:17.669317 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m14:03:17.670248 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m14:03:17.671245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m14:03:17.671876 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m14:03:17.674098 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m14:03:17.675192 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 14:03:17.672227 => 14:03:17.674788
[0m14:03:17.676382 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m14:03:17.676973 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m14:03:17.677755 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m14:03:17.678588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m14:03:17.679123 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m14:03:17.683960 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m14:03:17.684748 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 14:03:17.679465 => 14:03:17.684450
[0m14:03:17.685278 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m14:03:17.715808 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m14:03:17.717116 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m14:03:17.717693 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts as (select * from __dbt__cte__src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m14:03:17.718245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:18.760812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:03:18.781740 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 14:03:17.685673 => 14:03:18.781408
[0m14:03:18.782385 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m14:03:18.852982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a402e843-c41e-44fb-96ea-9ddd898d2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76540c8eea40>]}
[0m14:03:18.854853 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.17s]
[0m14:03:18.856916 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m14:03:18.858639 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m14:03:18.860247 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m14:03:18.862237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m14:03:18.863583 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m14:03:18.879493 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m14:03:18.881111 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 14:03:18.864431 => 14:03:18.880548
[0m14:03:18.882207 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m14:03:18.888936 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m14:03:18.891333 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m14:03:18.892297 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
), src_listings as (select * from __dbt__cte__src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m14:03:18.893071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:19.685573 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:03:19.703089 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 14:03:18.882900 => 14:03:19.701167
[0m14:03:19.706232 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m14:03:19.844788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a402e843-c41e-44fb-96ea-9ddd898d2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76540d1b9510>]}
[0m14:03:19.848789 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.98s]
[0m14:03:19.852260 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m14:03:19.856704 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m14:03:19.861453 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m14:03:19.865186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m14:03:19.867020 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m14:03:19.890422 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m14:03:19.891737 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 14:03:19.868155 => 14:03:19.891340
[0m14:03:19.892432 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m14:03:19.925829 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:03:19.926628 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m14:03:19.927203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:21.220625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:03:21.252497 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:03:21.253946 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m14:03:21.375605 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:03:21.391636 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:03:21.394487 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m14:03:21.491125 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:03:21.536749 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:03:21.537733 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m14:03:21.646315 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:03:21.662220 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:03:21.664766 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m14:03:21.747754 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:03:21.783362 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:03:21.803822 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m14:03:21.804949 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:03:21.805654 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m14:03:21.993910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:03:21.996522 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:03:21.999010 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m14:03:22.446937 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:03:22.449737 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:03:22.452182 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
COMMIT
[0m14:03:22.673930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:03:22.696701 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m14:03:22.709951 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:03:22.710637 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m14:03:22.842849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:03:22.845880 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 14:03:19.892865 => 14:03:22.845607
[0m14:03:22.846443 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m14:03:23.009289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a402e843-c41e-44fb-96ea-9ddd898d2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76540d22bbe0>]}
[0m14:03:23.012690 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 3.14s]
[0m14:03:23.016361 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m14:03:23.019170 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_w_hosts
[0m14:03:23.022708 [info ] [Thread-1 (]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m14:03:23.027067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.fct_reviews, now model.dbtairbnb.dim_listings_w_hosts)
[0m14:03:23.029995 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_w_hosts
[0m14:03:23.040332 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_w_hosts"
[0m14:03:23.042114 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (compile): 14:03:23.031739 => 14:03:23.041513
[0m14:03:23.043225 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_w_hosts
[0m14:03:23.069598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_w_hosts"
[0m14:03:23.070977 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_w_hosts"
[0m14:03:23.071558 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    listings as (select * from AIRBNB.dev.dim_listings_cleansed),
    hosts as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at

from listings l
left join hosts h on h.host_id = l.host_id
        );
[0m14:03:23.072254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:24.823864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:03:24.827852 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (execute): 14:03:23.043921 => 14:03:24.827562
[0m14:03:24.828699 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: Close
[0m14:03:24.972740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a402e843-c41e-44fb-96ea-9ddd898d2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76540d1c9480>]}
[0m14:03:24.974626 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.95s]
[0m14:03:24.976115 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_w_hosts
[0m14:03:24.977264 [debug] [Thread-1 (]: Began running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:03:24.978749 [info ] [Thread-1 (]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m14:03:24.980456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_w_hosts, now model.dbtairbnb.mart_fullmoon_reviews)
[0m14:03:24.981530 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.mart_fullmoon_reviews
[0m14:03:24.988202 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:03:24.989969 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (compile): 14:03:24.982205 => 14:03:24.989219
[0m14:03:24.991498 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.mart_fullmoon_reviews
[0m14:03:24.999723 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:03:25.001574 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:03:25.002711 [debug] [Thread-1 (]: On model.dbtairbnb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.dev.mart_fullmoon_reviews
         as
        (

with
    fct_reviews as (select * from AIRBNB.dev.fct_reviews),
    full_moon_dates as (select * from AIRBNB.dev.seed_full_moon_dates)
select
    r.*,
    case
        when fm.full_moon_dates is null then 'not full moon' else 'full moon'
    end as is_full_moon
from fct_reviews r
left join
    full_moon_dates fm on (to_date(r.review_date) = dateadd(day, 1, fm.full_moon_dates))
        );
[0m14:03:25.004016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:25.836112 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b46a1f-0000-4377-0000-000052fd4d79
[0m14:03:25.838487 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 13
invalid identifier 'FM.FULL_MOON_DATES'
[0m14:03:25.840940 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (execute): 14:03:24.992306 => 14:03:25.840053
[0m14:03:25.842426 [debug] [Thread-1 (]: On model.dbtairbnb.mart_fullmoon_reviews: Close
[0m14:03:25.995725 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)
  000904 (42000): SQL compilation error: error line 11 at position 13
  invalid identifier 'FM.FULL_MOON_DATES'
  compiled Code at target/run/dbtairbnb/models/mart/mart_fullmoon_reviews.sql
[0m14:03:25.996753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a402e843-c41e-44fb-96ea-9ddd898d2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7653fef0c190>]}
[0m14:03:25.997724 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model dev.mart_fullmoon_reviews ................ [[31mERROR[0m in 1.02s]
[0m14:03:25.998691 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:03:26.001125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:26.001686 [debug] [MainThread]: Connection 'model.dbtairbnb.mart_fullmoon_reviews' was properly closed.
[0m14:03:26.002327 [info ] [MainThread]: 
[0m14:03:26.002961 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 10.61 seconds (10.61s).
[0m14:03:26.004703 [debug] [MainThread]: Command end result
[0m14:03:26.015063 [info ] [MainThread]: 
[0m14:03:26.015671 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:03:26.016171 [info ] [MainThread]: 
[0m14:03:26.016684 [error] [MainThread]:   Database Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)
  000904 (42000): SQL compilation error: error line 11 at position 13
  invalid identifier 'FM.FULL_MOON_DATES'
  compiled Code at target/run/dbtairbnb/models/mart/mart_fullmoon_reviews.sql
[0m14:03:26.017194 [info ] [MainThread]: 
[0m14:03:26.017759 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:03:26.018709 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.416291, "process_user_time": 4.18207, "process_kernel_time": 0.789902, "process_mem_max_rss": "197752", "process_out_blocks": "1960", "command_success": false, "process_in_blocks": "0"}
[0m14:03:26.019692 [debug] [MainThread]: Command `dbt run` failed at 14:03:26.019473 after 11.42 seconds
[0m14:03:26.020307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7654366b29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7654349d9cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76540d2800a0>]}
[0m14:03:26.020866 [debug] [MainThread]: Flushing usage events
[0m14:06:17.414517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797f153a29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797f136ce3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797f136ce380>]}


============================== 14:06:17.416823 | c1f2644e-4196-41c1-ad8a-ad35fed3e8d1 ==============================
[0m14:06:17.416823 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:06:17.417557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:18.036499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1f2644e-4196-41c1-ad8a-ad35fed3e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797f136ce4d0>]}
[0m14:06:18.094144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1f2644e-4196-41c1-ad8a-ad35fed3e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797eec2cce20>]}
[0m14:06:18.094936 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:06:18.101628 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:06:18.131506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:18.132056 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:18.137714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1f2644e-4196-41c1-ad8a-ad35fed3e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ee7f19d20>]}
[0m14:06:18.146188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1f2644e-4196-41c1-ad8a-ad35fed3e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797eec350670>]}
[0m14:06:18.146839 [info ] [MainThread]: Found 8 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:06:18.147538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1f2644e-4196-41c1-ad8a-ad35fed3e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797eec168160>]}
[0m14:06:18.149224 [info ] [MainThread]: 
[0m14:06:18.150064 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:06:18.151423 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m14:06:18.168737 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m14:06:18.169665 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m14:06:18.170142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:18.881768 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:06:18.888064 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:06:18.988634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m14:06:19.021312 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:06:19.022902 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:06:19.024180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:19.833719 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:06:19.841045 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:06:19.945322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1f2644e-4196-41c1-ad8a-ad35fed3e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797eec353670>]}
[0m14:06:19.949242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:06:19.951767 [info ] [MainThread]: 
[0m14:06:19.959705 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m14:06:19.963735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m14:06:19.966432 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m14:06:19.989327 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m14:06:19.990711 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 14:06:19.968066 => 14:06:19.990253
[0m14:06:19.992441 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m14:06:19.993720 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m14:06:19.995065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m14:06:19.995925 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m14:06:19.998734 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m14:06:19.999936 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 14:06:19.996411 => 14:06:19.999531
[0m14:06:20.001207 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m14:06:20.001999 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m14:06:20.003029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m14:06:20.003793 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m14:06:20.006071 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m14:06:20.006886 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 14:06:20.004254 => 14:06:20.006578
[0m14:06:20.007901 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m14:06:20.008563 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m14:06:20.009255 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m14:06:20.010541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now model.dbtairbnb.dim_hosts_cleansed)
[0m14:06:20.011519 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m14:06:20.017616 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m14:06:20.018493 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 14:06:20.012126 => 14:06:20.018204
[0m14:06:20.019022 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m14:06:20.047033 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_hosts_cleansed"
[0m14:06:20.048453 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_hosts_cleansed"
[0m14:06:20.049142 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_hosts_cleansed"} */
create or replace   view AIRBNB.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (select * from airbnb.raw.raw_hosts)
select id as host_id, name as host_name, is_superhost, created_at, updated_at
from raw_hosts
), src_hosts as (select * from __dbt__cte__src_hosts)
select
    host_id,
    nvl(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m14:06:20.049736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:20.930021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:06:20.985560 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 14:06:20.019366 => 14:06:20.985194
[0m14:06:20.986306 [debug] [Thread-1 (]: On model.dbtairbnb.dim_hosts_cleansed: Close
[0m14:06:21.125091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f2644e-4196-41c1-ad8a-ad35fed3e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797f136ce3b0>]}
[0m14:06:21.126601 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.11s]
[0m14:06:21.128077 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m14:06:21.129151 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m14:06:21.130276 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m14:06:21.131586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m14:06:21.132534 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m14:06:21.140906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m14:06:21.141989 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 14:06:21.133102 => 14:06:21.141612
[0m14:06:21.142686 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m14:06:21.147613 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_cleansed"
[0m14:06:21.149257 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_cleansed"
[0m14:06:21.150000 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_cleansed"} */
create or replace   view AIRBNB.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (select * from airbnb.raw.raw_listings)
select
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
from raw_listings
), src_listings as (select * from __dbt__cte__src_listings)
select
    listing_id,
    listing_name,
    room_type,
    case when minimum_nights = 0 then 1 else minimum_nights end as minimum_nights,
    host_id,
    replace(price_str, '$')::number(10, 2) as price,
    created_at,
    updated_at
from src_listings
  );
[0m14:06:21.150558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:22.159187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:06:22.173484 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 14:06:21.143134 => 14:06:22.172267
[0m14:06:22.176037 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_cleansed: Close
[0m14:06:22.262393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f2644e-4196-41c1-ad8a-ad35fed3e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ee7628100>]}
[0m14:06:22.265740 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.13s]
[0m14:06:22.269253 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m14:06:22.272116 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m14:06:22.275944 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m14:06:22.280201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m14:06:22.282651 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m14:06:22.305229 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m14:06:22.306438 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 14:06:22.283810 => 14:06:22.306046
[0m14:06:22.307176 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m14:06:22.340054 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:06:22.340751 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
create or replace  temporary view AIRBNB.dev.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (select * from airbnb.raw.raw_reviews)
select
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
from raw_reviews
), src_reviews as (select * from __dbt__cte__src_reviews)
select *
from src_reviews
where
    review_text is not null

    
        and review_date > (select max(review_date) from AIRBNB.dev.fct_reviews)
    
  );
[0m14:06:22.341301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:23.079627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:06:23.111536 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:06:23.112952 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m14:06:23.232274 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:06:23.248800 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:06:23.251419 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews
[0m14:06:23.341106 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:06:23.381888 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:06:23.383644 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table AIRBNB.dev.fct_reviews__dbt_tmp
[0m14:06:23.483427 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:06:23.499761 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:06:23.502319 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m14:06:23.596155 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:06:23.621933 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:06:23.647210 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.fct_reviews"
[0m14:06:23.649004 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:06:23.650066 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m14:06:24.001725 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:06:24.004372 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:06:24.007001 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
insert into AIRBNB.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.dev.fct_reviews__dbt_tmp
        );
[0m14:06:24.307885 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:06:24.309262 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:06:24.310152 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
COMMIT
[0m14:06:24.614364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:06:24.630039 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.dev.fct_reviews__dbt_tmp
[0m14:06:24.638322 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.fct_reviews"
[0m14:06:24.639026 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.fct_reviews"} */
drop view if exists AIRBNB.dev.fct_reviews__dbt_tmp cascade
[0m14:06:24.826168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:06:24.833915 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 14:06:22.307611 => 14:06:24.833224
[0m14:06:24.835135 [debug] [Thread-1 (]: On model.dbtairbnb.fct_reviews: Close
[0m14:06:24.960468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f2644e-4196-41c1-ad8a-ad35fed3e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ee7f4e3b0>]}
[0m14:06:24.962249 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.68s]
[0m14:06:24.963954 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m14:06:24.965306 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_w_hosts
[0m14:06:24.966881 [info ] [Thread-1 (]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m14:06:24.968286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.fct_reviews, now model.dbtairbnb.dim_listings_w_hosts)
[0m14:06:24.969103 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_w_hosts
[0m14:06:24.974658 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_w_hosts"
[0m14:06:24.976628 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (compile): 14:06:24.969646 => 14:06:24.975902
[0m14:06:24.977826 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_w_hosts
[0m14:06:25.005613 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.dim_listings_w_hosts"
[0m14:06:25.007303 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.dim_listings_w_hosts"
[0m14:06:25.008215 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.dev.dim_listings_w_hosts
         as
        (with
    listings as (select * from AIRBNB.dev.dim_listings_cleansed),
    hosts as (select * from AIRBNB.dev.dim_hosts_cleansed)
select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at

from listings l
left join hosts h on h.host_id = l.host_id
        );
[0m14:06:25.009020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:26.555439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:06:26.569348 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (execute): 14:06:24.978517 => 14:06:26.568133
[0m14:06:26.572060 [debug] [Thread-1 (]: On model.dbtairbnb.dim_listings_w_hosts: Close
[0m14:06:26.660441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f2644e-4196-41c1-ad8a-ad35fed3e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ee7543ac0>]}
[0m14:06:26.666543 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.69s]
[0m14:06:26.673043 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_w_hosts
[0m14:06:26.677487 [debug] [Thread-1 (]: Began running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:06:26.681281 [info ] [Thread-1 (]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m14:06:26.684956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_w_hosts, now model.dbtairbnb.mart_fullmoon_reviews)
[0m14:06:26.686874 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.mart_fullmoon_reviews
[0m14:06:26.693504 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:06:26.695124 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (compile): 14:06:26.687580 => 14:06:26.694616
[0m14:06:26.696019 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.mart_fullmoon_reviews
[0m14:06:26.702069 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:06:26.703526 [debug] [Thread-1 (]: Using snowflake connection "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:06:26.704219 [debug] [Thread-1 (]: On model.dbtairbnb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "model.dbtairbnb.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.dev.mart_fullmoon_reviews
         as
        (
with
    fct_reviews as (select * from AIRBNB.dev.fct_reviews),
    full_moon_dates as (select * from AIRBNB.dev.seed_full_moon_dates)
select
    r.*,
    case
        when fm.full_moon_date is null then 'not full moon' else 'full moon'
    end as is_full_moon
from fct_reviews r
left join
    full_moon_dates fm on (to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date))
        );
[0m14:06:26.704896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:30.149841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m14:06:30.164341 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (execute): 14:06:26.696515 => 14:06:30.163081
[0m14:06:30.166931 [debug] [Thread-1 (]: On model.dbtairbnb.mart_fullmoon_reviews: Close
[0m14:06:30.296711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f2644e-4196-41c1-ad8a-ad35fed3e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ee5c2efe0>]}
[0m14:06:30.300107 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 3.61s]
[0m14:06:30.303774 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:06:30.310464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:30.312710 [debug] [MainThread]: Connection 'model.dbtairbnb.mart_fullmoon_reviews' was properly closed.
[0m14:06:30.315188 [info ] [MainThread]: 
[0m14:06:30.317585 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 12.16 seconds (12.16s).
[0m14:06:30.324844 [debug] [MainThread]: Command end result
[0m14:06:30.342884 [info ] [MainThread]: 
[0m14:06:30.343916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:30.344770 [info ] [MainThread]: 
[0m14:06:30.345619 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:06:30.346913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.973028, "process_user_time": 4.325601, "process_kernel_time": 0.858729, "process_mem_max_rss": "196768", "process_out_blocks": "1952", "process_in_blocks": "0"}
[0m14:06:30.347884 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:30.347624 after 12.97 seconds
[0m14:06:30.348627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797f153a29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797eec4bde40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797eec4bdc60>]}
[0m14:06:30.349381 [debug] [MainThread]: Flushing usage events
[0m14:09:48.567140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8def3b29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8ded6de3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8ded6de380>]}


============================== 14:09:48.569590 | be4fdbcc-34a4-4079-97f9-39c18ddb2ec6 ==============================
[0m14:09:48.569590 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:09:48.570239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m14:09:49.195880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be4fdbcc-34a4-4079-97f9-39c18ddb2ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8ded6de4d0>]}
[0m14:09:49.273096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be4fdbcc-34a4-4079-97f9-39c18ddb2ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8dc2340e20>]}
[0m14:09:49.273931 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:09:49.280754 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:09:49.310597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:09:49.311334 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:09:49.317069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be4fdbcc-34a4-4079-97f9-39c18ddb2ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8dc201a650>]}
[0m14:09:49.325950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be4fdbcc-34a4-4079-97f9-39c18ddb2ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8dc1fe4040>]}
[0m14:09:49.326585 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:09:49.327121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4fdbcc-34a4-4079-97f9-39c18ddb2ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8dc1fe4640>]}
[0m14:09:49.328953 [info ] [MainThread]: 
[0m14:09:49.329864 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:09:49.331416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m14:09:49.394177 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:09:49.394761 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:09:49.395244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:50.441025 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:09:50.448161 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:09:50.582460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4fdbcc-34a4-4079-97f9-39c18ddb2ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8dc1fd3ac0>]}
[0m14:09:50.586561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:09:50.589112 [info ] [MainThread]: 
[0m14:09:50.598230 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m14:09:50.601839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtairbnb.src_hosts)
[0m14:09:50.604358 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m14:09:50.632570 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m14:09:50.634195 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 14:09:50.606044 => 14:09:50.633635
[0m14:09:50.635850 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m14:09:50.636804 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m14:09:50.638185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m14:09:50.639192 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m14:09:50.643388 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m14:09:50.644502 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 14:09:50.639838 => 14:09:50.644109
[0m14:09:50.645698 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m14:09:50.646401 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m14:09:50.647306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m14:09:50.648154 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m14:09:50.651405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m14:09:50.652209 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 14:09:50.648619 => 14:09:50.651906
[0m14:09:50.653214 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m14:09:50.653863 [debug] [Thread-1 (]: Began running node seed.dbtairbnb.seed_full_moon_dates
[0m14:09:50.654683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now seed.dbtairbnb.seed_full_moon_dates)
[0m14:09:50.655214 [debug] [Thread-1 (]: Began compiling node seed.dbtairbnb.seed_full_moon_dates
[0m14:09:50.657261 [debug] [Thread-1 (]: Timing info for seed.dbtairbnb.seed_full_moon_dates (compile): 14:09:50.655550 => 14:09:50.656980
[0m14:09:50.658074 [debug] [Thread-1 (]: Began executing node seed.dbtairbnb.seed_full_moon_dates
[0m14:09:50.658745 [debug] [Thread-1 (]: Timing info for seed.dbtairbnb.seed_full_moon_dates (execute): 14:09:50.658451 => 14:09:50.658458
[0m14:09:50.659738 [debug] [Thread-1 (]: Finished running node seed.dbtairbnb.seed_full_moon_dates
[0m14:09:50.660307 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m14:09:50.661030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtairbnb.seed_full_moon_dates, now model.dbtairbnb.dim_hosts_cleansed)
[0m14:09:50.661573 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m14:09:50.667092 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m14:09:50.667884 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 14:09:50.661916 => 14:09:50.667598
[0m14:09:50.668414 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m14:09:50.669023 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 14:09:50.668755 => 14:09:50.668762
[0m14:09:50.670058 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m14:09:50.670630 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m14:09:50.671365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m14:09:50.671899 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m14:09:50.677858 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m14:09:50.678617 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 14:09:50.672240 => 14:09:50.678337
[0m14:09:50.679144 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m14:09:50.679751 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 14:09:50.679483 => 14:09:50.679490
[0m14:09:50.680716 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m14:09:50.681281 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m14:09:50.682073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m14:09:50.682608 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m14:09:50.692642 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m14:09:50.693479 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 14:09:50.683006 => 14:09:50.693190
[0m14:09:50.694067 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m14:09:50.694691 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 14:09:50.694415 => 14:09:50.694424
[0m14:09:50.695687 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m14:09:50.696267 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_w_hosts
[0m14:09:50.697008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.fct_reviews, now model.dbtairbnb.dim_listings_w_hosts)
[0m14:09:50.697763 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_w_hosts
[0m14:09:50.700728 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_w_hosts"
[0m14:09:50.701472 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (compile): 14:09:50.698117 => 14:09:50.701191
[0m14:09:50.702050 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_w_hosts
[0m14:09:50.702706 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (execute): 14:09:50.702436 => 14:09:50.702443
[0m14:09:50.703672 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_w_hosts
[0m14:09:50.704244 [debug] [Thread-1 (]: Began running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:09:50.704976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_w_hosts, now model.dbtairbnb.mart_fullmoon_reviews)
[0m14:09:50.705688 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.mart_fullmoon_reviews
[0m14:09:50.709109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:09:50.709885 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (compile): 14:09:50.706262 => 14:09:50.709601
[0m14:09:50.710410 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.mart_fullmoon_reviews
[0m14:09:50.711013 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (execute): 14:09:50.710748 => 14:09:50.710755
[0m14:09:50.712090 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:09:50.713096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:50.713667 [debug] [MainThread]: Connection 'model.dbtairbnb.mart_fullmoon_reviews' was properly closed.
[0m14:09:50.715138 [debug] [MainThread]: Command end result
[0m14:09:50.723688 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.1984637, "process_user_time": 3.262458, "process_kernel_time": 0.830589, "process_mem_max_rss": "194808", "process_out_blocks": "1896", "process_in_blocks": "0"}
[0m14:09:50.724455 [debug] [MainThread]: Command `dbt compile` succeeded at 14:09:50.724266 after 2.20 seconds
[0m14:09:50.725065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8def3b29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8dc2504730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8dc1fd2b00>]}
[0m14:09:50.725689 [debug] [MainThread]: Flushing usage events
[0m14:11:46.203776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027d18a69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027cfbb6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027cfbb64a0>]}


============================== 14:11:46.206171 | b1b14084-67e1-4434-b0d2-e96b38f694f8 ==============================
[0m14:11:46.206171 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:11:46.206804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:46.819774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1b14084-67e1-4434-b0d2-e96b38f694f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027cfbb65f0>]}
[0m14:11:46.877729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1b14084-67e1-4434-b0d2-e96b38f694f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027cfbb6800>]}
[0m14:11:46.878549 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:11:46.885290 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:11:46.916198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:46.916758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:46.922637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1b14084-67e1-4434-b0d2-e96b38f694f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027a86ca770>]}
[0m14:11:46.932014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1b14084-67e1-4434-b0d2-e96b38f694f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027a87f82b0>]}
[0m14:11:46.932652 [info ] [MainThread]: Found 1 seed, 8 models, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:11:46.933218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1b14084-67e1-4434-b0d2-e96b38f694f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027a87faf20>]}
[0m14:11:46.934849 [info ] [MainThread]: 
[0m14:11:46.935682 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:11:46.937353 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m14:11:46.999251 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:11:46.999815 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:11:47.000287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:47.794677 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:11:47.796589 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:11:47.885392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1b14084-67e1-4434-b0d2-e96b38f694f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027a8687fd0>]}
[0m14:11:47.889358 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:47.891878 [info ] [MainThread]: 
[0m14:11:47.899158 [debug] [Thread-1 (]: Began running node source.dbtairbnb.airbnb.reviews
[0m14:11:47.900791 [info ] [Thread-1 (]: 1 of 1 START freshness of airbnb.reviews ....................................... [RUN]
[0m14:11:47.902829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now source.dbtairbnb.airbnb.reviews)
[0m14:11:47.904201 [debug] [Thread-1 (]: Began compiling node source.dbtairbnb.airbnb.reviews
[0m14:11:47.905653 [debug] [Thread-1 (]: Timing info for source.dbtairbnb.airbnb.reviews (compile): 14:11:47.905097 => 14:11:47.905103
[0m14:11:47.906698 [debug] [Thread-1 (]: Began executing node source.dbtairbnb.airbnb.reviews
[0m14:11:47.921706 [debug] [Thread-1 (]: Using snowflake connection "source.dbtairbnb.airbnb.reviews"
[0m14:11:47.922957 [debug] [Thread-1 (]: On source.dbtairbnb.airbnb.reviews: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "source.dbtairbnb.airbnb.reviews"} */
select table_schema as schema,
               table_name as identifier,
               last_altered as last_modified,
               convert_timezone('UTC', current_timestamp()) as snapshotted_at
        from AIRBNB.INFORMATION_SCHEMA.tables
        where ((upper(table_schema) = upper('raw') and
             upper(table_name) = upper('raw_reviews')))
[0m14:11:47.924218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:49.462505 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:11:49.469568 [debug] [Thread-1 (]: On source.dbtairbnb.airbnb.reviews: Close
[0m14:11:49.592351 [debug] [Thread-1 (]: Timing info for source.dbtairbnb.airbnb.reviews (execute): 14:11:47.907375 => 14:11:49.590845
[0m14:11:49.596477 [warn ] [Thread-1 (]: 1 of 1 WARN freshness of airbnb.reviews ........................................ [[33mWARN[0m in 1.69s]
[0m14:11:49.599945 [debug] [Thread-1 (]: Finished running node source.dbtairbnb.airbnb.reviews
[0m14:11:49.604282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:49.606799 [debug] [MainThread]: Connection 'source.dbtairbnb.airbnb.reviews' was properly closed.
[0m14:11:49.630773 [info ] [MainThread]: Done.
[0m14:11:49.633088 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 3.4702609, "process_user_time": 3.244567, "process_kernel_time": 0.797191, "process_mem_max_rss": "195044", "process_in_blocks": "200", "process_out_blocks": "1800"}
[0m14:11:49.635356 [debug] [MainThread]: Command `dbt source freshness` succeeded at 14:11:49.634847 after 3.47 seconds
[0m14:11:49.636838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027d18a69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027cfbb6800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027a82f29b0>]}
[0m14:11:49.638265 [debug] [MainThread]: Flushing usage events
[0m14:18:09.205450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb494a69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb477ba3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb477ba350>]}


============================== 14:18:09.207965 | c4848fba-5b1a-41ad-b287-41f8b418c5bf ==============================
[0m14:18:09.207965 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:18:09.208925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m14:18:09.831182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4848fba-5b1a-41ad-b287-41f8b418c5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb477ba4a0>]}
[0m14:18:09.889616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4848fba-5b1a-41ad-b287-41f8b418c5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb205bb250>]}
[0m14:18:09.890498 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:18:09.897850 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:18:09.927373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:18:09.928084 [debug] [MainThread]: Partial parsing: added file: dbtairbnb://snapshots/scd_new_listings.sql
[0m14:18:10.120850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4848fba-5b1a-41ad-b287-41f8b418c5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1bf69510>]}
[0m14:18:10.129695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4848fba-5b1a-41ad-b287-41f8b418c5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2027f010>]}
[0m14:18:10.130404 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:18:10.130912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4848fba-5b1a-41ad-b287-41f8b418c5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2027fa90>]}
[0m14:18:10.132493 [info ] [MainThread]: 
[0m14:18:10.133308 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:18:10.134529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m14:18:10.147086 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m14:18:10.147648 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m14:18:10.148115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:10.856248 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:18:10.863664 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:18:10.968603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m14:18:10.988388 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:18:10.989311 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:18:10.990096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:11.791993 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:18:11.799033 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:18:11.937266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m14:18:11.955855 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:18:11.958243 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:18:11.960389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:12.583559 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:18:12.590524 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:18:12.747867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4848fba-5b1a-41ad-b287-41f8b418c5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1bef3640>]}
[0m14:18:12.751777 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:12.754258 [info ] [MainThread]: 
[0m14:18:12.761436 [debug] [Thread-1 (]: Began running node snapshot.dbtairbnb.scd_raw_listings
[0m14:18:12.763615 [info ] [Thread-1 (]: 1 of 1 START snapshot DEV.scd_raw_listings ..................................... [RUN]
[0m14:18:12.765596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now snapshot.dbtairbnb.scd_raw_listings)
[0m14:18:12.766928 [debug] [Thread-1 (]: Began compiling node snapshot.dbtairbnb.scd_raw_listings
[0m14:18:12.784507 [debug] [Thread-1 (]: Timing info for snapshot.dbtairbnb.scd_raw_listings (compile): 14:18:12.767727 => 14:18:12.784080
[0m14:18:12.785243 [debug] [Thread-1 (]: Began executing node snapshot.dbtairbnb.scd_raw_listings
[0m14:18:12.847113 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtairbnb.scd_raw_listings"
[0m14:18:12.848371 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtairbnb.scd_raw_listings"
[0m14:18:12.848938 [debug] [Thread-1 (]: On snapshot.dbtairbnb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "snapshot.dbtairbnb.scd_raw_listings"} */
create or replace transient table AIRBNB.DEV.scd_raw_listings
         as
        (

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        
    
    select *
    from AIRBNB.raw.raw_listings
    ) sbq



        );
[0m14:18:12.849488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:14.417579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:18:14.439102 [debug] [Thread-1 (]: Timing info for snapshot.dbtairbnb.scd_raw_listings (execute): 14:18:12.785698 => 14:18:14.438833
[0m14:18:14.439651 [debug] [Thread-1 (]: On snapshot.dbtairbnb.scd_raw_listings: Close
[0m14:18:14.523727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4848fba-5b1a-41ad-b287-41f8b418c5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1b5c0130>]}
[0m14:18:14.527677 [info ] [Thread-1 (]: 1 of 1 OK snapshotted DEV.scd_raw_listings ..................................... [[32mSUCCESS 1[0m in 1.76s]
[0m14:18:14.531096 [debug] [Thread-1 (]: Finished running node snapshot.dbtairbnb.scd_raw_listings
[0m14:18:14.537971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:14.540210 [debug] [MainThread]: Connection 'snapshot.dbtairbnb.scd_raw_listings' was properly closed.
[0m14:18:14.542484 [info ] [MainThread]: 
[0m14:18:14.544927 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.41 seconds (4.41s).
[0m14:18:14.548669 [debug] [MainThread]: Command end result
[0m14:18:14.577297 [info ] [MainThread]: 
[0m14:18:14.578494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:14.579544 [info ] [MainThread]: 
[0m14:18:14.580606 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:18:14.582879 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.41904, "process_user_time": 3.625035, "process_kernel_time": 0.828919, "process_mem_max_rss": "199064", "process_out_blocks": "2696", "process_in_blocks": "0"}
[0m14:18:14.585021 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:18:14.584421 after 5.42 seconds
[0m14:18:14.586799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb494a69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb205bb250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2027fa00>]}
[0m14:18:14.588323 [debug] [MainThread]: Flushing usage events
[0m14:19:35.482419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7765531b29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7765514c6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7765514c63b0>]}


============================== 14:19:35.484733 | 6356e596-672f-46d0-9708-749cae86fe9c ==============================
[0m14:19:35.484733 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:19:35.485432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/lkeiti/.dbt', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:19:36.120939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6356e596-672f-46d0-9708-749cae86fe9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7765514c6500>]}
[0m14:19:36.179621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6356e596-672f-46d0-9708-749cae86fe9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7765263cb430>]}
[0m14:19:36.180409 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:19:36.187034 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:19:36.218549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:19:36.219214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:19:36.224624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6356e596-672f-46d0-9708-749cae86fe9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7765260700d0>]}
[0m14:19:36.233695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6356e596-672f-46d0-9708-749cae86fe9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776526030d60>]}
[0m14:19:36.234336 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:19:36.234879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6356e596-672f-46d0-9708-749cae86fe9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776526191960>]}
[0m14:19:36.236475 [info ] [MainThread]: 
[0m14:19:36.237307 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:19:36.238913 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m14:19:36.303725 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m14:19:36.304287 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m14:19:36.304762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:37.309640 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:19:37.316814 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:19:37.472685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m14:19:37.485578 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:19:37.486392 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:19:37.487000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:38.333198 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:19:38.340260 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:19:38.475503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m14:19:38.495306 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:19:38.497643 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:19:38.499824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:39.332929 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:19:39.334758 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:19:39.494544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6356e596-672f-46d0-9708-749cae86fe9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776526057d90>]}
[0m14:19:39.495977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:39.496799 [info ] [MainThread]: 
[0m14:19:39.499751 [debug] [Thread-1 (]: Began running node snapshot.dbtairbnb.scd_raw_listings
[0m14:19:39.500693 [info ] [Thread-1 (]: 1 of 1 START snapshot DEV.scd_raw_listings ..................................... [RUN]
[0m14:19:39.501892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now snapshot.dbtairbnb.scd_raw_listings)
[0m14:19:39.502782 [debug] [Thread-1 (]: Began compiling node snapshot.dbtairbnb.scd_raw_listings
[0m14:19:39.517272 [debug] [Thread-1 (]: Timing info for snapshot.dbtairbnb.scd_raw_listings (compile): 14:19:39.503386 => 14:19:39.516561
[0m14:19:39.518602 [debug] [Thread-1 (]: Began executing node snapshot.dbtairbnb.scd_raw_listings
[0m14:19:39.602184 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtairbnb.scd_raw_listings"
[0m14:19:39.603112 [debug] [Thread-1 (]: On snapshot.dbtairbnb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "snapshot.dbtairbnb.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m14:19:39.603732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:40.339913 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 1.0 seconds
[0m14:19:40.377754 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtairbnb.scd_raw_listings"
[0m14:19:40.378488 [debug] [Thread-1 (]: On snapshot.dbtairbnb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "snapshot.dbtairbnb.scd_raw_listings"} */
create or replace temporary table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
         as
        (with snapshot_query as (

        
    
    select *
    from AIRBNB.raw.raw_listings

    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m14:19:41.801245 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:19:41.810629 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtairbnb.scd_raw_listings"
[0m14:19:41.812552 [debug] [Thread-1 (]: On snapshot.dbtairbnb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "snapshot.dbtairbnb.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m14:19:41.919509 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.0 seconds
[0m14:19:41.923715 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtairbnb.scd_raw_listings"
[0m14:19:41.924273 [debug] [Thread-1 (]: On snapshot.dbtairbnb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "snapshot.dbtairbnb.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m14:19:42.008708 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m14:19:42.026197 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtairbnb.scd_raw_listings"
[0m14:19:42.028201 [debug] [Thread-1 (]: On snapshot.dbtairbnb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "snapshot.dbtairbnb.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m14:19:42.140156 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.0 seconds
[0m14:19:42.146275 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtairbnb.scd_raw_listings"
[0m14:19:42.147385 [debug] [Thread-1 (]: On snapshot.dbtairbnb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "snapshot.dbtairbnb.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m14:19:42.240479 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m14:19:42.250866 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtairbnb.scd_raw_listings"
[0m14:19:42.251732 [debug] [Thread-1 (]: On snapshot.dbtairbnb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "snapshot.dbtairbnb.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m14:19:42.331371 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.0 seconds
[0m14:19:42.344130 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtairbnb.scd_raw_listings"
[0m14:19:42.345742 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtairbnb.scd_raw_listings"
[0m14:19:42.346541 [debug] [Thread-1 (]: On snapshot.dbtairbnb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "snapshot.dbtairbnb.scd_raw_listings"} */
BEGIN
[0m14:19:42.484492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:19:42.485454 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtairbnb.scd_raw_listings"
[0m14:19:42.486388 [debug] [Thread-1 (]: On snapshot.dbtairbnb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "snapshot.dbtairbnb.scd_raw_listings"} */
merge into "AIRBNB"."DEV"."SCD_RAW_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m14:19:43.336566 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 1.0 seconds
[0m14:19:43.337676 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtairbnb.scd_raw_listings"
[0m14:19:43.338587 [debug] [Thread-1 (]: On snapshot.dbtairbnb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "snapshot.dbtairbnb.scd_raw_listings"} */
COMMIT
[0m14:19:43.953758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:19:44.007564 [debug] [Thread-1 (]: Timing info for snapshot.dbtairbnb.scd_raw_listings (execute): 14:19:39.519372 => 14:19:44.007218
[0m14:19:44.008317 [debug] [Thread-1 (]: On snapshot.dbtairbnb.scd_raw_listings: Close
[0m14:19:44.133763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6356e596-672f-46d0-9708-749cae86fe9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7765254879d0>]}
[0m14:19:44.137703 [info ] [Thread-1 (]: 1 of 1 OK snapshotted DEV.scd_raw_listings ..................................... [[32mSUCCESS 2[0m in 4.63s]
[0m14:19:44.141208 [debug] [Thread-1 (]: Finished running node snapshot.dbtairbnb.scd_raw_listings
[0m14:19:44.147837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:44.150098 [debug] [MainThread]: Connection 'snapshot.dbtairbnb.scd_raw_listings' was properly closed.
[0m14:19:44.152360 [info ] [MainThread]: 
[0m14:19:44.154798 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.91 seconds (7.91s).
[0m14:19:44.158681 [debug] [MainThread]: Command end result
[0m14:19:44.187398 [info ] [MainThread]: 
[0m14:19:44.188739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:19:44.189953 [info ] [MainThread]: 
[0m14:19:44.191634 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:19:44.193983 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.751591, "process_user_time": 3.669603, "process_kernel_time": 0.749061, "process_mem_max_rss": "196832", "process_out_blocks": "1840", "process_in_blocks": "0"}
[0m14:19:44.195287 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:19:44.194965 after 8.75 seconds
[0m14:19:44.196182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7765531b29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776526190b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7765260312d0>]}
[0m14:19:44.197021 [debug] [MainThread]: Flushing usage events
[0m14:25:58.821217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6d6fb29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6d52c6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6d52c63b0>]}


============================== 14:25:58.823620 | d4c93740-b888-4275-a26f-6f3751d48f86 ==============================
[0m14:25:58.823620 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:25:58.824224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:25:59.428414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4c93740-b888-4275-a26f-6f3751d48f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6d52c6500>]}
[0m14:25:59.487057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4c93740-b888-4275-a26f-6f3751d48f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6aa1cf430>]}
[0m14:25:59.487860 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:25:59.495257 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:25:59.525552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:59.526130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:59.531695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4c93740-b888-4275-a26f-6f3751d48f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6a9c880d0>]}
[0m14:25:59.540665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4c93740-b888-4275-a26f-6f3751d48f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6a9e38af0>]}
[0m14:25:59.541291 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 2 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:25:59.541868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4c93740-b888-4275-a26f-6f3751d48f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6a9e397e0>]}
[0m14:25:59.543519 [info ] [MainThread]: 
[0m14:25:59.544334 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:25:59.546063 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m14:25:59.607718 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:25:59.608299 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:25:59.608799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:00.896913 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:26:00.904589 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:26:01.032218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m14:26:01.037074 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:26:01.037679 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:26:01.038155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:01.817295 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:26:01.824725 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:26:01.920556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4c93740-b888-4275-a26f-6f3751d48f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6a9e38a30>]}
[0m14:26:01.924550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:26:01.926935 [info ] [MainThread]: 
[0m14:26:01.935315 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:26:01.938218 [info ] [Thread-1 (]: 1 of 2 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m14:26:01.941844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m14:26:01.944390 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:26:01.987848 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:26:01.988932 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 14:26:01.946018 => 14:26:01.988569
[0m14:26:01.989648 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:26:02.012107 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:26:02.013239 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:26:02.013862 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m14:26:02.014412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:02.691853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:26:02.717947 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 14:26:01.990084 => 14:26:02.716930
[0m14:26:02.719812 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m14:26:02.815943 [info ] [Thread-1 (]: 1 of 2 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.87s]
[0m14:26:02.819557 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:26:02.822358 [debug] [Thread-1 (]: Began running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:26:02.825582 [info ] [Thread-1 (]: 2 of 2 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m14:26:02.829227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m14:26:02.831981 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:26:02.854331 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:26:02.855944 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 14:26:02.833937 => 14:26:02.855357
[0m14:26:02.857108 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:26:02.862427 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:26:02.863948 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:26:02.864743 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:26:02.865585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:03.713926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:26:03.721169 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 14:26:02.857718 => 14:26:03.720203
[0m14:26:03.723021 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m14:26:03.805030 [info ] [Thread-1 (]: 2 of 2 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.98s]
[0m14:26:03.808628 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:26:03.815386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:03.817788 [debug] [MainThread]: Connection 'test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m14:26:03.820391 [info ] [MainThread]: 
[0m14:26:03.822910 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m14:26:03.827678 [debug] [MainThread]: Command end result
[0m14:26:03.853778 [info ] [MainThread]: 
[0m14:26:03.854928 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:03.856053 [info ] [MainThread]: 
[0m14:26:03.857596 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:26:03.859074 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.0786724, "process_user_time": 3.500208, "process_kernel_time": 0.850748, "process_mem_max_rss": "195652", "process_out_blocks": "1880", "process_in_blocks": "0"}
[0m14:26:03.860285 [debug] [MainThread]: Command `dbt test` succeeded at 14:26:03.860013 after 5.08 seconds
[0m14:26:03.861035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6d6fb29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6aa6cf880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b6aa1578b0>]}
[0m14:26:03.861812 [debug] [MainThread]: Flushing usage events
[0m14:27:18.171742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714a291ba9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714a274ce3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714a274ce350>]}


============================== 14:27:18.175586 | aabcb0e3-383d-4fcd-980f-c4cdf693f544 ==============================
[0m14:27:18.175586 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:27:18.176592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:27:18.840241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aabcb0e3-383d-4fcd-980f-c4cdf693f544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714a274ce4a0>]}
[0m14:27:18.900450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aabcb0e3-383d-4fcd-980f-c4cdf693f544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714a002cf250>]}
[0m14:27:18.901723 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:27:18.911622 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:27:18.945820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:18.946439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:18.954771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aabcb0e3-383d-4fcd-980f-c4cdf693f544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7149fbd140d0>]}
[0m14:27:18.969831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aabcb0e3-383d-4fcd-980f-c4cdf693f544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7149fbec50c0>]}
[0m14:27:18.970981 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 4 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:27:18.971955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aabcb0e3-383d-4fcd-980f-c4cdf693f544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7149fbec5db0>]}
[0m14:27:18.974532 [info ] [MainThread]: 
[0m14:27:18.975453 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:27:18.977298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m14:27:19.044396 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:27:19.044981 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:27:19.045464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:20.010227 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:27:20.013186 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:27:20.109237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m14:27:20.129621 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:27:20.131950 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:27:20.134157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:20.576163 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:27:20.583057 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:27:20.687664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aabcb0e3-383d-4fcd-980f-c4cdf693f544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7149fbec4f10>]}
[0m14:27:20.691883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:20.694641 [info ] [MainThread]: 
[0m14:27:20.703461 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:27:20.706138 [info ] [Thread-1 (]: 1 of 4 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m14:27:20.709772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m14:27:20.712322 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:27:20.755102 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:27:20.756432 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 14:27:20.713973 => 14:27:20.755852
[0m14:27:20.757582 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:27:20.779412 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:27:20.780472 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:27:20.781060 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m14:27:20.781666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:21.862689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:27:21.889696 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 14:27:20.758066 => 14:27:21.888240
[0m14:27:21.891805 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m14:27:22.018789 [info ] [Thread-1 (]: 1 of 4 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.31s]
[0m14:27:22.022793 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:27:22.026318 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:27:22.031125 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m14:27:22.036382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m14:27:22.039725 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:27:22.053097 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:27:22.054762 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 14:27:22.041818 => 14:27:22.054182
[0m14:27:22.055963 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:27:22.062071 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:27:22.063665 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:27:22.064877 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m14:27:22.065898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:22.755667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:27:22.767248 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 14:27:22.056759 => 14:27:22.765897
[0m14:27:22.769810 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m14:27:22.921775 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.89s]
[0m14:27:22.925584 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:27:22.929332 [debug] [Thread-1 (]: Began running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:27:22.934202 [info ] [Thread-1 (]: 3 of 4 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m14:27:22.938004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m14:27:22.940551 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:27:22.965256 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:27:22.966840 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 14:27:22.942188 => 14:27:22.966276
[0m14:27:22.968048 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:27:22.976106 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:27:22.978177 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:27:22.978982 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:27:22.980270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:24.098717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:27:24.107698 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 14:27:22.969037 => 14:27:24.106385
[0m14:27:24.110408 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m14:27:24.201008 [info ] [Thread-1 (]: 3 of 4 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.26s]
[0m14:27:24.204601 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:27:24.207771 [debug] [Thread-1 (]: Began running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:27:24.211921 [info ] [Thread-1 (]: 4 of 4 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m14:27:24.217774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m14:27:24.221856 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:27:24.239227 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:27:24.240698 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 14:27:24.223039 => 14:27:24.240138
[0m14:27:24.241671 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:27:24.247469 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:27:24.248966 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:27:24.249710 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:27:24.250642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:24.912671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:27:24.921789 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 14:27:24.242215 => 14:27:24.920430
[0m14:27:24.924586 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m14:27:25.053812 [info ] [Thread-1 (]: 4 of 4 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.84s]
[0m14:27:25.054709 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:27:25.056571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:25.057451 [debug] [MainThread]: Connection 'test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m14:27:25.057986 [info ] [MainThread]: 
[0m14:27:25.058517 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 6.08 seconds (6.08s).
[0m14:27:25.059805 [debug] [MainThread]: Command end result
[0m14:27:25.069801 [info ] [MainThread]: 
[0m14:27:25.070468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:25.071033 [info ] [MainThread]: 
[0m14:27:25.071738 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:27:25.072753 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.955585, "process_user_time": 3.984488, "process_kernel_time": 0.836102, "process_mem_max_rss": "195792", "process_out_blocks": "1944", "process_in_blocks": "0"}
[0m14:27:25.073557 [debug] [MainThread]: Command `dbt test` succeeded at 14:27:25.073303 after 6.96 seconds
[0m14:27:25.074114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714a291ba9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7149fb41c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714a0010a9e0>]}
[0m14:27:25.074937 [debug] [MainThread]: Flushing usage events
[0m14:28:07.609353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c905ae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c8e8c23b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c8e8c2350>]}


============================== 14:28:07.611697 | 7888d7a4-42d4-4de7-9615-b6a0deaf2f68 ==============================
[0m14:28:07.611697 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:28:07.612323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:28:08.232989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7888d7a4-42d4-4de7-9615-b6a0deaf2f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c8e8c24a0>]}
[0m14:28:08.292314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7888d7a4-42d4-4de7-9615-b6a0deaf2f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c63657250>]}
[0m14:28:08.293165 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:28:08.300377 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:28:08.329905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:08.330477 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:08.336257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7888d7a4-42d4-4de7-9615-b6a0deaf2f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c631941f0>]}
[0m14:28:08.345807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7888d7a4-42d4-4de7-9615-b6a0deaf2f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c633413c0>]}
[0m14:28:08.346466 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 5 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:28:08.347004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7888d7a4-42d4-4de7-9615-b6a0deaf2f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c633420b0>]}
[0m14:28:08.349462 [info ] [MainThread]: 
[0m14:28:08.350426 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:28:08.351796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m14:28:08.414072 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:28:08.414650 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:28:08.415202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:09.618194 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:28:09.628075 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:28:09.760999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m14:28:09.768562 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:28:09.769777 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:28:09.770864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:10.320401 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:28:10.327765 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:28:10.433796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7888d7a4-42d4-4de7-9615-b6a0deaf2f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c63635ab0>]}
[0m14:28:10.438673 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:10.441275 [info ] [MainThread]: 
[0m14:28:10.450182 [debug] [Thread-1 (]: Began running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:28:10.453078 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m14:28:10.457674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m14:28:10.459547 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:28:10.494509 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:28:10.495541 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 14:28:10.460674 => 14:28:10.495177
[0m14:28:10.496204 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:28:10.517461 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:28:10.518666 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:28:10.519253 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m14:28:10.519808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:11.150507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:28:11.182357 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 14:28:10.496593 => 14:28:11.181092
[0m14:28:11.184296 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m14:28:11.317526 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.86s]
[0m14:28:11.319107 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:28:11.320291 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:28:11.321626 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m14:28:11.323364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m14:28:11.324641 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:28:11.339456 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:28:11.341678 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 14:28:11.325432 => 14:28:11.340827
[0m14:28:11.342918 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:28:11.349345 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:28:11.351145 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:28:11.351970 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m14:28:11.352757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:11.869761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:28:11.878757 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 14:28:11.343759 => 14:28:11.877439
[0m14:28:11.881323 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m14:28:12.014609 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.69s]
[0m14:28:12.017473 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:28:12.019424 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:28:12.021663 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m14:28:12.023832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m14:28:12.025238 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:28:12.034536 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:28:12.036105 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 14:28:12.026087 => 14:28:12.035556
[0m14:28:12.037158 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:28:12.043210 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:28:12.044847 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:28:12.045779 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m14:28:12.046555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:12.528123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:28:12.537282 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 14:28:12.037899 => 14:28:12.535922
[0m14:28:12.539875 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m14:28:12.632645 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.61s]
[0m14:28:12.636427 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:28:12.639176 [debug] [Thread-1 (]: Began running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:28:12.642351 [info ] [Thread-1 (]: 4 of 5 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m14:28:12.646074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m14:28:12.648810 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:28:12.673722 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:28:12.675111 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 14:28:12.650721 => 14:28:12.674627
[0m14:28:12.676036 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:28:12.681101 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:28:12.682812 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:28:12.683584 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:28:12.684294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:13.544081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:28:13.550347 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 14:28:12.676540 => 14:28:13.549438
[0m14:28:13.551902 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m14:28:13.688177 [info ] [Thread-1 (]: 4 of 5 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.04s]
[0m14:28:13.692390 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:28:13.695198 [debug] [Thread-1 (]: Began running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:28:13.698203 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m14:28:13.702306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m14:28:13.705119 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:28:13.723561 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:28:13.724942 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 14:28:13.706939 => 14:28:13.724467
[0m14:28:13.725886 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:28:13.730794 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:28:13.732518 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:28:13.733278 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:28:13.733984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:14.286396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:28:14.295817 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 14:28:13.726513 => 14:28:14.294416
[0m14:28:14.298697 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m14:28:14.431859 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.73s]
[0m14:28:14.435884 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:28:14.443003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:14.445282 [debug] [MainThread]: Connection 'test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m14:28:14.448123 [info ] [MainThread]: 
[0m14:28:14.450853 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 6.10 seconds (6.10s).
[0m14:28:14.457379 [debug] [MainThread]: Command end result
[0m14:28:14.477672 [info ] [MainThread]: 
[0m14:28:14.478578 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:14.479319 [info ] [MainThread]: 
[0m14:28:14.480045 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:28:14.481315 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.9132895, "process_user_time": 3.96135, "process_kernel_time": 0.840286, "process_mem_max_rss": "196144", "process_out_blocks": "1984", "process_in_blocks": "0"}
[0m14:28:14.482314 [debug] [MainThread]: Command `dbt test` succeeded at 14:28:14.482047 after 6.91 seconds
[0m14:28:14.483059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c905ae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c63657250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c6290a200>]}
[0m14:28:14.483819 [debug] [MainThread]: Flushing usage events
[0m14:28:32.360427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e48c50a69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e48c33ba3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e48c33ba380>]}


============================== 14:28:32.362858 | 5fd3defe-487b-4d52-a536-de99bfe3ab5c ==============================
[0m14:28:32.362858 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:28:32.363572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'version_check': 'True', 'profiles_dir': '/home/lkeiti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:28:32.984183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fd3defe-487b-4d52-a536-de99bfe3ab5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e48c33ba4d0>]}
[0m14:28:33.044427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fd3defe-487b-4d52-a536-de99bfe3ab5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e489c080e20>]}
[0m14:28:33.045384 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:28:33.052232 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:28:33.083476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:33.084034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:33.089717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fd3defe-487b-4d52-a536-de99bfe3ab5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4897d00220>]}
[0m14:28:33.099287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fd3defe-487b-4d52-a536-de99bfe3ab5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4897eb14b0>]}
[0m14:28:33.099921 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 5 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:28:33.100445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd3defe-487b-4d52-a536-de99bfe3ab5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4897eb21a0>]}
[0m14:28:33.102666 [info ] [MainThread]: 
[0m14:28:33.103494 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:28:33.104885 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m14:28:33.167198 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:28:33.167770 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:28:33.168251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:34.192663 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:28:34.200377 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:28:34.323534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m14:28:34.329763 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:28:34.332688 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:28:34.333345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:34.933136 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:28:34.940846 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:28:35.090917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd3defe-487b-4d52-a536-de99bfe3ab5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4897eb15a0>]}
[0m14:28:35.095006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:35.097476 [info ] [MainThread]: 
[0m14:28:35.105806 [debug] [Thread-1 (]: Began running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717
[0m14:28:35.108634 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room  [RUN]
[0m14:28:35.112431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717)
[0m14:28:35.115094 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717
[0m14:28:35.146899 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717"
[0m14:28:35.148266 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717 (compile): 14:28:35.116369 => 14:28:35.147867
[0m14:28:35.148916 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717
[0m14:28:35.170357 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717"
[0m14:28:35.171514 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717"
[0m14:28:35.172087 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Fake Data','Hotel room'
)



      
    ) dbt_internal_test
[0m14:28:35.172643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:35.655837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:28:35.682432 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717 (execute): 14:28:35.149305 => 14:28:35.680992
[0m14:28:35.685107 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717: Close
[0m14:28:35.773128 [error] [Thread-1 (]: 1 of 5 FAIL 1 accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room  [[31mFAIL 1[0m in 0.66s]
[0m14:28:35.774687 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717
[0m14:28:35.775822 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:28:35.777005 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m14:28:35.778499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room.2d62d19717, now test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m14:28:35.779547 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:28:35.792805 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:28:35.794307 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 14:28:35.780177 => 14:28:35.793788
[0m14:28:35.795296 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:28:35.801084 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:28:35.802690 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:28:35.803587 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m14:28:35.804375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:36.427526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:28:36.431110 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 14:28:35.795944 => 14:28:36.430602
[0m14:28:36.432061 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m14:28:36.514756 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.74s]
[0m14:28:36.515710 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:28:36.516374 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:28:36.517095 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m14:28:36.518070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m14:28:36.518672 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:28:36.524230 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:28:36.525167 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 14:28:36.519060 => 14:28:36.524846
[0m14:28:36.525784 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:28:36.529383 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:28:36.530527 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:28:36.531491 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m14:28:36.532256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:37.007458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:28:37.012280 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 14:28:36.526165 => 14:28:37.011852
[0m14:28:37.013090 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m14:28:37.134287 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.62s]
[0m14:28:37.137825 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:28:37.140511 [debug] [Thread-1 (]: Began running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:28:37.143919 [info ] [Thread-1 (]: 4 of 5 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m14:28:37.148258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m14:28:37.151322 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:28:37.171678 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:28:37.172874 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 14:28:37.152652 => 14:28:37.172457
[0m14:28:37.173676 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:28:37.178366 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:28:37.180234 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:28:37.181008 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:28:37.181762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:37.877377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:28:37.887737 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 14:28:37.174182 => 14:28:37.886326
[0m14:28:37.890619 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m14:28:38.044605 [info ] [Thread-1 (]: 4 of 5 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.90s]
[0m14:28:38.049981 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:28:38.053192 [debug] [Thread-1 (]: Began running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:28:38.055995 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m14:28:38.058447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m14:28:38.060182 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:28:38.074885 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:28:38.076385 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 14:28:38.061106 => 14:28:38.075801
[0m14:28:38.077472 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:28:38.082061 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:28:38.083495 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:28:38.084195 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:28:38.085435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:38.931169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:28:38.940260 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 14:28:38.078010 => 14:28:38.938938
[0m14:28:38.942853 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m14:28:39.084439 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.03s]
[0m14:28:39.088064 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:28:39.094639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:39.096888 [debug] [MainThread]: Connection 'test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m14:28:39.099222 [info ] [MainThread]: 
[0m14:28:39.101730 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 6.00 seconds (6.00s).
[0m14:28:39.108435 [debug] [MainThread]: Command end result
[0m14:28:39.132028 [info ] [MainThread]: 
[0m14:28:39.132975 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:28:39.133888 [info ] [MainThread]: 
[0m14:28:39.134774 [error] [MainThread]: [31mFailure in test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Fake_Data__Hotel_room (models/schema.yml)[0m
[0m14:28:39.135538 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:28:39.136286 [info ] [MainThread]: 
[0m14:28:39.137035 [info ] [MainThread]:   compiled Code at target/compiled/dbtairbnb/models/schema.yml/accepted_values_dim_listings_c_dae095ba0d9eafcf26faa6c617976295.sql
[0m14:28:39.137813 [info ] [MainThread]: 
[0m14:28:39.138556 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:28:39.139718 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 6.821666, "process_user_time": 3.917966, "process_kernel_time": 0.852427, "process_mem_max_rss": "196392", "process_out_blocks": "1992", "command_success": false, "process_in_blocks": "0"}
[0m14:28:39.140591 [debug] [MainThread]: Command `dbt test` failed at 14:28:39.140362 after 6.82 seconds
[0m14:28:39.141278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e48c50a69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e489c246e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4897327be0>]}
[0m14:28:39.141999 [debug] [MainThread]: Flushing usage events
[0m14:30:12.756582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726db6ca69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726db4fba3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726db4fba350>]}


============================== 14:30:12.758988 | f0b624b0-ffda-47b1-83bb-918010b7c83c ==============================
[0m14:30:12.758988 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:30:12.759604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:30:13.389773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0b624b0-ffda-47b1-83bb-918010b7c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726db4fba4a0>]}
[0m14:30:13.449652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0b624b0-ffda-47b1-83bb-918010b7c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d89e43250>]}
[0m14:30:13.450484 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:30:13.457055 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:30:13.489385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:13.490080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:13.496095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0b624b0-ffda-47b1-83bb-918010b7c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d899841f0>]}
[0m14:30:13.505904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0b624b0-ffda-47b1-83bb-918010b7c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d89b313c0>]}
[0m14:30:13.506624 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 5 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:30:13.507167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0b624b0-ffda-47b1-83bb-918010b7c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d89b320b0>]}
[0m14:30:13.509441 [info ] [MainThread]: 
[0m14:30:13.510349 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:30:13.511776 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m14:30:13.573174 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:30:13.573792 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:30:13.574281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:14.649286 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:30:14.656507 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:30:14.773260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m14:30:14.793087 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:30:14.795672 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:30:14.797247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:15.568586 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:30:15.575674 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:30:15.670384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0b624b0-ffda-47b1-83bb-918010b7c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d89b31210>]}
[0m14:30:15.674258 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:30:15.676616 [info ] [MainThread]: 
[0m14:30:15.683524 [debug] [Thread-1 (]: Began running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:30:15.685392 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m14:30:15.687974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m14:30:15.689733 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:30:15.730467 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:30:15.731661 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 14:30:15.690888 => 14:30:15.731243
[0m14:30:15.732661 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:30:15.755259 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:30:15.756449 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:30:15.757027 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m14:30:15.757628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:16.455275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:30:16.479352 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 14:30:15.733365 => 14:30:16.478571
[0m14:30:16.480826 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m14:30:16.591687 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.90s]
[0m14:30:16.595401 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:30:16.598110 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:30:16.600948 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m14:30:16.604554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m14:30:16.607084 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:30:16.626953 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:30:16.628340 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 14:30:16.608684 => 14:30:16.627857
[0m14:30:16.629294 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:30:16.634589 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:30:16.635942 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:30:16.636653 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m14:30:16.637464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:17.149931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:30:17.159121 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 14:30:16.629911 => 14:30:17.157771
[0m14:30:17.161703 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m14:30:17.293366 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.69s]
[0m14:30:17.297053 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:30:17.300074 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:30:17.304000 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m14:30:17.308085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m14:30:17.310673 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:30:17.326555 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:30:17.328661 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 14:30:17.312305 => 14:30:17.327773
[0m14:30:17.329842 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:30:17.335981 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:30:17.337531 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:30:17.338333 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m14:30:17.339097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:17.820331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:30:17.829956 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 14:30:17.330615 => 14:30:17.828350
[0m14:30:17.832732 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m14:30:17.974261 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.67s]
[0m14:30:17.977762 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:30:17.980431 [debug] [Thread-1 (]: Began running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:30:17.983398 [info ] [Thread-1 (]: 4 of 5 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m14:30:17.987420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m14:30:17.990479 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:30:18.015908 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:30:18.017730 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 14:30:17.992186 => 14:30:18.016989
[0m14:30:18.018709 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:30:18.023242 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:30:18.024948 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:30:18.025965 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:30:18.027251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:18.640896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:30:18.653167 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 14:30:18.019297 => 14:30:18.651240
[0m14:30:18.655845 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m14:30:18.785287 [info ] [Thread-1 (]: 4 of 5 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.80s]
[0m14:30:18.789149 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:30:18.791897 [debug] [Thread-1 (]: Began running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:30:18.795529 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m14:30:18.799457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m14:30:18.802016 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:30:18.823031 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:30:18.824939 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 14:30:18.804231 => 14:30:18.824035
[0m14:30:18.826100 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:30:18.831072 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:30:18.833134 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:30:18.834071 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:30:18.834765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:19.383201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:30:19.392242 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 14:30:18.826688 => 14:30:19.390916
[0m14:30:19.394830 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m14:30:19.491352 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.69s]
[0m14:30:19.495484 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:30:19.502336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:19.504766 [debug] [MainThread]: Connection 'test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m14:30:19.507245 [info ] [MainThread]: 
[0m14:30:19.509808 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 6.00 seconds (6.00s).
[0m14:30:19.516377 [debug] [MainThread]: Command end result
[0m14:30:19.541654 [info ] [MainThread]: 
[0m14:30:19.543206 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:19.544645 [info ] [MainThread]: 
[0m14:30:19.546103 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:30:19.548092 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.8325787, "process_user_time": 4.075116, "process_kernel_time": 0.804563, "process_mem_max_rss": "196540", "process_out_blocks": "1984", "process_in_blocks": "0"}
[0m14:30:19.549887 [debug] [MainThread]: Command `dbt test` succeeded at 14:30:19.549365 after 6.83 seconds
[0m14:30:19.550693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726db6ca69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d89e43250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d898fab90>]}
[0m14:30:19.551413 [debug] [MainThread]: Flushing usage events
[0m14:33:16.795970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b391b7e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b39008e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b39008e3b0>]}


============================== 14:33:16.798577 | 0d90db02-af31-4f6d-bd60-81fdc4e7a4e4 ==============================
[0m14:33:16.798577 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:33:16.799417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'version_check': 'True', 'profiles_dir': '/home/lkeiti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:33:17.454458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d90db02-af31-4f6d-bd60-81fdc4e7a4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b39008e500>]}
[0m14:33:17.512537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d90db02-af31-4f6d-bd60-81fdc4e7a4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b368cfb430>]}
[0m14:33:17.513354 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:33:17.520531 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:33:17.556904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:33:17.557663 [debug] [MainThread]: Partial parsing: added file: dbtairbnb://tests/dim_listings_minimum_nights.sql
[0m14:33:17.711403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d90db02-af31-4f6d-bd60-81fdc4e7a4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b3688bdf30>]}
[0m14:33:17.720992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d90db02-af31-4f6d-bd60-81fdc4e7a4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b36896ad40>]}
[0m14:33:17.721669 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 6 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:33:17.722189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d90db02-af31-4f6d-bd60-81fdc4e7a4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b36896b460>]}
[0m14:33:17.724090 [info ] [MainThread]: 
[0m14:33:17.724928 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:33:17.726412 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m14:33:17.742966 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:33:17.743552 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:33:17.744036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:18.515635 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:33:18.519753 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:33:18.602257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m14:33:18.614307 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:33:18.615320 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:33:18.616233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:19.456304 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:33:19.459662 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:33:19.587349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d90db02-af31-4f6d-bd60-81fdc4e7a4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b3689763e0>]}
[0m14:33:19.590112 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:19.592048 [info ] [MainThread]: 
[0m14:33:19.597575 [debug] [Thread-1 (]: Began running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:33:19.599147 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m14:33:19.601525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m14:33:19.602808 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:33:19.634841 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:33:19.635841 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 14:33:19.603582 => 14:33:19.635501
[0m14:33:19.636485 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:33:19.665175 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:33:19.666576 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:33:19.667218 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m14:33:19.668086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:20.269443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:20.296488 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 14:33:19.636891 => 14:33:20.295453
[0m14:33:20.298635 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m14:33:20.429218 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.83s]
[0m14:33:20.434017 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:33:20.436808 [debug] [Thread-1 (]: Began running node test.dbtairbnb.dim_listings_minimum_nights
[0m14:33:20.439887 [info ] [Thread-1 (]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m14:33:20.443563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtairbnb.dim_listings_minimum_nights)
[0m14:33:20.445445 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.dim_listings_minimum_nights
[0m14:33:20.453590 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.dim_listings_minimum_nights"
[0m14:33:20.455169 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.dim_listings_minimum_nights (compile): 14:33:20.446827 => 14:33:20.454626
[0m14:33:20.456305 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.dim_listings_minimum_nights
[0m14:33:20.462526 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.dim_listings_minimum_nights"
[0m14:33:20.464233 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.dim_listings_minimum_nights"
[0m14:33:20.465089 [debug] [Thread-1 (]: On test.dbtairbnb.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from AIRBNB.dev.dim_listings_cleansed where minimium_nights < 1 limit 10
      
    ) dbt_internal_test
[0m14:33:20.465870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:21.465292 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b46a3d-0000-437b-0000-000052fd5f35
[0m14:33:21.468197 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 59
invalid identifier 'MINIMIUM_NIGHTS'
[0m14:33:21.471986 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.dim_listings_minimum_nights (execute): 14:33:20.457618 => 14:33:21.470579
[0m14:33:21.474700 [debug] [Thread-1 (]: On test.dbtairbnb.dim_listings_minimum_nights: Close
[0m14:33:21.634087 [debug] [Thread-1 (]: Database Error in test dim_listings_minimum_nights (tests/dim_listings_minimum_nights.sql)
  000904 (42000): SQL compilation error: error line 6 at position 59
  invalid identifier 'MINIMIUM_NIGHTS'
  compiled Code at target/run/dbtairbnb/tests/dim_listings_minimum_nights.sql
[0m14:33:21.637431 [error] [Thread-1 (]: 2 of 6 ERROR dim_listings_minimum_nights ....................................... [[31mERROR[0m in 1.19s]
[0m14:33:21.640963 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.dim_listings_minimum_nights
[0m14:33:21.643661 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:33:21.648676 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m14:33:21.652400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.dim_listings_minimum_nights, now test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m14:33:21.654647 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:33:21.674963 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:33:21.676723 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 14:33:21.655762 => 14:33:21.676071
[0m14:33:21.677598 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:33:21.682310 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:33:21.684319 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:33:21.685358 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m14:33:21.686341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:22.204931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:22.217731 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 14:33:21.678120 => 14:33:22.215795
[0m14:33:22.220592 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m14:33:22.365882 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.71s]
[0m14:33:22.367586 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:33:22.368927 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:33:22.370440 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m14:33:22.372712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m14:33:22.374093 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:33:22.383397 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:33:22.385126 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 14:33:22.374803 => 14:33:22.384515
[0m14:33:22.386238 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:33:22.392290 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:33:22.393758 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:33:22.394557 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m14:33:22.395316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:23.116491 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:23.127282 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 14:33:22.386920 => 14:33:23.125274
[0m14:33:23.130865 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m14:33:23.276769 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.91s]
[0m14:33:23.278265 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:33:23.279546 [debug] [Thread-1 (]: Began running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:33:23.280914 [info ] [Thread-1 (]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m14:33:23.282746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m14:33:23.283868 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:33:23.305840 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:33:23.308072 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 14:33:23.284563 => 14:33:23.307288
[0m14:33:23.309431 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:33:23.315605 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:33:23.317376 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:33:23.318179 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:33:23.318834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:24.096572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:24.106136 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 14:33:23.310258 => 14:33:24.104692
[0m14:33:24.108924 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m14:33:24.235243 [info ] [Thread-1 (]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.95s]
[0m14:33:24.238428 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:33:24.240664 [debug] [Thread-1 (]: Began running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:33:24.243035 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m14:33:24.245807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m14:33:24.247899 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:33:24.265372 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:33:24.267064 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 14:33:24.249211 => 14:33:24.266479
[0m14:33:24.268210 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:33:24.273534 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:33:24.276213 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:33:24.277287 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:33:24.278051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:25.142291 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:25.151746 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 14:33:24.269167 => 14:33:25.150386
[0m14:33:25.154380 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m14:33:25.249180 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.00s]
[0m14:33:25.252977 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:33:25.259969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:25.262273 [debug] [MainThread]: Connection 'test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m14:33:25.264561 [info ] [MainThread]: 
[0m14:33:25.266974 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 7.54 seconds (7.54s).
[0m14:33:25.273939 [debug] [MainThread]: Command end result
[0m14:33:25.293576 [info ] [MainThread]: 
[0m14:33:25.294517 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:33:25.295538 [info ] [MainThread]: 
[0m14:33:25.296316 [error] [MainThread]:   Database Error in test dim_listings_minimum_nights (tests/dim_listings_minimum_nights.sql)
  000904 (42000): SQL compilation error: error line 6 at position 59
  invalid identifier 'MINIMIUM_NIGHTS'
  compiled Code at target/run/dbtairbnb/tests/dim_listings_minimum_nights.sql
[0m14:33:25.297079 [info ] [MainThread]: 
[0m14:33:25.297938 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m14:33:25.299325 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 8.548245, "process_user_time": 4.183892, "process_kernel_time": 0.660824, "process_mem_max_rss": "199412", "process_in_blocks": "16", "process_out_blocks": "2936", "command_success": false}
[0m14:33:25.300282 [debug] [MainThread]: Command `dbt test` failed at 14:33:25.300039 after 8.55 seconds
[0m14:33:25.300969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b391b7e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b3684f13f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b3684f0ac0>]}
[0m14:33:25.301677 [debug] [MainThread]: Flushing usage events
[0m14:33:44.048365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7451a7fa29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7451a62d23b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7451a62d2350>]}


============================== 14:33:44.050843 | c6805648-133e-4bb0-b2c2-b2ced91cfa8a ==============================
[0m14:33:44.050843 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:33:44.051498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'version_check': 'True', 'profiles_dir': '/home/lkeiti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:44.748599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6805648-133e-4bb0-b2c2-b2ced91cfa8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7451a62d24a0>]}
[0m14:33:44.810917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6805648-133e-4bb0-b2c2-b2ced91cfa8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74517b093250>]}
[0m14:33:44.812269 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:33:44.819842 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:33:44.850839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:44.851642 [debug] [MainThread]: Partial parsing: updated file: dbtairbnb://tests/dim_listings_minimum_nights.sql
[0m14:33:45.004459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6805648-133e-4bb0-b2c2-b2ced91cfa8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74517aade260>]}
[0m14:33:45.014895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6805648-133e-4bb0-b2c2-b2ced91cfa8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74517ac898a0>]}
[0m14:33:45.015555 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 6 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:33:45.016106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6805648-133e-4bb0-b2c2-b2ced91cfa8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74517ac8a590>]}
[0m14:33:45.018129 [info ] [MainThread]: 
[0m14:33:45.019002 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:33:45.020438 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m14:33:45.035192 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:33:45.035991 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:33:45.036800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:46.038878 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:33:46.040787 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:33:46.168745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m14:33:46.188521 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:33:46.190975 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:33:46.193776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:46.959053 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:33:46.967065 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:33:47.098511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6805648-133e-4bb0-b2c2-b2ced91cfa8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74517a9e9f90>]}
[0m14:33:47.102446 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:47.104810 [info ] [MainThread]: 
[0m14:33:47.113845 [debug] [Thread-1 (]: Began running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:33:47.116948 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m14:33:47.121128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m14:33:47.124397 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:33:47.160562 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:33:47.161978 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 14:33:47.126555 => 14:33:47.161466
[0m14:33:47.162990 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:33:47.184602 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:33:47.185891 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:33:47.186518 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m14:33:47.187092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:48.001507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:48.009622 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 14:33:47.163434 => 14:33:48.009196
[0m14:33:48.010441 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m14:33:48.093569 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.97s]
[0m14:33:48.097922 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:33:48.100703 [debug] [Thread-1 (]: Began running node test.dbtairbnb.dim_listings_minimum_nights
[0m14:33:48.104159 [info ] [Thread-1 (]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m14:33:48.108165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtairbnb.dim_listings_minimum_nights)
[0m14:33:48.109975 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.dim_listings_minimum_nights
[0m14:33:48.117567 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.dim_listings_minimum_nights"
[0m14:33:48.119123 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.dim_listings_minimum_nights (compile): 14:33:48.111176 => 14:33:48.118583
[0m14:33:48.120184 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.dim_listings_minimum_nights
[0m14:33:48.126273 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.dim_listings_minimum_nights"
[0m14:33:48.127774 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.dim_listings_minimum_nights"
[0m14:33:48.128593 [debug] [Thread-1 (]: On test.dbtairbnb.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from AIRBNB.dev.dim_listings_cleansed where minimum_nights < 1 limit 10
      
    ) dbt_internal_test
[0m14:33:48.129356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:48.807201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:48.817598 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.dim_listings_minimum_nights (execute): 14:33:48.121404 => 14:33:48.816192
[0m14:33:48.820257 [debug] [Thread-1 (]: On test.dbtairbnb.dim_listings_minimum_nights: Close
[0m14:33:48.960164 [info ] [Thread-1 (]: 2 of 6 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.85s]
[0m14:33:48.964855 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.dim_listings_minimum_nights
[0m14:33:48.968352 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:33:48.971325 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m14:33:48.975264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.dim_listings_minimum_nights, now test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m14:33:48.977780 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:33:48.996728 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:33:48.998286 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 14:33:48.979598 => 14:33:48.997795
[0m14:33:48.999218 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:33:49.005072 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:33:49.007218 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:33:49.008477 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m14:33:49.009696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:49.531396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:49.540489 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 14:33:48.999800 => 14:33:49.539148
[0m14:33:49.543102 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m14:33:49.636354 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.66s]
[0m14:33:49.637814 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:33:49.638987 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:33:49.640168 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m14:33:49.641563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m14:33:49.642190 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:33:49.647497 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:33:49.648373 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 14:33:49.642551 => 14:33:49.648085
[0m14:33:49.648927 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:33:49.653179 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:33:49.654299 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:33:49.654880 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m14:33:49.655441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:50.163617 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:50.173079 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 14:33:49.649272 => 14:33:50.171653
[0m14:33:50.175727 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m14:33:50.300539 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.66s]
[0m14:33:50.304091 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:33:50.306965 [debug] [Thread-1 (]: Began running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:33:50.310009 [info ] [Thread-1 (]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m14:33:50.313692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m14:33:50.316338 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:33:50.342548 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:33:50.343829 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 14:33:50.318032 => 14:33:50.343383
[0m14:33:50.344673 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:33:50.348815 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:33:50.350323 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:33:50.351030 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:33:50.351748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:50.957598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:50.966817 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 14:33:50.345119 => 14:33:50.965434
[0m14:33:50.969394 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m14:33:51.101896 [info ] [Thread-1 (]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.79s]
[0m14:33:51.105411 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:33:51.108090 [debug] [Thread-1 (]: Began running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:33:51.111245 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m14:33:51.114877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m14:33:51.117377 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:33:51.137171 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:33:51.138812 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 14:33:51.119222 => 14:33:51.138244
[0m14:33:51.139894 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:33:51.145284 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:33:51.147630 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:33:51.149167 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:33:51.150130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:51.684440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:51.693853 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 14:33:51.140483 => 14:33:51.692430
[0m14:33:51.696416 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m14:33:51.783161 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.67s]
[0m14:33:51.786685 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:33:51.793831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:51.796205 [debug] [MainThread]: Connection 'test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m14:33:51.798727 [info ] [MainThread]: 
[0m14:33:51.801138 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 6.78 seconds (6.78s).
[0m14:33:51.807874 [debug] [MainThread]: Command end result
[0m14:33:51.837560 [info ] [MainThread]: 
[0m14:33:51.838599 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:51.839455 [info ] [MainThread]: 
[0m14:33:51.840320 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:33:51.841810 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.8354073, "process_user_time": 4.270474, "process_kernel_time": 0.831807, "process_mem_max_rss": "198464", "process_out_blocks": "2936", "process_in_blocks": "0"}
[0m14:33:51.842894 [debug] [MainThread]: Command `dbt test` succeeded at 14:33:51.842629 after 7.84 seconds
[0m14:33:51.843698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7451a7fa29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74517abb8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74517a16de10>]}
[0m14:33:51.844822 [debug] [MainThread]: Flushing usage events
[0m14:34:12.630674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c306ae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2e9c2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2e9c2320>]}


============================== 14:34:12.633058 | e523ab31-c926-4950-95c9-7a817b95ce75 ==============================
[0m14:34:12.633058 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:34:12.633745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:34:13.278431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e523ab31-c926-4950-95c9-7a817b95ce75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2e9c2470>]}
[0m14:34:13.336243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e523ab31-c926-4950-95c9-7a817b95ce75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2e9c1cf0>]}
[0m14:34:13.337084 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:34:13.343888 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:34:13.375547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:34:13.376345 [debug] [MainThread]: Partial parsing: updated file: dbtairbnb://tests/dim_listings_minimum_nights.sql
[0m14:34:13.531267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e523ab31-c926-4950-95c9-7a817b95ce75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0336e230>]}
[0m14:34:13.541205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e523ab31-c926-4950-95c9-7a817b95ce75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c03385870>]}
[0m14:34:13.541923 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 6 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:34:13.542563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e523ab31-c926-4950-95c9-7a817b95ce75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c03386560>]}
[0m14:34:13.544607 [info ] [MainThread]: 
[0m14:34:13.545530 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:13.547047 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m14:34:13.563453 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:34:13.564198 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:34:13.564716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:14.617267 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:34:14.625174 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:34:14.754072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m14:34:14.775242 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:34:14.778425 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:34:14.780729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:15.361576 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:34:15.370060 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:34:15.513019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e523ab31-c926-4950-95c9-7a817b95ce75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c03385960>]}
[0m14:34:15.516498 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:15.518200 [info ] [MainThread]: 
[0m14:34:15.524315 [debug] [Thread-1 (]: Began running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:34:15.526483 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m14:34:15.529153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m14:34:15.530719 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:34:15.555750 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:34:15.557326 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 14:34:15.531448 => 14:34:15.556919
[0m14:34:15.558046 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:34:15.579167 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:34:15.580452 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:34:15.581104 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m14:34:15.581721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:16.274166 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:16.303248 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 14:34:15.558431 => 14:34:16.302312
[0m14:34:16.304726 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m14:34:16.451640 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.92s]
[0m14:34:16.455395 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:34:16.458350 [debug] [Thread-1 (]: Began running node test.dbtairbnb.dim_listings_minimum_nights
[0m14:34:16.461589 [info ] [Thread-1 (]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m14:34:16.465355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtairbnb.dim_listings_minimum_nights)
[0m14:34:16.467918 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.dim_listings_minimum_nights
[0m14:34:16.480181 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.dim_listings_minimum_nights"
[0m14:34:16.483110 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.dim_listings_minimum_nights (compile): 14:34:16.469636 => 14:34:16.481867
[0m14:34:16.486116 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.dim_listings_minimum_nights
[0m14:34:16.493271 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.dim_listings_minimum_nights"
[0m14:34:16.495430 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.dim_listings_minimum_nights"
[0m14:34:16.496974 [debug] [Thread-1 (]: On test.dbtairbnb.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from AIRBNB.dev.dim_listings_cleansed where minimum_nights < 2 limit 10
      
    ) dbt_internal_test
[0m14:34:16.498456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:17.061119 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:17.070917 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.dim_listings_minimum_nights (execute): 14:34:16.487030 => 14:34:17.069354
[0m14:34:17.073479 [debug] [Thread-1 (]: On test.dbtairbnb.dim_listings_minimum_nights: Close
[0m14:34:17.225184 [error] [Thread-1 (]: 2 of 6 FAIL 10 dim_listings_minimum_nights ..................................... [[31mFAIL 10[0m in 0.76s]
[0m14:34:17.226160 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.dim_listings_minimum_nights
[0m14:34:17.226844 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:34:17.227579 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m14:34:17.228447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.dim_listings_minimum_nights, now test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m14:34:17.229031 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:34:17.236294 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:34:17.237233 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 14:34:17.229383 => 14:34:17.236935
[0m14:34:17.237987 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:34:17.242587 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:34:17.244040 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:34:17.245033 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m14:34:17.245897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:17.807203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:17.818028 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 14:34:17.238487 => 14:34:17.816616
[0m14:34:17.820657 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m14:34:17.908596 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.68s]
[0m14:34:17.912445 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:34:17.915235 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:34:17.918325 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m14:34:17.922209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m14:34:17.924566 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:34:17.935608 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:34:17.937278 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 14:34:17.925885 => 14:34:17.936695
[0m14:34:17.938506 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:34:17.944235 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:34:17.945893 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:34:17.946800 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m14:34:17.947565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:18.735129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:18.744637 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 14:34:17.939273 => 14:34:18.743264
[0m14:34:18.747404 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m14:34:18.892035 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.97s]
[0m14:34:18.894731 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:34:18.896707 [debug] [Thread-1 (]: Began running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:34:18.898762 [info ] [Thread-1 (]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m14:34:18.901554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m14:34:18.903377 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:34:18.930752 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:34:18.932329 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 14:34:18.904527 => 14:34:18.931812
[0m14:34:18.933232 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:34:18.938122 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:34:18.939589 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:34:18.940344 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:34:18.941056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:19.836935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:19.846268 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 14:34:18.933889 => 14:34:19.844810
[0m14:34:19.849606 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m14:34:19.962498 [info ] [Thread-1 (]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.06s]
[0m14:34:19.964473 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:34:19.965588 [debug] [Thread-1 (]: Began running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:34:19.966413 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m14:34:19.967910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m14:34:19.969176 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:34:19.976361 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:34:19.977245 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 14:34:19.969712 => 14:34:19.976947
[0m14:34:19.977831 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:34:19.982294 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:34:19.983420 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:34:19.983995 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:34:19.984531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:20.565444 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:20.574941 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 14:34:19.978563 => 14:34:20.573525
[0m14:34:20.578733 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m14:34:20.691144 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.72s]
[0m14:34:20.694890 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:34:20.701712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:20.704225 [debug] [MainThread]: Connection 'test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m14:34:20.706864 [info ] [MainThread]: 
[0m14:34:20.710935 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 7.16 seconds (7.16s).
[0m14:34:20.718106 [debug] [MainThread]: Command end result
[0m14:34:20.735867 [info ] [MainThread]: 
[0m14:34:20.736821 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:34:20.737933 [info ] [MainThread]: 
[0m14:34:20.739567 [error] [MainThread]: [31mFailure in test dim_listings_minimum_nights (tests/dim_listings_minimum_nights.sql)[0m
[0m14:34:20.741070 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m14:34:20.742341 [info ] [MainThread]: 
[0m14:34:20.743053 [info ] [MainThread]:   compiled Code at target/compiled/dbtairbnb/tests/dim_listings_minimum_nights.sql
[0m14:34:20.743796 [info ] [MainThread]: 
[0m14:34:20.744779 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m14:34:20.746312 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 8.157546, "process_user_time": 4.261609, "process_kernel_time": 0.799797, "process_mem_max_rss": "198420", "process_out_blocks": "2936", "command_success": false, "process_in_blocks": "0"}
[0m14:34:20.747122 [debug] [MainThread]: Command `dbt test` failed at 14:34:20.746912 after 8.16 seconds
[0m14:34:20.747760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c306ae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2e9c1cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c028391b0>]}
[0m14:34:20.748387 [debug] [MainThread]: Flushing usage events
[0m14:34:45.440300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d09340a69e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0932486350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d09324862f0>]}


============================== 14:34:45.442790 | a5d77536-e4ff-4b1d-96fb-7f6dc64409ff ==============================
[0m14:34:45.442790 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:34:45.443433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'profiles_dir': '/home/lkeiti/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:34:46.112012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5d77536-e4ff-4b1d-96fb-7f6dc64409ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0932486440>]}
[0m14:34:46.178999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5d77536-e4ff-4b1d-96fb-7f6dc64409ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0932485cf0>]}
[0m14:34:46.179854 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:34:46.187254 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:34:46.219852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:34:46.220630 [debug] [MainThread]: Partial parsing: updated file: dbtairbnb://tests/dim_listings_minimum_nights.sql
[0m14:34:46.370541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5d77536-e4ff-4b1d-96fb-7f6dc64409ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0906e72200>]}
[0m14:34:46.379666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5d77536-e4ff-4b1d-96fb-7f6dc64409ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0906ff5840>]}
[0m14:34:46.380296 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 6 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:34:46.380816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5d77536-e4ff-4b1d-96fb-7f6dc64409ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0906ff6530>]}
[0m14:34:46.383084 [info ] [MainThread]: 
[0m14:34:46.384116 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:46.385695 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m14:34:46.400552 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:34:46.401146 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:34:46.401837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:47.322281 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:34:47.325419 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:34:47.466938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m14:34:47.477255 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:34:47.478403 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:34:47.479455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:47.908710 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:34:47.911789 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:34:47.996395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5d77536-e4ff-4b1d-96fb-7f6dc64409ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0906ff5930>]}
[0m14:34:47.997315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:47.997960 [info ] [MainThread]: 
[0m14:34:48.000067 [debug] [Thread-1 (]: Began running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:34:48.000773 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m14:34:48.001898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m14:34:48.002505 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:34:48.023682 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:34:48.024831 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 14:34:48.002866 => 14:34:48.024477
[0m14:34:48.025486 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:34:48.047093 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:34:48.048262 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:34:48.048841 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m14:34:48.049391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:48.555373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:48.578070 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 14:34:48.025896 => 14:34:48.576996
[0m14:34:48.580020 [debug] [Thread-1 (]: On test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m14:34:48.714417 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.71s]
[0m14:34:48.718977 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:34:48.722157 [debug] [Thread-1 (]: Began running node test.dbtairbnb.dim_listings_minimum_nights
[0m14:34:48.725369 [info ] [Thread-1 (]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m14:34:48.729147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtairbnb.dim_listings_minimum_nights)
[0m14:34:48.731197 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.dim_listings_minimum_nights
[0m14:34:48.740118 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.dim_listings_minimum_nights"
[0m14:34:48.741920 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.dim_listings_minimum_nights (compile): 14:34:48.732364 => 14:34:48.741258
[0m14:34:48.743059 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.dim_listings_minimum_nights
[0m14:34:48.749284 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.dim_listings_minimum_nights"
[0m14:34:48.750860 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.dim_listings_minimum_nights"
[0m14:34:48.751746 [debug] [Thread-1 (]: On test.dbtairbnb.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from AIRBNB.dev.dim_listings_cleansed where minimum_nights < 1 limit 10
      
    ) dbt_internal_test
[0m14:34:48.752524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:49.300283 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:49.306620 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.dim_listings_minimum_nights (execute): 14:34:48.743772 => 14:34:49.305893
[0m14:34:49.308022 [debug] [Thread-1 (]: On test.dbtairbnb.dim_listings_minimum_nights: Close
[0m14:34:49.443831 [info ] [Thread-1 (]: 2 of 6 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.72s]
[0m14:34:49.444969 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.dim_listings_minimum_nights
[0m14:34:49.445813 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:34:49.446699 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m14:34:49.447800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.dim_listings_minimum_nights, now test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m14:34:49.448562 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:34:49.458348 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:34:49.459438 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 14:34:49.449054 => 14:34:49.459064
[0m14:34:49.460131 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:34:49.463968 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:34:49.465106 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:34:49.465744 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m14:34:49.466286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:49.904016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:34:49.906259 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 14:34:49.460573 => 14:34:49.905961
[0m14:34:49.906836 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m14:34:49.990648 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.54s]
[0m14:34:49.992993 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:34:49.994962 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:34:49.997096 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m14:34:49.999712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m14:34:50.001386 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:34:50.015061 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:34:50.016969 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 14:34:50.002500 => 14:34:50.016280
[0m14:34:50.018211 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:34:50.024603 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:34:50.026193 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:34:50.027070 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m14:34:50.027917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:50.702159 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:50.713844 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 14:34:50.018892 => 14:34:50.712088
[0m14:34:50.717578 [debug] [Thread-1 (]: On test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m14:34:50.852122 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.85s]
[0m14:34:50.855741 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:34:50.858806 [debug] [Thread-1 (]: Began running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:34:50.861914 [info ] [Thread-1 (]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m14:34:50.867197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m14:34:50.870321 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:34:50.894936 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:34:50.896489 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 14:34:50.871830 => 14:34:50.895952
[0m14:34:50.897537 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:34:50.903412 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:34:50.904993 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:34:50.905660 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:34:50.906237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:51.790914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:51.793776 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 14:34:50.898199 => 14:34:51.793287
[0m14:34:51.794727 [debug] [Thread-1 (]: On test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m14:34:51.873877 [info ] [Thread-1 (]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.01s]
[0m14:34:51.875652 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:34:51.876917 [debug] [Thread-1 (]: Began running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:34:51.877813 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m14:34:51.879387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m14:34:51.880196 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:34:51.890271 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:34:51.891555 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 14:34:51.880695 => 14:34:51.891160
[0m14:34:51.892240 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:34:51.896132 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:34:51.897478 [debug] [Thread-1 (]: Using snowflake connection "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:34:51.898155 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "node_id": "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:34:51.898764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:52.525031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:52.534824 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 14:34:51.892676 => 14:34:52.533340
[0m14:34:52.537675 [debug] [Thread-1 (]: On test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m14:34:52.660136 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.78s]
[0m14:34:52.661945 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:34:52.664928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:52.665852 [debug] [MainThread]: Connection 'test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m14:34:52.667419 [info ] [MainThread]: 
[0m14:34:52.668947 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 6.28 seconds (6.28s).
[0m14:34:52.671724 [debug] [MainThread]: Command end result
[0m14:34:52.683133 [info ] [MainThread]: 
[0m14:34:52.684128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:34:52.684721 [info ] [MainThread]: 
[0m14:34:52.685266 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:34:52.686428 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.2882977, "process_user_time": 3.959685, "process_kernel_time": 0.818281, "process_mem_max_rss": "198256", "process_out_blocks": "2928", "process_in_blocks": "0"}
[0m14:34:52.687370 [debug] [MainThread]: Command `dbt test` succeeded at 14:34:52.687120 after 7.29 seconds
[0m14:34:52.687965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d09340a69e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0932486440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d090631d030>]}
[0m14:34:52.688615 [debug] [MainThread]: Flushing usage events
[0m14:38:21.272214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c7db29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c60c23b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c60c2350>]}


============================== 14:38:21.274580 | c5e3b959-638e-4a2a-9088-f88161a743fc ==============================
[0m14:38:21.274580 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:38:21.275239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:38:21.900110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5e3b959-638e-4a2a-9088-f88161a743fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c60c24a0>]}
[0m14:38:21.957474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5e3b959-638e-4a2a-9088-f88161a743fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd79af4f250>]}
[0m14:38:59.219642 [error] [MainThread]: Encountered an error:

[0m14:38:59.230354 [error] [MainThread]: Traceback (most recent call last):
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/home/lkeiti/Documents/dnc-data-engineer/.env/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m14:38:59.235158 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 38.00361, "process_user_time": 2.851133, "process_kernel_time": 0.836226, "process_mem_max_rss": "183640", "process_in_blocks": "3304", "process_out_blocks": "2968", "command_success": false}
[0m14:38:59.239404 [debug] [MainThread]: Command `dbt docs serve` failed at 14:38:59.238525 after 38.01 seconds
[0m14:38:59.242079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c7db29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd79ae0d6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd79ae0f850>]}
[0m14:38:59.245161 [debug] [MainThread]: Flushing usage events
[0m14:40:01.011669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7802549a29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780252cd2500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780252cd24a0>]}


============================== 14:40:01.014020 | ee42341b-2b03-4547-9d7b-80e43c78fc9c ==============================
[0m14:40:01.014020 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:40:01.014643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:40:01.651923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee42341b-2b03-4547-9d7b-80e43c78fc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780252cd25f0>]}
[0m14:40:01.711424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee42341b-2b03-4547-9d7b-80e43c78fc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780252cd1d50>]}
[0m14:40:01.712243 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:40:01.719685 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m14:40:01.749904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:01.750521 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:01.756294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee42341b-2b03-4547-9d7b-80e43c78fc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7802275dbe50>]}
[0m14:40:01.759056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee42341b-2b03-4547-9d7b-80e43c78fc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780227591ab0>]}
[0m14:40:01.759629 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 6 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:40:01.760135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee42341b-2b03-4547-9d7b-80e43c78fc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780227592650>]}
[0m14:40:01.762457 [info ] [MainThread]: 
[0m14:40:01.763294 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:40:01.764582 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m14:40:01.781993 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m14:40:01.782557 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m14:40:01.783021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:02.707445 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:40:02.715526 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:40:02.803947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m14:40:02.826046 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:40:02.828369 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:40:02.830583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:03.658541 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:40:03.661786 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:40:03.773403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee42341b-2b03-4547-9d7b-80e43c78fc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7802275928c0>]}
[0m14:40:03.777147 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:03.779469 [info ] [MainThread]: 
[0m14:40:03.788038 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_hosts
[0m14:40:03.791780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtairbnb.src_hosts)
[0m14:40:03.794439 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_hosts
[0m14:40:03.823449 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_hosts"
[0m14:40:03.825106 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_hosts (compile): 14:40:03.796065 => 14:40:03.824512
[0m14:40:03.827208 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_hosts
[0m14:40:03.828362 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_listings
[0m14:40:03.829702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_hosts, now model.dbtairbnb.src_listings)
[0m14:40:03.830688 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_listings
[0m14:40:03.835113 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_listings"
[0m14:40:03.836241 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_listings (compile): 14:40:03.831276 => 14:40:03.835835
[0m14:40:03.837586 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_listings
[0m14:40:03.838373 [debug] [Thread-1 (]: Began running node model.dbtairbnb.src_reviews
[0m14:40:03.839396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_listings, now model.dbtairbnb.src_reviews)
[0m14:40:03.840166 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.src_reviews
[0m14:40:03.843637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.src_reviews"
[0m14:40:03.844464 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.src_reviews (compile): 14:40:03.840641 => 14:40:03.844152
[0m14:40:03.845476 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.src_reviews
[0m14:40:03.846129 [debug] [Thread-1 (]: Began running node seed.dbtairbnb.seed_full_moon_dates
[0m14:40:03.846938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.src_reviews, now seed.dbtairbnb.seed_full_moon_dates)
[0m14:40:03.847530 [debug] [Thread-1 (]: Began compiling node seed.dbtairbnb.seed_full_moon_dates
[0m14:40:03.849697 [debug] [Thread-1 (]: Timing info for seed.dbtairbnb.seed_full_moon_dates (compile): 14:40:03.847910 => 14:40:03.849350
[0m14:40:03.850345 [debug] [Thread-1 (]: Began executing node seed.dbtairbnb.seed_full_moon_dates
[0m14:40:03.851075 [debug] [Thread-1 (]: Timing info for seed.dbtairbnb.seed_full_moon_dates (execute): 14:40:03.850765 => 14:40:03.850773
[0m14:40:03.852068 [debug] [Thread-1 (]: Finished running node seed.dbtairbnb.seed_full_moon_dates
[0m14:40:03.852652 [debug] [Thread-1 (]: Began running node snapshot.dbtairbnb.scd_raw_listings
[0m14:40:03.853381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtairbnb.seed_full_moon_dates, now snapshot.dbtairbnb.scd_raw_listings)
[0m14:40:03.853982 [debug] [Thread-1 (]: Began compiling node snapshot.dbtairbnb.scd_raw_listings
[0m14:40:03.857344 [debug] [Thread-1 (]: Timing info for snapshot.dbtairbnb.scd_raw_listings (compile): 14:40:03.854327 => 14:40:03.857061
[0m14:40:03.858093 [debug] [Thread-1 (]: Began executing node snapshot.dbtairbnb.scd_raw_listings
[0m14:40:03.858714 [debug] [Thread-1 (]: Timing info for snapshot.dbtairbnb.scd_raw_listings (execute): 14:40:03.858444 => 14:40:03.858451
[0m14:40:03.859719 [debug] [Thread-1 (]: Finished running node snapshot.dbtairbnb.scd_raw_listings
[0m14:40:03.860305 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_hosts_cleansed
[0m14:40:03.861045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtairbnb.scd_raw_listings, now model.dbtairbnb.dim_hosts_cleansed)
[0m14:40:03.861709 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_hosts_cleansed
[0m14:40:03.867364 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_hosts_cleansed"
[0m14:40:03.868302 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (compile): 14:40:03.862061 => 14:40:03.867960
[0m14:40:03.869280 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_hosts_cleansed
[0m14:40:03.870218 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_hosts_cleansed (execute): 14:40:03.869920 => 14:40:03.869930
[0m14:40:03.871234 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_hosts_cleansed
[0m14:40:03.871817 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_cleansed
[0m14:40:03.872548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_hosts_cleansed, now model.dbtairbnb.dim_listings_cleansed)
[0m14:40:03.873091 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_cleansed
[0m14:40:03.879691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_cleansed"
[0m14:40:03.880469 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (compile): 14:40:03.873437 => 14:40:03.880189
[0m14:40:03.881011 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_cleansed
[0m14:40:03.881682 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_cleansed (execute): 14:40:03.881358 => 14:40:03.881367
[0m14:40:03.882669 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_cleansed
[0m14:40:03.883263 [debug] [Thread-1 (]: Began running node model.dbtairbnb.fct_reviews
[0m14:40:03.884377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_cleansed, now model.dbtairbnb.fct_reviews)
[0m14:40:03.885010 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.fct_reviews
[0m14:40:03.895029 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.fct_reviews"
[0m14:40:03.895896 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (compile): 14:40:03.885362 => 14:40:03.895595
[0m14:40:03.896454 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.fct_reviews
[0m14:40:03.897082 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.fct_reviews (execute): 14:40:03.896807 => 14:40:03.896816
[0m14:40:03.898099 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.fct_reviews
[0m14:40:03.898690 [debug] [Thread-1 (]: Began running node model.dbtairbnb.dim_listings_w_hosts
[0m14:40:03.899427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.fct_reviews, now model.dbtairbnb.dim_listings_w_hosts)
[0m14:40:03.899970 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.dim_listings_w_hosts
[0m14:40:03.903183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.dim_listings_w_hosts"
[0m14:40:03.904067 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (compile): 14:40:03.900341 => 14:40:03.903783
[0m14:40:03.904605 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.dim_listings_w_hosts
[0m14:40:03.905219 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.dim_listings_w_hosts (execute): 14:40:03.904949 => 14:40:03.904957
[0m14:40:03.906303 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.dim_listings_w_hosts
[0m14:40:03.906899 [debug] [Thread-1 (]: Began running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:40:03.907684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtairbnb.dim_listings_w_hosts, now test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m14:40:03.908238 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:40:03.922691 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:40:03.923542 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 14:40:03.908588 => 14:40:03.923243
[0m14:40:03.924103 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:40:03.924742 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 14:40:03.924458 => 14:40:03.924467
[0m14:40:03.925799 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:40:03.926404 [debug] [Thread-1 (]: Began running node test.dbtairbnb.dim_listings_minimum_nights
[0m14:40:03.927145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtairbnb.dim_listings_minimum_nights)
[0m14:40:03.927693 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.dim_listings_minimum_nights
[0m14:40:03.930540 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.dim_listings_minimum_nights"
[0m14:40:03.931385 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.dim_listings_minimum_nights (compile): 14:40:03.928042 => 14:40:03.931096
[0m14:40:03.931919 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.dim_listings_minimum_nights
[0m14:40:03.932533 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.dim_listings_minimum_nights (execute): 14:40:03.932266 => 14:40:03.932273
[0m14:40:03.933539 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.dim_listings_minimum_nights
[0m14:40:03.934124 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:40:03.934859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.dim_listings_minimum_nights, now test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m14:40:03.935398 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:40:03.944659 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:40:03.945481 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 14:40:03.935862 => 14:40:03.945190
[0m14:40:03.946084 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:40:03.946703 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 14:40:03.946428 => 14:40:03.946437
[0m14:40:03.947683 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:40:03.948264 [debug] [Thread-1 (]: Began running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:40:03.948993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m14:40:03.949600 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:40:03.954100 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:40:03.954882 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 14:40:03.949949 => 14:40:03.954594
[0m14:40:03.955425 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:40:03.956050 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 14:40:03.955776 => 14:40:03.955784
[0m14:40:03.957023 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:40:03.957658 [debug] [Thread-1 (]: Began running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:40:03.958401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m14:40:03.958951 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:40:03.966987 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:40:03.968117 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 14:40:03.959384 => 14:40:03.967680
[0m14:40:03.968830 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:40:03.969484 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 14:40:03.969194 => 14:40:03.969204
[0m14:40:03.970598 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:40:03.971196 [debug] [Thread-1 (]: Began running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:40:03.971944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m14:40:03.972487 [debug] [Thread-1 (]: Began compiling node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:40:03.979094 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:40:03.979869 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 14:40:03.972831 => 14:40:03.979585
[0m14:40:03.980408 [debug] [Thread-1 (]: Began executing node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:40:03.981028 [debug] [Thread-1 (]: Timing info for test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 14:40:03.980756 => 14:40:03.980763
[0m14:40:03.982069 [debug] [Thread-1 (]: Finished running node test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:40:03.982664 [debug] [Thread-1 (]: Began running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:40:03.983447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtairbnb.unique_dim_listings_cleansed_listing_id.930e4e859e, now model.dbtairbnb.mart_fullmoon_reviews)
[0m14:40:03.983994 [debug] [Thread-1 (]: Began compiling node model.dbtairbnb.mart_fullmoon_reviews
[0m14:40:03.987285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtairbnb.mart_fullmoon_reviews"
[0m14:40:03.988109 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (compile): 14:40:03.984341 => 14:40:03.987821
[0m14:40:03.988645 [debug] [Thread-1 (]: Began executing node model.dbtairbnb.mart_fullmoon_reviews
[0m14:40:03.989258 [debug] [Thread-1 (]: Timing info for model.dbtairbnb.mart_fullmoon_reviews (execute): 14:40:03.988989 => 14:40:03.988997
[0m14:40:03.990288 [debug] [Thread-1 (]: Finished running node model.dbtairbnb.mart_fullmoon_reviews
[0m14:40:03.991318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:03.991865 [debug] [MainThread]: Connection 'model.dbtairbnb.mart_fullmoon_reviews' was properly closed.
[0m14:40:03.994246 [debug] [MainThread]: Command end result
[0m14:40:04.006423 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m14:40:04.006939 [info ] [MainThread]: Building catalog
[0m14:40:04.009853 [debug] [ThreadPool]: Acquiring new snowflake connection 'AIRBNB.information_schema'
[0m14:40:04.023467 [debug] [ThreadPool]: Using snowflake connection "AIRBNB.information_schema"
[0m14:40:04.024279 [debug] [ThreadPool]: On AIRBNB.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbtairbnb", "target_name": "dev", "connection_name": "AIRBNB.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from AIRBNB.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('fct_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('scd_raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('mart_fullmoon_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('dim_listings_cleansed')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('dim_hosts_cleansed')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('dim_listings_w_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('seed_full_moon_dates')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from AIRBNB.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('fct_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('scd_raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('mart_fullmoon_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('dim_listings_cleansed')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('dim_hosts_cleansed')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('dim_listings_w_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('seed_full_moon_dates')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m14:40:04.024978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:08.062017 [debug] [ThreadPool]: SQL status: SUCCESS 67 in 4.0 seconds
[0m14:40:08.099464 [debug] [ThreadPool]: On AIRBNB.information_schema: Close
[0m14:40:08.236009 [info ] [MainThread]: Catalog written to /home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/target/catalog.json
[0m14:40:08.237456 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 7.2687173, "process_user_time": 3.572725, "process_kernel_time": 0.798845, "process_mem_max_rss": "197564", "process_in_blocks": "8", "process_out_blocks": "5064"}
[0m14:40:08.238483 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:40:08.238252 after 7.27 seconds
[0m14:40:08.239093 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:40:08.239677 [debug] [MainThread]: Connection 'AIRBNB.information_schema' was properly closed.
[0m14:40:08.240310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7802549a29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780252cd25f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780226c23b80>]}
[0m14:40:08.240990 [debug] [MainThread]: Flushing usage events
[0m14:40:35.501038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a0b19b29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a0afcc23b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a0afcc2350>]}


============================== 14:40:35.503690 | 5fb6cd5e-8c8f-4d66-b252-489812ee23f7 ==============================
[0m14:40:35.503690 [info ] [MainThread]: Running with dbt=1.7.14
[0m14:40:35.504446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/lkeiti/Documents/dnc-data-engineer/6-dbt/dbtairbnb/logs', 'fail_fast': 'False', 'profiles_dir': '/home/lkeiti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:40:36.123904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fb6cd5e-8c8f-4d66-b252-489812ee23f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a0afcc24a0>]}
[0m14:40:36.180136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fb6cd5e-8c8f-4d66-b252-489812ee23f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a088b5f250>]}
